---
title: "CCS_DataCleaningScoring"
author: "T.J. Sullivan, Jared Gabrielli"
date: '2020-06-25'
output:
  html_document: default
---

# *Cleaning Setup*

##### *Loading packages to be used*  
```{r Load packages, include = FALSE}
# Load required packages for computing the analyses. 
library(tidyverse)
library(psych)
#library(irr)
library(knitr)
library(MASS)
library(sjmisc)
library(readxl)
#library(ggstatsplot)
#library(nlme)
```

##### *Importing dataset*  
```{r Import dataset, include = FALSE}
# Pull up a pop-up window so you can select the file that you want to use, which will then be imported into the R environment as a dataframe. Make sure that this is a .csv file (impt: when downloading from Qualtrics, make sure that you had selected "Use numeric values"). 

# Note, to save some programming here, the .csv file with raw data has the 2nd and 3rd rows deleted. These rows are automatically imported from Qualtrics to contain question and variable information that is not needed and messes with dplyr's column parsing. Sets blanks, NAs, and -99s to be NA/missing.
raw <- read_csv(
  file.choose(),
  na = c("", "NA", "-99"))

```

##### *Making generic functions to be used for analyses*  
```{r Making generic functions to be used for analyses, eval = FALSE}
#NOTE ABOUT CHANGES MADE TO RAW FILE TO MAKE PROGRAMMING EASIER:
# Note, the SIRRS was misnumbered in the Qualtrics programming and in the measures packet. Measures packet was fixed to correspond to what the number should be based on the paper, this code fixes the variable labels so that it corresponds to the Barry et al. 2009 validation paper (see Table 1) as well. Here are the variables changed (new name = old name):
#SIRRS_6 = SIRRS_5,
#SIRRS_9 = SIRRS_6, 
#SIRRS_10 = SIRRS_7,
#SIRRS_11 = SIRRS_8,
#SIRRS_12 = SIRRS_9,
#SIRRS_5 = SIRRS_10, 
#SIRRS_7 = SIRRS_11,
#SIRRS_8 = SIRRS_12

# Function to make columns numeric. 
#num <- function(x){
#  x %>%
#    as.character() %>%
#    as.numeric() %>%
#    return()
#}

#### scrappy scraps ####
# this is code that will change select variables to be factors. 
#data <- data %>% 
#  mutate_at(vars(x, z),
#    list(factor))
#raw <- raw %>% 
#  mutate(X = recode_factor(X, `0` = "label", `1` = "label"),
#         Y = recode_factor(Y, `1` = "label", `2` = "label"))


# Get frequencies for relationship variables 
#frq(raw$Cohab)
#frq(raw$LivingSit)
#frq(raw$RelStatus)
#frq(raw$Kids)
#frq(raw$Kids_prior)
#frq(raw$CNM_Categ)
#frq(raw$CNM_YN)

# This is how you can summarize functions based on CoupleID 
# Getting descriptives based on couple-level variables 
#coupleinfo <- group_by(raw, CoupleID) %>% summarize(RelLength_Tot_Mos = mean(RelLength_Tot_Mos, na.rm = TRUE), RelLength_Tot_Yrs = mean(RelLength_Tot_Yrs, na.rm = TRUE), CohabLength_Tot_Mos = mean(CohabLength_Tot_Mos, na.rm = TRUE), CohabLength_Tot_Yrs = mean(CohabLength_Tot_Yrs, na.rm = TRUE))
#describe(coupleinfo)
#rm(coupleinfo)


```

##### *Tidying up the dataset - removing invalid/incorrect responses, fixing duplicates*  
```{r Removing invalid/incorrect responses, fix duplicates, include = FALSE}
# Delete practice data from training. 
raw <- raw %>%
  filter(!(ResponseId %in% c("R_b95PLmTAz4OHEQx", "R_1HOTx34aC3r8YRb", "R_3JKL3c6GeHfZXCg", "R_25urLpa5VkHvXDY", "R_2BqZ6xroJt4qaIc", "R_1r7kOrKjIvaFA7d", "R_28CDUpfHselrK2l", "R_ONL4x1ETOvr276h", "R_ONL4x1ETOvr276h", "R_ONL4x1ETOvr276h", "R_1EgmHX0s042D0Im", "R_28NIBmkohQjiERL")))

# Delete participant errors (needing to restart survey, duplicates). In order, includes blank responses for PTID 131, 125, 203, 222, 197, 320, and a duplicate for 208. 
raw <- raw %>% filter(!ResponseId %in% c("R_1g5fIZYwtTGsygu", "R_2SvlwGonOBlZUXf", "R_3UcOVjlbR9k9PoJ", "R_2QMuO1twGFLI19K", "R_2sXahk0zVgaHE8H", "R_1I6o5kLJe2Um2tF", "R_2czLvndoznDBEor"))

# Combining data for ParticipantID 330. ResponseId R_ZlSyWHVRVyI6a4N has all variables up to and including Post1_3. R_3dSxNySi47AUkk8 has just the data for variables including PreDisc2_PW and after. 
data330pt1 <- filter(raw, ResponseId == 'R_ZlSyWHVRVyI6a4N') %>%
  dplyr::select(StartDate:Post1_3)
data330pt2 <- filter(raw, ResponseId == 'R_3dSxNySi47AUkk8') %>%
  dplyr::select(PreDisc2_PW:VideoConsent) 
data330pt3 <- filter(raw, ResponseId == 'R_ZlSyWHVRVyI6a4N') %>%
  dplyr::select(PosDiscussionTopic1:`TLEQ_17i_1_TEXT - Topics`) 
data330comb <- cbind(data330pt1, data330pt2, data330pt3) # combine data for all variables into 1 response
raw <- raw %>% 
  filter(!(ResponseId == 'R_ZlSyWHVRVyI6a4N')) %>% 
  filter(!(ResponseId == 'R_3dSxNySi47AUkk8'))# delete both 330 responses from dataset before adding in the new response in there 
raw <- rbind(data330comb, raw)
rm(data330pt1)
rm(data330pt2)
rm(data330pt3)
rm(data330comb)

# Below fixes any issues with ID number entry. 
# R_3elA9obZ9Wl8fOx should be CoupleID 1114 and ParticipantID 328
raw$CoupleID[raw$ResponseId == 'R_3elA9obZ9Wl8fOx'] <- 1114
raw$ParticipantID[raw$ResponseId == 'R_3elA9obZ9Wl8fOx'] <- 328
# R_3O8h5FzTOJ0j0zy should be CoupleID 1114
raw$CoupleID[raw$ResponseId == 'R_3O8h5FzTOJ0j0zy'] <- 1114
# R_DGmLeDYGtnQp8Tn should be CoupleID 1024
raw$CoupleID[raw$ResponseId == 'R_DGmLeDYGtnQp8Tn'] <- 1024
# R_2wB4M72JwAv1rrz should be CoupleID 1024
raw$CoupleID[raw$ResponseId == 'R_2wB4M72JwAv1rrz'] <- 1024
# R_3KW4JiEmhf80Gkh should be CoupleID 1095 and ParticipantID 289
raw$CoupleID[raw$ResponseId == 'R_3KW4JiEmhf80Gkh'] <- 1095
raw$ParticipantID[raw$ResponseId == 'R_3KW4JiEmhf80Gkh'] <- 289
# R_1HnjnFhEWLeXJRC should be CoupleID 1095
raw$CoupleID[raw$ResponseId == 'R_1HnjnFhEWLeXJRC'] <- 1095

# Identifying couples who completed self-report measures but did not do the discussion tasks. These were CoupleIDs 1054 and 1138.  
raw <- raw %>% 
  mutate(DiscussionMissing = if_else(CoupleID == 1054 | CoupleID == 1138, 1, 0),
         DiscussionMissing = recode_factor(DiscussionMissing, 
                           `0` = "Completed discussions", 
                           `1` = "Missing discussions"))

```

##### *Renaming & recoding variables to be consistent with programming*  
```{r Renaming & recoding variables, include = FALSE}
# Delete variables that are no longer necessary. Note ASSIST variables deleted in this code are only included b/c of Qualtrics programming. Skip logic was implemented such that if ASSIST_1_none was yes, then they did not get shown the other ASSIST questions. However, Qualtrics doesn't know that and includes it as a variable anyways. 
raw <- dplyr::select(raw, !c("StartDate", "EndDate", "Status", "UserLanguage", "DistributionChannel", "Duration (in seconds)", "Finished", "ResponseId", "PosDiscussionTopic1":"TLEQ_17i_1_TEXT - Topics", "ASSIST_2_x11", "ASSIST_3_x11", "ASSIST_4_x11", "ASSIST_5_x11", "ASSIST_6_x11", "ASSIST_7_x11", "ASSIST_8_x11", "PreDisc1_PW", "PreDisc2_PW", "PreDisc3_PW"))

# Code to rename variables: 
raw <- rename(raw, Race_NativeAm = Race_3, 
              Race_Asian = Race_2, 
              Race_Black = Race_1, 
              Race_Hawaiian = Race_4, 
              Race_White = Race_0, 
              Race_Other = Race_5, 
              Race_Other_Text = Race_5_TEXT, 
              RecruitmentSource_OtherSocMed_Text = RecruitmentSource_4_TEXT,
              RecruitmentSource_NotListed_Text = RecruitmentSource_9_TEXT,
              SxlOrx_Other_Text = SxlOrx_9_TEXT, 
              SxlOrx_Multi_Het = SxlOrx_allapply_0, 
              SxlOrx_Multi_Bi = SxlOrx_allapply_3, 
              SxlOrx_Multi_Pan = SxlOrx_allapply_4, 
              SxlOrx_Multi_Queer = SxlOrx_allapply_5, 
              SxlOrx_Multi_Fluid = SxlOrx_allapply_6, 
              SxlOrx_Multi_Gay = SxlOrx_allapply_1, 
              SxlOrx_Multi_Les = SxlOrx_allapply_2, 
              SxlOrx_Multi_Ques = SxlOrx_allapply_8, 
              SxlOrx_Multi_Ase = SxlOrx_allapply_7, 
              SxlOrx_Multi_Other = SxlOrx_allapply_9, 
              SxlOrx_Multi_Other_Text = SxlOrx_allapply_9_TEXT, 
              GenderIdent_Other_Text = GenderIdent_7_TEXT, 
              Hometown_City = Hometown_1, 
              Hometown_State = Hometown_2, 
              Hometown_Country = Hometown_3, 
              HometownLength_Years = HometownLength_1, 
              HometownLength_Mos = HometownLength_2, 
              LivingSit_Other_Text = LivingSit_5_TEXT, 
              CohabLength_Years = CohabLength_1, 
              CohabLength_Mos = CohabLength_2, 
              RelStatus_Other_Text = RelStatus_5_TEXT, 
              RelLength_Years = RelLength_1, 
              RelLength_Mos = RelLength_2, 
              RelLength_predating_Years = RelLength_predating_1,
              RelLength_predating_Mos = RelLength_predating_2, 
              Breakups_prior = Breaksup_prior,
              CNM_RelatIdent_Other = CNM_RelatIdent_3_TEXT, 
              CNM_Current_Monog = CNM_Current_0, 
              CNM_Current_Open = CNM_Current_2, 
              CNM_Current_Poly = CNM_Current_3, 
              CNM_Current_Swinger = CNM_Current_4, 
              CNM_Current_Anarch = CNM_Current_5, 
              CNM_Current_Monogish = CNM_Current_1, 
              CNM_Current_Other = CNM_Current_6, 
              CNM_Current_Other_Text = CNM_Current_6_TEXT, 
              CNM_IdealRelStyle_Other_Text = CNM_IdealRelStyle_6_TEXT, 
              SxlOrx_multiple = SxlOrx_muliple, 
              Post1_Sim = Post1_1, 
              Post1_Impt = Post1_2, 
              Post1_Freq = Post1_3, 
              Post2_Sim = Post2_1, 
              Post2_Impt = Post2_2, 
              Post2_Freq = Post2_3, 
              Post3_Sim = Post3_1, 
              Post3_Impt = Post3_2, 
              Post3_Freq = Post3_3,
              DiscrimTopic_optout = DiscrimTopic_optout_1,
              PosTopic_optout = PosTopic_optout_1,
              CTS_4= CTS_3,
              CTS_3 = CTS_2_1,
              ASSIST_1.tobac= ASSIST_1_1,
              ASSIST_1.alc = ASSIST_1_2,
              ASSIST_1.weed = ASSIST_1_3,
              ASSIST_1.coke = ASSIST_1_4,
              ASSIST_1.amphet = ASSIST_1_5,
              ASSIST_1.inhale = ASSIST_1_6,
              ASSIST_1.sedat = ASSIST_1_7,
              ASSIST_1.halluc = ASSIST_1_8,
              ASSIST_1.opiates = ASSIST_1_9,
              ASSIST_1.other = ASSIST_1_10,
              ASSIST_1.other_TEXT = ASSIST_1_10_TEXT,
              ASSIST_1_none = ASSIST_1_11,
              LEL_7a_boss = LEL_7a_1, 
              LEL_7a_spouse = LEL_7a_2,
              LEL_7a_friend = LEL_7a_3,
              LEL_7a_child = LEL_7a_4,
              LEL_7a_parent = LEL_7a_5,
              LEL_7a_other = LEL_7a_6,
              LEL_9a_you = LEL_9a_1,
              LEL_9a_spouse = LEL_9a_2,
              LEL_9a_child = LEL_9a_3,
              LEL_9a_parent = LEL_9a_4,
              LEL_9a_inlaw = LEL_9a_5,
              LEL_9a_sibling = LEL_9a_6,
              LEL_9a_friend = LEL_9a_7,
              LEL_9a_other = LEL_9a_8,
              LEL_9a_other_TEXT = LEL_9a_8_TEXT,
              LEL_10a_you = LEL_10a_1,
              LEL_10a_spouse = LEL_10a_2,
              LEL_10a_child = LEL_10a_3,
              LEL_10a_parent = LEL_10a_4,
              LEL_10a_inlaw = LEL_10a_5,
              LEL_10a_sibling = LEL_10a_6,
              LEL_10a_friend = LEL_10a_7,
              LEL_10a_other = LEL_10a_8,
              LEL_10a_other_TEXT = LEL_10a_8_TEXT,
              LEL_20a_you = LEL_20a_1,
              LEL_20a_spouse = LEL_20a_2,
              LEL_20a_child = LEL_20a_3,
              LEL_20a_parent = LEL_20a_4,
              LEL_20a_sibling = LEL_20a_5,
              LEL_20a_other = LEL_20a_6,
              LEL_20a_other_TEXT = LEL_20a_6_TEXT,
              LEL_21a_spouse = LEL_21a_1,
              LEL_21a_child = LEL_21a_2,
              LEL_21a_parent = LEL_21a_3,
              LEL_21a_sibling = LEL_21a_4,
              LEL_21a_other = LEL_21a_5,
              LEL_21a_other_TEXT = LEL_21a_5_TEXT,
              LEL_24a_noxtra = LEL_24a_1,
              LEL_24a_event1xtra = LEL_24a_2,
              LEL_24a_event2xtra = LEL_24a_3,
              LEL_24a_event3xtra = LEL_24a_4,
              LEL_24a_event1xtra_TEXT = LEL_24a_2_TEXT,
              LEL_24a_event2xtra_TEXT = LEL_24a_3_TEXT,
              LEL_24a_event3xtra_TEXT = LEL_24a_4_TEXT,
              LEL_24event1a_other_TEXT = LEL_24event1a_8_TEXT,
              LEL_24event2a_other_TEXT = LEL_24event2a_8_TEXT,
              LEL_24event3a_other_TEXT = LEL_24event3a_8_TEXT,
              StressorTopic_optout = StressorTopic_optout_1,
              TLEQ_8c_sxlorx_freq_TEXT = TLEQ_8c_1_TEXT, 
              TLEQ_9c_sxlorx_freq_TEXT = TLEQ_9c_1_TEXT,
              TLEQ_11b_sxlorx_freq_TEXT = TLEQ_11b_1_TEXT,
              TLEQ_12b_sxlorx_freq_TEXT = TLEQ_12b_1_TEXT,
              TLEQ_14c_sxlorx_freq_TEXT = TLEQ_14c_1_TEXT,
              TLEQ_15i_sxlorx_freq_TEXT = TLEQ_15i_1_TEXT,
              TLEQ_16h_sxlorx_freq_TEXT = TLEQ_16h_1_TEXT,
              TLEQ_17i_sxlorx_freq_TEXT = TLEQ_17i_1_TEXT,
              TLEQ_18i_sxlorx_freq_TEXT = TLEQ_18i_1_TEXT,
              TLEQ_19f_sxlorx_freq_TEXT = TLEQ_19f_1_TEXT,
              TLEQ_20f_sxlorx_freq_TEXT = TLEQ_20f_1_TEXT)

# Recode & set labels for factor variables. 
raw <- raw %>%
  mutate(
    Caution_StudyName = recode_factor(Caution_StudyName, `0` = "Use caution", `1` = "No need for caution"), 
    Ethnicity = recode_factor(Ethnicity, `0` = "Not Hispanic/Latinx", `1` = "Hispanic/Latinx"), 
    State = recode_factor(State, `5` = "California", `6` = "Colorado", `7` = "Connecticut", `8` = "Delaware", `9` = "Washington D.C.", `10` = "Florida", `14` = "Illinois", `15` = "Indiana", `19` = "Louisiana", `21` = "Maryland", `22` = "Masschusetts", `23` = "Michigan", `26` = "Missouri", `28` = "Nebraska", `29` = "Nevada", `31` = "New Jersey", `33` = "New York", `34` = "North Carolina", `36` = "Ohio", `39` = "Pennsylvania", `43` = "Tennessee", `44` = "Texas", `45` = "Utah", `52` = "Outside of U.S."), 
    RecruitmentSource = recode_factor(RecruitmentSource, `1` = "Facebook", `2` = "Instagram", `3` = "Twitter", `4` = "Other social media", `5` = "Email flyer", `6` = "In-person flyer", `7` = "Org listserv", `8` = "Someone I know", `9` = "Not listed (specify)"), 
    Income = recode_factor(Income, `1` = "Under $12,000", `2` = "$12,000-$23,999", `3` = "$24,000-$44,999", `4` = "$45,000-$74,999", `5` = "$75,000-$119,999", `6` = "$120,000 or more"), 
    Educ = recode_factor(Educ,  `1` = "Less than HS", `2` = "Some HS", `3` = "HS diploma or GED", `4` = "Some college no degree", `5` = "Associates", `6` = "4-year college", `7` = "Some grad school no degree", `8` = "Masters", `9` = "Advanced degree"), 
    Employment = recode_factor(Employment, `1` = "Full-time (40h/wk)", `2` = "Part-time (< 40 hrs/wk)", `3` = "Part-time work + full-time student", `4` = "Temp/occasional work", `5` = "Perm or temp disabled and NOT working", `6` = "Perm or temp disabled BUT working off books", `7` = "Unemployed Student", `8` = "Unemployed Other"),
    SxlAttract = recode_factor(SxlAttract, `0` = "Single gender attraction", `1` = "More than 1 gender attraction", `2` = "Attraction regardless of gender"),
    SxlOrx = recode_factor(SxlOrx, `0` = "Straight", `1` = "Gay", `2` = "Lesbian", `3` = "Bisexual", `4` = "Pansexual", `5` = "Queer", `6` = "Fluid", `7` = "Asexual", `8` = "Questioning", `9` = "Other (specify)"),
    SxlOrx_multiple = recode_factor(SxlOrx_multiple, `0` = "Did not endorse multiple labels", `1` = "Endorsed multiple labels"),
    GenderIdent = recode_factor(GenderIdent, `0` = "Woman", `1` = "Man", `2` = "Transgender man (trans man)", `3` = "Transgender woman (trans woman)", `4` = "Gender non-conforming", `5` = "Genderqueer", `6` = "Non-binary", `7` = "Other (specify)"),
    BirthSex = recode_factor(BirthSex, `0` = "Female", `1` = "Male", `2` = "Intersex"),
    LivingSit = recode_factor(LivingSit, `1` = "Live w/ partner by ourselves", `2` = "Live w/ partner + other people", `3` = "Live w/ partner + family", `4` = "Live in same town/region but NOT together", `5` = "Other (specify)", `6` = "NOT same town/region and NOT together"),
    RelStatus = recode_factor(RelStatus, `1` = "Dating relationship", `2` = "Committed relationship", `3` = "Engaged", `4` = "Married/civil union", `5` = "Other (specify)"),
    FirstRelat = recode_factor(FirstRelat, `0` = "No, not first relationship", `1` = "Yes, first relationship"),
    Kids = recode_factor(Kids, `0` = "No kids w/ partner", `1` = "Yes kids w/ partner"),
    Kids_prior = recode_factor(Kids_prior, `0` = "No prior kids", `1` = "Yes prior kids"),
    Breakup = recode_factor(Breakup, `0` = "No prior breakup", `1` = "Yes prior breakup"),
    Breakups_prior = recode_factor(Breakups_prior, `1` = "1 prior breakup", `2` = "2 prior breakups", `3` = "3 prior breakups", `4` = "4 prior breakups"),
    CNM_RelatIdent = recode_factor(CNM_RelatIdent, `0` = "Monogamous", `1` = "Non-monogamous", `2` = "Questioning/exploring", `3` = "Other relationship identity"),
    CNM_IdealRelStyle = recode_factor(CNM_IdealRelStyle, `0` = "Monogamous", `1` = "Monogam-ish", `2` = "Open", `3` = "Polyamorous", `4` = "Swinger", `5` = "Relationship anarchy", `6` = "Other (specify)"),
    CNM_RelAgreement = recode_factor(CNM_RelAgreement, `0` = "No we do not have a relationship agreement", `1` = "Yes we have a relationship agreement"),
    CNM_RelAgreeDetails = recode_factor(CNM_RelAgreeDetails, `1` = "Cannot have sex with outside partner", `2` = "Sex with outside partners, some restrictions", `3` = "Sex with outside partners, no restrictions"),
    StressorExp1_prior = recode_factor(StressorExp1_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    StressorExp2_prior = recode_factor(StressorExp2_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    StressorExp3_prior = recode_factor(StressorExp3_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    StressorExp4_prior = recode_factor(StressorExp4_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    StressorExp5_prior = recode_factor(StressorExp5_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    DiscrimExp1_prior = recode_factor(DiscrimExp1_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    DiscrimExp2_prior = recode_factor(DiscrimExp2_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    DiscrimExp3_prior = recode_factor(DiscrimExp3_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    DiscrimExp4_prior = recode_factor(DiscrimExp4_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    DiscrimExp5_prior = recode_factor(DiscrimExp5_prior, `0` = "No, not previously discussed", `1` = "Yes, previously discussed"),
    VideoConsent = recode_factor(VideoConsent, `1` = "Yes, I consent to use videos", `2` = "No, I do NOT consent to use videos"))

```

##### *Cleaning/formatting demographic variables*  
```{r Cleaning/formatting demographic variables, include = FALSE}
####################### RACE/ETHNICITY ####################### 
 
# Coding race into 1 categorical variable for reporting.
# Select out into a separate dataframe.
race <- dplyr::select(raw, CoupleID, ParticipantID, Ethnicity, Race_NativeAm, Race_Asian, Race_Black, Race_Hawaiian, Race_White, Race_Other, Race_Other_Text)

# Change ethnicity to be numeric for code below.
race$Ethnicity <- as.numeric(race$Ethnicity)
race$Ethnicity[which(race$Ethnicity == 1)] <- 0
race$Ethnicity[which(race$Ethnicity == 2)] <- 1

# Sum up the number of different racial categories endorsed. 
race$Race_Num <- rowSums(race[c("Ethnicity", "Race_NativeAm", "Race_Asian", "Race_Black", "Race_Hawaiian", "Race_White", "Race_Other")]) 

# Creating a variable for anyone who selected more than 1 race or ethnicity category - coded as multiracial. Note: this is "incomplete" b/c code is written below to manually recode responses visual inspection. 
race$Race_Multi <- 0 
race$Race_Multi[which(race$Race_Num > 1)] <- 1 

# The following categories were created by the investigators to be as inclusive as possible as to different race and ethnicity categories: 
#0 = Non-Hispanic White
#1 = Hispanic White
#2 = Hispanic/Latinx
#3 = Black/African American
#4 = Asian
#5 = Native American or Alaska Native 
#6 = Native Hawaiian or Other Pacific Islander
#7 = Multiracial 
race$race_categ <- NA
race$race_categ[which(race$Race_NativeAm == 1)] <- 5
race$race_categ[which(race$Race_Asian == 1)] <- 4
race$race_categ[which(race$Race_Black == 1)] <- 3
race$race_categ[which(race$Race_Hawaiian == 1)] <- 6
race$race_categ[which(race$Race_White == 1)] <- 0
race$race_categ[which(race$Race_Other == 1)] <- 7
race$race_categ[which(race$Race_Multi == 1)] <- 7

# We visually inspected ethnicity and racial identity variables to verify the coding above. These cases were manually recoded based on that inspection: 

# code as Hispanic White - checked that they are hispanic/latinx in ethnicity question AND checked White in race identity question
race <- race %>%
  mutate(race_categ = if_else(ParticipantID == 118 | ParticipantID == 125 | ParticipantID == 208 | ParticipantID == 243 | ParticipantID == 244 | ParticipantID == 237 | ParticipantID == 198 | ParticipantID == 228 | ParticipantID == 227 | ParticipantID == 304 | ParticipantID == 367 | ParticipantID == 357, 1, race_categ))

# code as Hispanic/Latinx - free response indicated this race identity without any other ones being checked (which would be counted as multiracial) 
race <- race %>% 
  mutate(race_categ = if_else(ParticipantID == 330 | ParticipantID == 111 | ParticipantID == 103 | ParticipantID == 219 | ParticipantID == 271 | ParticipantID == 252 | ParticipantID == 325 | ParticipantID == 328 | ParticipantID == 327 | ParticipantID == 376, 2, race_categ))

# set to missing - did not provide information on race/ethnicity to code. 
race$race_categ[which(race$ParticipantID == 265)] <- NA

# code as Non-Hispanic White - indicated religious identity (Jewish) in free-response 
race$race_categ[which(race$ParticipantID == 344)] <- 0

# creating a second variable for a more specific race/ethnicity category that divides based on whether people are hispanic/latino or not (this is done instead of crosstabs b/c of coding above)
race$race_categ_spec <- race$race_categ

# splitting up race based on whether people are Hispanic/Latino or not. Essentially the same categories as above remain, with some recodes for multiracial folks done to indicate more nuance in race/ethnicity breakdown. 
# start at 8.
#8 = Hispanic Black
#9 = Hispanic Asian
#10 = Hispanic Native Hawaiian/Other Pacific Islander
#11 = Hispanic Native American/Alaska Native
#12 = Hispanic Multiracial
race$race_categ_spec[which(race$ParticipantID == 207)] <- 10
race$race_categ_spec[which(race$ParticipantID == 223)] <- 9
race$race_categ_spec[which(race$ParticipantID == 229)] <- 10
race$race_categ_spec[which(race$ParticipantID == 239)] <- 12
race$race_categ_spec[which(race$ParticipantID == 268)] <- 12
race$race_categ_spec[which(race$ParticipantID == 320)] <-12
race$race_categ_spec[which(race$ParticipantID == 316)] <- 11
race$race_categ_spec[which(race$ParticipantID == 356)] <- 8

# recode variables as factors and set labels
race <- race %>%
  mutate(race_categ = recode_factor(race_categ, 
                                    `0` = "Non-Hispanic White", 
                                    `1` = "Hispanic/White", 
                                    `2` = "Hispanic/Latinx", 
                                    `3` = "Black/African American", 
                                    `4` = "Asian", 
                                    `5` = "Native American or Alaska Native", 
                                    `6` = "Native Hawaiian or Other Pacific Islander", 
                                    `7` = "Multiracial"), 
         race_categ_spec = recode_factor(race_categ_spec, 
                                         `0` = "Non-Hispanic White", 
                                         `1` = "Hispanic/White", 
                                         `2` = "Hispanic/Latinx", 
                                         `3` = "Black/African American", 
                                         `4` = "Asian", 
                                         `5` = "Native American or Alaska Native", 
                                         `6` = "Native Hawaiian or Other Pacific Islander", 
                                         `7` = "Non-Hispanic Multiracial", 
                                         `8` = "Hispanic Black", 
                                         `9` = "Hispanic Asian", 
                                         `10` = "Hispanic Native Hawaiian/Other Pacific Islander", 
                                         `11` = "Hispanic Native American/Alaska Native", 
                                         `12` = "Hispanic Multiracial"))

# Reattach to main dataframe. 
raw$Race_Multi <- race$Race_Multi
raw$race_categ <- race$race_categ
raw$race_categ_spec <- race$race_categ_spec

# remove race dataframe since no longer needed
rm(race)

####################### SEXUAL ORIENTATION #######################

# There are 2 variables for sexual orientation - one that asks participants to indicate what BEST describes their sexual orientation (SxlOrx). There is another select all that apply if participants indicate that they use multiple labels to describe their sexual orientation (SxlOrx_multiple). The SxlOrx variable will be used for demographics reporting, but here is code to indicate how many multiple labels people use to characterize their sexual orientation. 

# Sum up number of different sexual orientation labels endorsed. 
raw$SxlOrx_Multi_Num <- rowSums(raw[c("SxlOrx_Multi_Het", "SxlOrx_Multi_Bi", "SxlOrx_Multi_Pan", "SxlOrx_Multi_Queer", "SxlOrx_Multi_Fluid", "SxlOrx_Multi_Gay", "SxlOrx_Multi_Les", "SxlOrx_Multi_Ques", "SxlOrx_Multi_Ase", "SxlOrx_Multi_Other")]) 

####################### LIVING SITUATION & COHABITATION #######################

## LIVING SITUATION
# The follow recodes were done by investigators based on the "Other" category for living situation based on free response and investigation of discordant responses. Investigators examined video-recorded discussions and scheduling emails for evidence of cohabitation status. In cases where there are minimally discrepant responses (e.g., they say they live together but maybe one says with other people and the other says with family), we elected to categorize people into a broader cohabitation category (e.g., "other people" could be interpreted as family, so we default to that category in such cases).
raw$LivingSit[which(raw$ParticipantID == 113)] <- 'Live w/ partner + other people' # stated that they live with partner, family, and other people; coding w/ other people here since partner also indicated that
raw$LivingSit[which(raw$ParticipantID == 306)] <- 'Live in same town/region but NOT together' # stated that they have their own place but will sometimes stay over w/ partner; coding as same town/region but not together here 
raw$LivingSit[which(raw$ParticipantID == 367)] <- 'Live w/ partner by ourselves' # stated that husband is truck driver so not always home but they do live together by themselves when home 
raw$LivingSit[which(raw$ParticipantID == 132)] <- 'Live w/ partner + other people' # 1016 had discrepant responses about whether they lived with other people or with family. Coding as live with other people since this a broader category that could also include family. 
raw$LivingSit[which(raw$CoupleID == 1091)] <- 'Live w/ partner + other people' # 1091 had discrepant responses about whether they lived with family or by themselves. Coding as live with other people for same reason as above. 
raw$LivingSit[which(raw$ParticipantID == 294)] <- 'Live w/ partner + other people'# 1097 had discrepant responses about cohabitation (1 partner saying they live together, the other saying they do not). Review of the videos suggested that they do live together based on conversation, so this recodes those responses. 
raw$LivingSit[which(raw$ParticipantID == 344)] <- 'Live in same town/region but NOT together'#1122 had discrepant responses about whether they lived in the same town in region (1 saying they do but don't live together, the other saying they do not live in the same town/region). Review of the videos suggested that they are in the same region, so this recodes those responses. 
 
# Create dichotomous cohabitating vs not variable. 
raw <- raw %>% 
  mutate(Cohab = if_else(LivingSit == "Live w/ partner by ourselves" | LivingSit == "Live w/ partner + other people" | LivingSit == "Live w/ partner + family", 1, 0),
         Cohab = recode_factor(Cohab, 
                           `0` = "Not cohabitating", 
                           `1` = "Cohabitating"))
## COHABITATION
# Fixing cohabitation length variables. 
raw$CohabLength_Years[which(raw$ParticipantID == 334)] <- 2 # making variable numeric -- participant had written in "years" and "months" in free response
raw$CohabLength_Mos[which(raw$ParticipantID == 334)] <- 4
raw$CohabLength_Mos[which(raw$ParticipantID == 187)] <- 5
raw$CohabLength_Years[which(raw$ParticipantID == 193)] <- 0 # pt left blank instead of putting a 0
raw$CohabLength_Mos[which(raw$ParticipantID == 208)] <- 0
raw$CohabLength_Mos[which(raw$ParticipantID == 192)] <- 0

# Making into numeric for computing
raw$CohabLength_Mos <- as.numeric(as.character(raw$CohabLength_Mos))
raw$CohabLength_Years <- as.numeric(as.character(raw$CohabLength_Years))

# Getting a cohabitation variable scaled in months & years
raw$CohabLength_Tot_Mos <- (raw$CohabLength_Years*12) + raw$CohabLength_Mos
raw$CohabLength_Tot_Yrs <- (raw$CohabLength_Mos/12) + raw$CohabLength_Years

####################### RELATIONSHIP LENGTH #######################

# Relationship length - current
# Fixing relationship length variable - just changing text responses to numeric form 
raw$RelLength_Mos[which(raw$ParticipantID == 262)] <- 0
raw$RelLength_Years[which(raw$ParticipantID == 262)] <- 1
raw$RelLength_Mos[which(raw$ParticipantID == 303)] <- 9
raw$RelLength_Mos[which(raw$ParticipantID == 334)] <- 4
raw$RelLength_Years[which(raw$ParticipantID == 334)] <- 4
raw$RelLength_Mos[which(raw$ParticipantID == 192)] <- 0
raw$RelLength_Years[which(raw$ParticipantID == 224)] <- 0

raw$RelLength_Mos <- as.numeric(as.character(raw$RelLength_Mos))
raw$RelLength_Years <- as.numeric(as.character(raw$RelLength_Years))

raw$RelLength_Tot_Mos <- (raw$RelLength_Years*12) + raw$RelLength_Mos
raw$RelLength_Tot_Yrs <- (raw$RelLength_Mos/12) + raw$RelLength_Years

# Relationship length - predating. 
raw$RelLength_predating_Mos[which(raw$ParticipantID == 262)] <- 3
raw$RelLength_predating_Mos[which(raw$ParticipantID == 328)] <- 0
raw$RelLength_predating_Mos[which(raw$ParticipantID == 355)] <- 1
raw$RelLength_predating_Years[which(raw$ParticipantID == 328)] <- 0
raw$RelLength_predating_Years[which(raw$ParticipantID == 333)] <- 0
raw$RelLength_predating_Years[which(raw$ParticipantID == 192)] <- 0
raw$RelLength_predating_Years[which(raw$ParticipantID == 185)] <- 0
raw$RelLength_predating_Years[which(raw$ParticipantID == 230)] <- 0

raw$RelLength_predating_Mos <- as.numeric(as.character(raw$RelLength_predating_Mos))
raw$RelLength_predating_Years <- as.numeric(as.character(raw$RelLength_predating_Years))

raw$RelLength_Tot_predating_Mos <- (raw$RelLength_predating_Years*12) + raw$RelLength_predating_Mos
raw$RelLength_Tot_predating_Yrs <- (raw$RelLength_predating_Mos/12) + raw$RelLength_predating_Years

####################### RELATIONSHIP STATUS #######################

# Following recodes were done by the investigators so there is a consistent response for each couple if there were any discrepancies. Rationale is listed. 
raw$RelStatus[which(raw$CoupleID == 1007)] <- 'Married/civil union' # Recoding other from free response to reflect married status
raw$RelStatus[which(raw$CoupleID == 1084)] <- 'Committed relationship' # Recoding other from free response to reflect partnered status 
raw$RelStatus[which(raw$CoupleID == 1019)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated committed relationship, the other indicated dating. Given conceptual overlap, recoding to committed relationship here. 
raw$RelStatus[which(raw$CoupleID == 1024)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated engaged, the other indicated committed relationship. Recoding to committed relationship to be safer. 
raw$RelStatus[which(raw$CoupleID == 1045)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated committed relationship, the other indicated dating. Given conceptual overlap, recoding to committed relationship here.
raw$RelStatus[which(raw$CoupleID == 1070)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated engaged, the other indicated committed relationship. Recoding to committed relationship to be safer. 
raw$RelStatus[which(raw$CoupleID == 1088)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated committed relationship, the other indicated dating. Given conceptual overlap, recoding to committed relationship here. 
raw$RelStatus[which(raw$CoupleID == 1097)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated committed relationship, the other indicated dating. Given conceptual overlap, recoding to committed relationship here. 
raw$RelStatus[which(raw$CoupleID == 1054)] <- 'Committed relationship' # Discrepant responses where 1 partner indicated committed relationship, the other indicated dating. Given conceptual overlap, recoding to committed relationship here. 
raw$RelStatus[which(raw$CoupleID == 1105)] <- 'Married/civil union' # Discrepant responses where 1 partner indicated married/civil union and the other indicated committed relationship. Review of videos for this couple suggested that married is more accurate (e.g., visible wedding rings).
raw$RelStatus[which(raw$CoupleID == 1128)] <- 'Dating relationship' # Discrepant responses where 1 partner indicated dating relationship and other indicated a "situationship" in other responses. Dating relationship is more inclusive. 

####################### CONSENSUAL NON-MONOGAMY #######################
# Select out into a separate dataframe.
cnm <- dplyr::select(raw, CoupleID, ParticipantID, CNM_Current_Monog:CNM_Current_Other_Text)

# Sum up the number of different categories endorsed. 
cnm$CNM_num <- rowSums(cnm[c("CNM_Current_Monog", "CNM_Current_Open", "CNM_Current_Poly", "CNM_Current_Swinger", "CNM_Current_Anarch", "CNM_Current_Monogish", "CNM_Current_Other")])

# Creating a variable for anyone who selected more than 1 CNM category. 
cnm$CNM_Multi <- 0
cnm$CNM_Multi[which(cnm$CNM_num > 1)] <- 1

# Creating factor variable that has all of the CNM identities in independent groups. 
cnm$CNM_Categ <- NA 
cnm$CNM_Categ[which(cnm$CNM_Current_Monog == 1)] <- 0
cnm$CNM_Categ[which(cnm$CNM_Current_Open == 1)] <- 2
cnm$CNM_Categ[which(cnm$CNM_Current_Poly == 1)] <- 3
cnm$CNM_Categ[which(cnm$CNM_Current_Swinger == 1)] <- 4
cnm$CNM_Categ[which(cnm$CNM_Current_Anarch == 1)] <- 5
cnm$CNM_Categ[which(cnm$CNM_Current_Monogish == 1)] <- 1
cnm$CNM_Categ[which(cnm$CNM_Current_Other == 1)] <- 6
cnm$CNM_Categ[which(cnm$CNM_Multi == 1)] <- 7 

cnm <- cnm %>% 
  mutate(CNM_Categ = recode_factor(CNM_Categ,
                                   `0` = "Monogamous",
                                   `1` = "Monogamish",
                                   `2` = "Open",
                                   `3` = "Polyamorous",
                                   `4` = "Swinger",
                                   `5` = "Relationship Anarchy",
                                   `6` = "Other (specify)",
                                   `7` = "Multiple CNM Identities"))


# Create a dichotomous variable for monogamous or non-monogamous. 
cnm <- cnm %>% 
  mutate(CNM_YN = if_else(CNM_Current_Open == 1 | CNM_Current_Poly == 1 | CNM_Current_Swinger == 1 | CNM_Current_Anarch == 1 | CNM_Current_Monogish == 1, 1, 0),
         CNM_YN = recode_factor(CNM_YN,
                                `0` = "Monogamous Relationship",
                                `1` = "Non-Monogamous Relationship"))

# Recoding based on "Other" responses.
cnm$CNM_YN[which(cnm$ParticipantID == 271)] <- 'Non-Monogamous Relationship' # recoding to a 1 because they indicated in free response being open as long as it was together 
cnm$CNM_Categ[which(cnm$ParticipantID == 259)] <- 'Other (specify)' # recoding to this category because they indicated being ina questioning/undecided phase, would not be appropriate to count as multiple CNM identities. 

# Reattach to main dataframe. 
raw$CNM_YN <- cnm$CNM_YN
raw$CNM_Categ <- cnm$CNM_Categ
rm(cnm)

####################### RECRUITMENT SOURCE #######################

# Recode free-response for "Other Social Media" - basically all but 3 said Reddit, so changing this category to be Reddit and recoding those 3 into the Facebook category. 
raw$RecruitmentSource[which(raw$ParticipantID == 145)] <- 'Facebook' # recoding to Facebook
raw$RecruitmentSource[which(raw$ParticipantID == 239)] <- 'Facebook'
raw$RecruitmentSource[which(raw$ParticipantID == 267)] <- 'Facebook'

# Changes the "Other Social Media" level to be Reddit.
raw <- raw %>% 
  mutate(RecruitmentSource = fct_recode(RecruitmentSource,
                                        "Reddit" = "Other social media"))

# Recodes based on free-responses for "Other". 
raw$RecruitmentSource[which(raw$ParticipantID == 330)] <- 'Someone I know' # partner told them about it, so coding as this
raw$RecruitmentSource[which(raw$ParticipantID == 146)] <- 'Facebook' 
raw$RecruitmentSource[which(raw$ParticipantID == 240)] <- 'Someone I know' # partner told them about it
raw$RecruitmentSource[which(raw$ParticipantID == 264)] <- 'Facebook' 
raw$RecruitmentSource[which(raw$ParticipantID == 248)] <- 'Someone I know' # partner told them about it  
raw$RecruitmentSource[which(raw$ParticipantID == 197)] <- 'Facebook'
raw$RecruitmentSource[which(raw$ParticipantID == 309)] <- 'Someone I know' # friend sent them a link to FB page

# Note: The 2 "Other/not listed (specify)" cases here = "don't remember" and "Craigslist" 

####################### HOMETOWN LENGTH & YEARS #######################

# These two variables were imported as character vectors, so this changes the responses to be numeric for anyone that wrote non-numeric characters (e.g., "14 years" instead of "14")

raw$HometownLength_Years[which(raw$ParticipantID == 228)] <- 11
raw$HometownLength_Years[which(raw$ParticipantID == 191)] <- 13
raw$HometownLength_Years[which(raw$ParticipantID == 175)] <- 14
raw$HometownLength_Years[which(raw$ParticipantID == 147)] <- 17
raw$HometownLength_Years[which(raw$ParticipantID == 334)] <- 17
raw$HometownLength_Years[which(raw$ParticipantID == 181)] <- 18
raw$HometownLength_Years[which(raw$ParticipantID == 236)] <- 18
raw$HometownLength_Years[which(raw$ParticipantID == 325)] <- 18
raw$HometownLength_Years[which(raw$ParticipantID == 253)] <- 21
raw$HometownLength_Years[which(raw$ParticipantID == 176)] <- 23
raw$HometownLength_Years[which(raw$ParticipantID == 192)] <- 6
raw$HometownLength_Years[which(raw$ParticipantID == 113)] <- 8
raw$HometownLength_Years[which(raw$ParticipantID == 262)] <- 8
raw$HometownLength_Years[which(raw$ParticipantID == 158)] <- 23
raw$HometownLength_Years[which(raw$ParticipantID == 303)] <- 19

raw$HometownLength_Mos[which(raw$ParticipantID == 286)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 192)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 113)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 147)] <- 1
raw$HometownLength_Mos[which(raw$ParticipantID == 236)] <- 1
raw$HometownLength_Mos[which(raw$ParticipantID == 198)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 224)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 334)] <- 6
raw$HometownLength_Mos[which(raw$ParticipantID == 262)] <- 6
raw$HometownLength_Mos[which(raw$ParticipantID == 325)] <- 8
raw$HometownLength_Mos[which(raw$ParticipantID == 157)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 158)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 303)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 122)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 240)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 228)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 191)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 204)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 313)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 230)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 266)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 197)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 193)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 118)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 229)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 319)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 272)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 260)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 187)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 209)] <- 0
raw$HometownLength_Mos[which(raw$ParticipantID == 208)] <- 0

raw$HometownLength_Mos <- as.numeric(as.character(raw$HometownLength_Mos))
raw$HometownLength_Years <- as.numeric(as.character(raw$HometownLength_Years))

raw$HometownLength_Tot_Mos <- (raw$HometownLength_Years*12) + raw$HometownLength_Mos
raw$HometownLength_Tot_Yrs <- (raw$HometownLength_Mos/12) + raw$HometownLength_Years

####################### SEXUAL ORIENTATION AND GENDER IDENTITY MATCHING #######################

# Code to set up variables for couple sexual orientation & gender identity composition. The following are investigator created variables to describe how many couples share similar identities - we term them as "match" variables to indicate whether both partners share the same sexual and gender identity labels. 

# Separate out variables of interest into another dataframe, converts from long to wide to organize at the couple level. 
id <- dplyr::select(raw, CoupleID, ParticipantID, SxlOrx, SxlOrx_Other_Text, SxlOrx_multiple, GenderIdent, GenderIdent_Other_Text) %>% 
  group_by(CoupleID) %>% 
  mutate(rownum = row_number()) %>% 
  ungroup() %>% 
  pivot_wider(id_cols = CoupleID, names_from = rownum, values_from = c(SxlOrx, SxlOrx_Other_Text, SxlOrx_multiple, GenderIdent, GenderIdent_Other_Text)) %>% 
  dplyr::select(CoupleID, SxlOrx_1, SxlOrx_Other_Text_1, SxlOrx_2, SxlOrx_Other_Text_2, SxlOrx_multiple_1, SxlOrx_multiple_2, GenderIdent_1, GenderIdent_Other_Text_1, GenderIdent_2, GenderIdent_Other_Text_2)

# Gender identity groupings are as follows: 0) same-sex cisgender female couple, 1) same-sex cisgender male couple, 2) mixed-sex cisgender couple (one cis man, one cis woman), 3) gender diverse/cisgender couple (meaning 1 partner is gender diverse, one is cis), 4) gender diverse couple (both are not cis). 
id <- id %>% 
  mutate(GenderIdent_match = case_when(
    (GenderIdent_1 == 'Woman' & GenderIdent_2 == 'Woman') ~ 0, # same-sex cis female couple
    (GenderIdent_1 == 'Man' & GenderIdent_2 == 'Man') ~ 1, # same-sex cis male couple 
    (GenderIdent_1 == 'Man' & GenderIdent_2 == 'Woman') ~ 2, # mixed-sex cis couple
    (GenderIdent_1 == 'Woman' & GenderIdent_2 == 'Man') ~ 2, # mixed-sex cis couple
    (GenderIdent_1 == 'Man' | GenderIdent_1 == 'Woman') & (GenderIdent_2 == 'Transgender man (trans man)' | GenderIdent_2 == 'Transgender woman (trans woman)' | GenderIdent_2 == 'Gender non-conforming' | GenderIdent_2 == 'Genderqueer' | GenderIdent_2 == 'Non-binary' | GenderIdent_2 == 'Other (specify)') ~ 3, # gender diverse/cis couple
    (GenderIdent_1 == 'Transgender man (trans man)' | GenderIdent_1 == 'Transgender woman (trans woman)' | GenderIdent_1 == 'Gender non-conforming' | GenderIdent_1 == 'Genderqueer' | GenderIdent_1 == 'Non-binary' | GenderIdent_1 == 'Other (specify)') & (GenderIdent_2 == 'Man' | GenderIdent_2 == 'Woman') ~ 3, # gender diverse/cis couple
    (GenderIdent_1 == 'Transgender man (trans man)' | GenderIdent_1 == 'Transgender woman (trans woman)' | GenderIdent_1 == 'Gender non-conforming' | GenderIdent_1 == 'Genderqueer' | GenderIdent_1 == 'Non-binary' | GenderIdent_1 == 'Other (specify)') & (GenderIdent_2 == 'Transgender man (trans man)' | GenderIdent_2 == 'Transgender woman (trans woman)' | GenderIdent_2 == 'Gender non-conforming' | GenderIdent_2 == 'Genderqueer' | GenderIdent_2 == 'Non-binary' | GenderIdent_2 == 'Other (specify)') ~ 4 # gender diverse couple
    )) %>% 
  mutate(GenderIdent_match = if_else(CoupleID == 1060, 0, GenderIdent_match) # recoded given write-in for gender identity for one of the epartners
         ) %>% 
  mutate(GenderIdent_match = recode_factor(GenderIdent_match,
                                           `0` = "Same-sex cisgender female couple", 
                                           `1` = "Same-sex cisgender male couple",
                                           `2` = "Mixed-sex cisgender couple",
                                           `3` = "Gender diverse/cisgender couple",
                                           `4` = "Gender diverse couple"))

# Sexual orientation groups are as follows: 0) same-identity monosexual, 1) same-identity bi+, 2) mixed identity (e.g., 1 monosexual, 1 bisexual). 
id <- id %>% 
  mutate(SxlOrx_match = case_when(
    (SxlOrx_1 == 'Gay' | SxlOrx_1 == 'Lesbian') & (SxlOrx_2 == 'Gay' | SxlOrx_2 == 'Lesbian') ~ 0, # same-identity monosexual
    (SxlOrx_1 == 'Queer' | SxlOrx_1 == 'Bisexual' | SxlOrx_1 == 'Pansexual' | SxlOrx_1 == 'Fluid') & (SxlOrx_2 == 'Queer' | SxlOrx_2 == 'Bisexual' | SxlOrx_2 == 'Pansexual' | SxlOrx_2 == 'Fluid') ~ 1, # same-identity bi+
    (SxlOrx_1 == 'Queer' | SxlOrx_1 == 'Bisexual' | SxlOrx_1 == 'Pansexual' | SxlOrx_1 == 'Fluid') & (SxlOrx_2 == 'Gay' | SxlOrx_2 == 'Lesbian') ~ 2, # mixed identity
    (SxlOrx_1 == 'Gay' | SxlOrx_1 == 'Lesbian') & (SxlOrx_2 == 'Queer' | SxlOrx_2 == 'Bisexual' | SxlOrx_2 == 'Pansexual' | SxlOrx_2 == 'Fluid') ~ 2 # mixed identity
  )) %>% 
  dplyr::select(CoupleID, SxlOrx_1:SxlOrx_Other_Text_2, SxlOrx_match, everything())

# The following couples were coded by hand for ease given write-ins. 
id <- id %>% 
  mutate(SxlOrx_match = if_else(CoupleID == 1011, 2, SxlOrx_match),
         SxlOrx_match = if_else(CoupleID == 1065, 2, SxlOrx_match),
         SxlOrx_match = if_else(CoupleID == 1080, 1, SxlOrx_match),
         SxlOrx_match = if_else(CoupleID == 1082, 2, SxlOrx_match),
         SxlOrx_match = if_else(CoupleID == 1084, 1, SxlOrx_match),
         SxlOrx_match = if_else(CoupleID == 1104, 1, SxlOrx_match),
         SxlOrx_match = if_else(CoupleID == 1115, 0, SxlOrx_match)) %>% 
  mutate(SxlOrx_match = recode_factor(SxlOrx_match,
                       `0` = "Same-identity monosexual",
                       `1` = "Same-identity bi+/non-monosexual",
                       `2` = "Mixed identity"))

# Isolate just the matching variables to be merged into the long dataset. 
id <- dplyr::select(id, CoupleID, SxlOrx_match, GenderIdent_match)

# Merge matching variables into the dataset
raw <- raw %>% 
  left_join(id, by = c("CoupleID"))
rm(id)

####################### REORDER DATASET WITH NEW VARIABLES #######################
raw <- dplyr::select(raw, Progress:Race_Other_Text, Race_Multi, race_categ, race_categ_spec, State:SxlOrx_multiple, SxlOrx_Multi_Num, SxlOrx_Multi_Het:SxlOrx_Multi_Other_Text, SxlOrx_match, GenderIdent, GenderIdent_Other_Text, GenderIdent_match, BirthSex:HometownLength_Mos, HometownLength_Tot_Mos, HometownLength_Tot_Yrs, LivingSit, LivingSit_Other_Text, Cohab, CohabLength_Years, CohabLength_Mos, CohabLength_Tot_Mos, CohabLength_Tot_Yrs, RelStatus:RelLength_Mos, RelLength_Tot_Mos, RelLength_Tot_Yrs, RelLength_predating_Mos, RelLength_predating_Years, RelLength_Tot_predating_Mos, RelLength_Tot_predating_Yrs, HowMet:CNM_Current_Other_Text, CNM_Categ, CNM_YN, everything())

# Create a "clean" dataset to work with
ccs <- raw %>% 
  arrange(ParticipantID)

```


# *Scoring Self-Report Measures*  
##### *Directed Questions Scale (DQS)*  
```{r}
# Recodes DQS items - 0s mean they passed, 1s mean they did NOT. 
# DQS_1-4 & DQS_6 should all be NA.
# DQS_5 should be a 3 - "Very Applicable". 
# DQS_7 should be a 5 - "This happened and it bothered me EXTREMELY".
ccs <- ccs %>% 
  mutate(DQS_1 = if_else(is.na(DQS_1), 0, 1)) %>% 
  mutate(DQS_2 = if_else(is.na(DQS_2), 0, 1)) %>% 
  mutate(DQS_3 = if_else(is.na(DQS_3), 0, 1)) %>%
  mutate(DQS_4 = if_else(is.na(DQS_4), 0, 1)) %>%
  mutate(DQS_5 = if_else(DQS_5 == 3, 0, 1, 1)) %>% # extra 1 here and for item 7 replaces missing values with 1, which should be scored as incorrect. 
  mutate(DQS_6 = if_else(is.na(DQS_6), 0, 1)) %>% 
  mutate(DQS_7 = if_else(DQS_7 == 5, 0, 1, 1))

# Create summary variable
ccs$DQS_sum <- rowSums(ccs[c("DQS_1", "DQS_2", "DQS_3", "DQS_4", "DQS_5", "DQS_6", "DQS_7")])

# From RA notes, a few participants accidentally clicked on a DQS item but were unable to deselect it because of Qualtrics. This code fixes those participants. 
ccs <- ccs %>% 
  mutate(DQS_sum = if_else(ParticipantID == 176 | ParticipantID == 322, (DQS_sum - 1), DQS_sum))

# Create a variable marking whether or not the participant passed the attention check.
ccs <- ccs %>% 
  mutate(DQS_pass = if_else(DQS_sum >= 3, 1, 0), 
         DQS_pass = recode_factor(DQS_pass,
                                  `0` = "Passed attn check",
                                  `1` = "Did not pass attn check"))
```

##### *Negative Emotionality Scale (NES)*  
```{r}
## Recodes: Item 21 is reverse-scored
ccs$NES_21r <- recode(ccs$NES_21, '0' = 1, '1' = 0)

## Scoring Instructions: Take the sum of all 30 items to get total score.
ccs$NES_sum <- rowSums(ccs[c("NES_1","NES_2","NES_3","NES_4","NES_5","NES_6","NES_7","NES_8","NES_9","NES_10","NES_11","NES_12","NES_13","NES_14","NES_15","NES_16","NES_17","NES_18","NES_19","NES_20","NES_21r","NES_22","NES_23","NES_24","NES_25","NES_26","NES_27","NES_28","NES_29","NES_30")], na.rm = TRUE)

# Reliability for NES
dplyr::select(ccs, NES_1:NES_20, NES_21r, NES_22:NES_30, -DQS_4) %>% psych::alpha()

# Frequencies for NES
describe(ccs$NES_sum)

# Histogram for NES
ggplot(data = ccs, aes(NES_sum)) + geom_histogram(binwidth = 1)

```

##### *Couples Satisfaction Index (CSI)*  
```{r}
## Recodes: Items 11, 13, 14, 16 need to be reverse-scored. 
ccs <- ccs %>% 
  mutate(CSI_11r = recode(CSI_11, '0' = 5, '1' = 4, '2' = 3, '3' = 2, '4' = 1, '5' = 0),
         CSI_13r = recode(CSI_13, '0' = 5, '1' = 4, '2' = 3, '3' = 2, '4' = 1, '5' = 0),
         CSI_14r = recode(CSI_14, '0' = 5, '1' = 4, '2' = 3, '3' = 2, '4' = 1, '5' = 0),
         CSI_16r = recode(CSI_16, '0' = 5, '1' = 4, '2' = 3, '3' = 2, '4' = 1, '5' = 0))

## Scoring Instructions: Score obtained via sum of all 16 items. 
ccs$CSI_sum <- rowSums(ccs[c("CSI_1", "CSI_2",  "CSI_3", "CSI_4", "CSI_5", "CSI_6", "CSI_7", "CSI_8", "CSI_9", "CSI_10", "CSI_11r", "CSI_12", "CSI_13r", "CSI_14r", "CSI_15", "CSI_16r")], na.rm = TRUE)

# Reliability
dplyr::select(ccs, CSI_1, CSI_2, CSI_3, CSI_4, CSI_5, CSI_6, CSI_7, CSI_8, CSI_9, CSI_10, CSI_11r, CSI_12, CSI_13r, CSI_14r, CSI_15, CSI_16r) %>% psych::alpha()

# Frequencies
describe(ccs$CSI_sum)

# Histogram 
ggplot(data = ccs, aes(CSI_sum)) + geom_histogram(binwidth = 1)

```

##### *Positive-Negative Relationship Quality Scale (PNRQ)*  
```{r}
# Recodes: None for this scale. 

# Scoring Instructions: Positive subscale is sum of positive items, negative subscale is sum of negative items. 
ccs$PNRQ_pos_sum <- rowSums(ccs[c("PNRQ_pos_1", "PNRQ_pos_2", "PNRQ_pos_3", "PNRQ_pos_4")], na.rm = TRUE)
ccs$PNRQ_neg_sum <- rowSums(ccs[c("PNRQ_neg_1", "PNRQ_neg_2", "PNRQ_neg_3", "PNRQ_neg_4")], na.rm = TRUE)

# Reliability
dplyr::select(ccs, PNRQ_pos_1:PNRQ_pos_4) %>% psych::alpha()
dplyr::select(ccs, PNRQ_neg_1:PNRQ_neg_4) %>% psych::alpha()

# Frequencies
describe(ccs$PNRQ_pos_sum)
describe(ccs$PNRQ_neg_sum)

# Histogram 
ggplot(data = ccs, aes(PNRQ_pos_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(PNRQ_neg_sum)) + geom_histogram(binwidth = 1)

```

##### *Quality of Sex Inventory (QSI)*  
```{r}
# Recodes: None for this scale. 

## Scoring Instructions: Items 1-6 are summed to form the satisfaction scale, items 7-12 are summed to form dissatisfaction scale. 
ccs$QSI_Sat_sum <- rowSums(ccs[c("QSI_1","QSI_2","QSI_3","QSI_4","QSI_5", "QSI_6")], na.rm = TRUE)
ccs$QSI_Dissat_sum <-rowSums(ccs[c("QSI_7","QSI_8","QSI_9","QSI_10","QSI_11", "QSI_12")], na.rm = TRUE)

# PTID 121 did not complete the scale, so this recodes their responses to be NA. 
ccs$QSI_Sat_sum[which(ccs$ParticipantID == 121)] <- NA
ccs$QSI_Dissat_sum[which(ccs$ParticipantID == 121)] <- NA

# Reliability
dplyr::select(ccs, QSI_1:QSI_6) %>% psych::alpha()
dplyr::select(ccs, QSI_7:QSI_12) %>% psych::alpha()

# Frequencies
describe(ccs$QSI_Sat_sum)
describe(ccs$QSI_Dissat_sum)

# Histogram 
ggplot(data = ccs, aes(QSI_Sat_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(QSI_Dissat_sum)) + geom_histogram(binwidth = 1)

```

##### *Dyadic Trust Scale (DTS)*  
```{r}
# Recodes: Items 1, 2, 6 need to be reverse-scored.
ccs <- ccs %>% 
  mutate(DTS_1r = recode(DTS_1, '1'= 7, '2'= 6, '3'= 5, '4'= 4, '5'= 3, '6'= 2, '7'= 1),
         DTS_2r = recode(DTS_2, '1'= 7, '2'= 6, '3'= 5, '4'= 4, '5'= 3, '6'= 2, '7'= 1),
         DTS_6r = recode(DTS_6, '1'= 7, '2'= 6, '3'= 5, '4'= 4, '5'= 3, '6'= 2, '7'= 1))

# Scoring Instructions: Total score obtained via sum of all 8 items. 
ccs$DTS_sum <- rowSums(ccs[c("DTS_1r", "DTS_2r", "DTS_3", "DTS_4", "DTS_5", "DTS_6r", "DTS_7", "DTS_8")], na.rm = TRUE)

# Reliability
dplyr::select(ccs, DTS_1r, DTS_2r, DTS_3, DTS_4, DTS_5, DTS_6r, DTS_7, DTS_8) %>% psych::alpha()

# Frequencies
describe(ccs$DTS_sum)

# Histogram 
ggplot(data = ccs, aes(DTS_sum)) + geom_histogram(binwidth = 1)

```

##### *Revised Commitment Inventory (RCI)*  
```{r}
## Recodes: items 1, 17, 2, 7, 13, 6, 16, 10, 12, 14, 21, 23, 24, and 25 need to be reverse-scored. All items are coded such that higher scores represent greater committment based on that subscale (i.e., greater mean on social pressure subscales means higher commitment b/c it would be hard to end the relationship due to social pressure)
ccs <- ccs %>% 
  mutate(RCI_1r = recode(RCI_1, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_17r = recode(RCI_17, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_2r = recode(RCI_2, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_7r = recode(RCI_7, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_13r = recode(RCI_13, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_6r = recode(RCI_6, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_16r = recode(RCI_16, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_10r = recode(RCI_10, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_12r = recode(RCI_12, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_14r = recode(RCI_14, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_21r = recode(RCI_21, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_23r = recode(RCI_23, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_24r = recode(RCI_24, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         RCI_25r = recode(RCI_25, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),)

## Scoring Instructions: Use mean to calculate scores.  
# Social Pressure Subscale (items 1r, 5, 8, 17r)
ccs$RCI_SP_mean <- rowMeans(ccs[c("RCI_1r","RCI_5","RCI_8","RCI_17r")], na.rm = TRUE)
# Concern for Partner's Welfare (2 items) = items 4, 16r
ccs$RCI_CPW_mean <- rowMeans(ccs[c("RCI_4","RCI_16r")], na.rm = TRUE)
# Financial Alternatives (3 items) = items 2r, 7r, 13r
ccs$RCI_FA_mean <- rowMeans(ccs[c("RCI_2r","RCI_7r","RCI_13r")],na.rm = TRUE)
# Termination Procedures (3 items) = items 3, 6r, 15
ccs$RCI_TP_mean <- rowMeans(ccs[c("RCI_3","RCI_6r","RCI_15")], na.rm = TRUE)
# Structural Investments (2 items) = items 11, 14r 
ccs$RCI_SI_mean <- rowMeans(ccs[c("RCI_11","RCI_14r")], na.rm = TRUE)
# Availability of other Partners (3 items) = items 9, 10r, 12r 
ccs$RCI_AoP_mean <- rowMeans(ccs[c("RCI_9","RCI_10r","RCI_12r")], na.rm = TRUE)
# Dedication Subscale (8 items) = 18, 19, 20, 21r, 22, 23r, 24r, 25r 
ccs$RCI_Ded_mean <- rowMeans(ccs[c("RCI_18", "RCI_19", "RCI_20", "RCI_21r", "RCI_22", "RCI_23r", "RCI_24r", "RCI_25r")], na.rm = TRUE)

# Note you could make a full "Total Constraint" scale but it doesn't seem like a good one based on the Owen et al. 2011 paper - based on prior research, the Dedication subscale is likely the best overall index of commitment. 

## Reliability 
# Note some of these scales have atrocious reliabilities but are consistent with those reported in Owen et al. 2011 - means and SDs are also consistent with those reported there. 
# Social Pressure Subscale (items 1r, 5, 8, 17r)
dplyr::select(ccs, RCI_1r, RCI_5, RCI_8, RCI_17r) %>% psych::alpha()
# Concern for Partner's Welfare (2 items) = items 4r, 16
dplyr::select(ccs, RCI_4, RCI_16r) %>% psych::alpha()
# Financial Alternatives (3 items) = items 2, 7, 13
dplyr::select(ccs, RCI_2r, RCI_7r, RCI_13r) %>% psych::alpha()
# Termination Procedures (3 items) = items 3r, 6, 15r
dplyr::select(ccs, RCI_3, RCI_6r, RCI_15) %>% psych::alpha()
# Structural Investments (2 items) = items 11r, 14 
dplyr::select(ccs, RCI_11,RCI_14r) %>% psych::alpha()
# Availability of Partners Subscale = items 9r, 10, 12
dplyr::select(ccs, RCI_9, RCI_10r, RCI_12r) %>% psych::alpha()
# Dedication Subscale
dplyr::select(ccs, RCI_18, RCI_19, RCI_20, RCI_21r, RCI_22, RCI_23r, RCI_24r, RCI_25r) %>% psych::alpha()

## Frequencies
describe(ccs$RCI_Ded_mean)
describe(ccs$RCI_SI_mean)
describe(ccs$RCI_AoP_mean)
describe(ccs$RCI_TP_mean)
describe(ccs$RCI_FA_mean)
describe(ccs$RCI_CPW_mean)
describe(ccs$RCI_SP_mean)

## Histogram 
ggplot(data = ccs, aes(RCI_Ded_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RCI_SI_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RCI_AoP_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RCI_TP_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RCI_FA_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RCI_CPW_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RCI_SP_mean)) + geom_histogram(binwidth = 1)

```

##### *Conflict Tactics Scale 2 (CTS)*  
```{r}
## Recodes: Any response of "7" means that the IPV act did not occur in the past year, this recodes as 0 sincce that means no IPV occurred. 
ccs <- ccs %>% 
  mutate(CTS_1 = recode(CTS_1, '7' = 0),
         CTS_2 = recode(CTS_2, '7' = 0),
         CTS_3 = recode(CTS_3, '7' = 0),
         CTS_4 = recode(CTS_4, '7' = 0),
         CTS_5 = recode(CTS_5, '7' = 0),
         CTS_6 = recode(CTS_6, '7' = 0),
         CTS_7 = recode(CTS_7, '7' = 0),
         CTS_8 = recode(CTS_8, '7' = 0),
         CTS_9 = recode(CTS_9, '7' = 0),
         CTS_10 = recode(CTS_10, '7' = 0),
         CTS_11 = recode(CTS_11, '7' = 0),
         CTS_12 = recode(CTS_12, '7' = 0),
         CTS_13 = recode(CTS_13, '7' = 0),
         CTS_14 = recode(CTS_14, '7' = 0),
         CTS_15 = recode(CTS_15, '7' = 0),
         CTS_16 = recode(CTS_16, '7' = 0),
         CTS_17 = recode(CTS_17, '7' = 0),
         CTS_18 = recode(CTS_18, '7' = 0),
         CTS_19 = recode(CTS_19, '7' = 0),
         CTS_20 = recode(CTS_20, '7' = 0),
         CTS_21 = recode(CTS_21, '7' = 0),
         CTS_22 = recode(CTS_22, '7' = 0),
         CTS_23 = recode(CTS_23, '7' = 0),
         CTS_24 = recode(CTS_24, '7' = 0),
         CTS_25 = recode(CTS_25, '7' = 0),
         CTS_26 = recode(CTS_26, '7' = 0),
         CTS_27 = recode(CTS_27, '7' = 0),
         CTS_28 = recode(CTS_28, '7' = 0),
         CTS_29 = recode(CTS_29, '7' = 0),
         CTS_30 = recode(CTS_30, '7' = 0),
         CTS_31 = recode(CTS_31, '7' = 0),
         CTS_32 = recode(CTS_32, '7' = 0),
         CTS_33 = recode(CTS_33, '7' = 0),
         CTS_34 = recode(CTS_34, '7' = 0),
         CTS_35 = recode(CTS_35, '7' = 0),
         CTS_36 = recode(CTS_36, '7' = 0),
         CTS_37 = recode(CTS_37, '7' = 0),
         CTS_38 = recode(CTS_38, '7' = 0),
         CTS_39 = recode(CTS_39, '7' = 0),
         CTS_40 = recode(CTS_40, '7' = 0),
         CTS.SGM_41 = recode(CTS.SGM_41, '7' = 0),
         CTS.SGM_42 = recode(CTS.SGM_42, '7' = 0),
         CTS.SGM_43 = recode(CTS.SGM_43, '7' = 0),
         CTS.SGM_44 = recode(CTS.SGM_44, '7' = 0),
         CTS.SGM_45 = recode(CTS.SGM_45, '7' = 0),
         CTS.SGM_46 = recode(CTS.SGM_46, '7' = 0),
         CTS.SGM_47 = recode(CTS.SGM_47, '7' = 0),
         CTS.SGM_48 = recode(CTS.SGM_48, '7' = 0),
         CTS.SGM_49 = recode(CTS.SGM_49, '7' = 0),
         CTS.SGM_50 = recode(CTS.SGM_50, '7' = 0))

## Scoring Instructions: Note that odd numbers reflect perpetration, even numbers reflect victimization. There are many ways to score the CTS2 (adapted for SGMs) depending on the research question at hand. This code will create summary scores for highest report (either victimization or perpetration) for physical aggression, psychological aggression, and SGM-specific aggression. 

# Psychological aggression perpetration
ccs$CTS_PsychPerp <- rowSums(ccs[c("CTS_1", "CTS_3", "CTS_5", "CTS_7", "CTS_9", "CTS_11", "CTS_13", "CTS_15")], na.rm = TRUE)
# Psychological aggression victimization 
ccs$CTS_PsychVict <- rowSums(ccs[c("CTS_2", "CTS_4", "CTS_6", "CTS_8", "CTS_10", "CTS_12", "CTS_14", "CTS_16")], na.rm = TRUE)
# Physical aggression perpetration
ccs$CTS_PhysPerp <- rowSums(ccs[c("CTS_17", "CTS_19", "CTS_21", "CTS_23", "CTS_25", "CTS_27", "CTS_29", "CTS_31", "CTS_33", "CTS_35", "CTS_37", "CTS_39")], na.rm = TRUE)
# Physical aggression victimization
ccs$CTS_PhysVict <- rowSums(ccs[c("CTS_18", "CTS_20", "CTS_22", "CTS_24", "CTS_26", "CTS_28", "CTS_30", "CTS_32", "CTS_34", "CTS_36", "CTS_38", "CTS_40")], na.rm = TRUE)
# SGM-specific aggression perpetration
ccs$CTS_SGMspecPerp <- rowSums(ccs[c("CTS.SGM_41", "CTS.SGM_43", "CTS.SGM_45", "CTS.SGM_47", "CTS.SGM_49")], na.rm = TRUE)
# SGM-specific aggression victimization
ccs$CTS_SGMspecVict <- rowSums(ccs[c("CTS.SGM_42", "CTS.SGM_44", "CTS.SGM_46", "CTS.SGM_48", "CTS.SGM_50")], na.rm = TRUE)

# These participants did not complete more than 70% of the items to get a score, so this sets those summary scores to missing (PTID 149 & 356). 
ccs <- ccs %>% 
  mutate(CTS_PsychPerp = if_else(ParticipantID == 356 | ParticipantID == 149, NA_real_, CTS_PsychPerp),
         CTS_PsychVict = if_else(ParticipantID == 356 | ParticipantID == 149, NA_real_, CTS_PsychVict),
         CTS_PhysPerp = if_else(ParticipantID == 356 | ParticipantID == 149, NA_real_, CTS_PhysPerp),
         CTS_PhysVict = if_else(ParticipantID == 356 | ParticipantID == 149, NA_real_, CTS_PhysVict),
         CTS_SGMspecPerp = if_else(ParticipantID == 356 | ParticipantID == 149, NA_real_, CTS_SGMspecPerp),
         CTS_SGMspecVict = if_else(ParticipantID == 356 | ParticipantID == 149, NA_real_, CTS_SGMspecVict))

## Creating highest report variables. 

# Create a variable that denotes whether they are partner 1 or partner 2 in the couple.
ccs <- ccs %>% 
  group_by(CoupleID) %>% 
  mutate(rownum = row_number()) %>% 
  ungroup()

# Convert dataset to wide format so scores can be compared. 
CTS.w <- ccs %>%
  dplyr::select(CoupleID, ParticipantID, rownum, CTS_PsychPerp, CTS_PsychVict, CTS_PhysPerp, CTS_PhysVict, CTS_SGMspecPerp, CTS_SGMspecVict, everything()) %>% 
  pivot_wider(id_cols = CoupleID, names_from = rownum, values_from = c(CTS_PsychPerp, CTS_PsychVict, CTS_PhysPerp, CTS_PhysVict, CTS_SGMspecPerp, CTS_SGMspecVict))

# Create highest report variables for partners. 
CTS.w <- CTS.w %>% 
  mutate(CTS_PsychPerp_HR_1 = if_else(CTS_PsychPerp_1 >= CTS_PsychVict_2, CTS_PsychPerp_1, CTS_PsychVict_2),
         CTS_PsychPerp_HR_2 = if_else(CTS_PsychPerp_2 >= CTS_PsychVict_1, CTS_PsychPerp_2, CTS_PsychVict_1),
         CTS_PsychVict_HR_1 = if_else(CTS_PsychVict_1 >= CTS_PsychPerp_2, CTS_PsychVict_1, CTS_PsychPerp_2),
         CTS_PsychVict_HR_2 = if_else(CTS_PsychVict_2 >= CTS_PsychPerp_1, CTS_PsychVict_2, CTS_PsychPerp_1),
         CTS_PhysPerp_HR_1 = if_else(CTS_PhysPerp_1 >= CTS_PhysVict_2, CTS_PhysPerp_1, CTS_PhysVict_2),
         CTS_PhysPerp_HR_2 = if_else(CTS_PhysPerp_2 >= CTS_PhysVict_1, CTS_PhysPerp_2, CTS_PhysVict_1),
         CTS_PhysVict_HR_1 = if_else(CTS_PhysVict_1 >= CTS_PhysPerp_2, CTS_PhysVict_1, CTS_PhysPerp_2),
         CTS_PhysVict_HR_2 = if_else(CTS_PhysVict_2 >= CTS_PhysPerp_1, CTS_PhysVict_2, CTS_PhysPerp_1), 
         CTS_SGMspecPerp_HR_1 = if_else(CTS_SGMspecPerp_1 >= CTS_SGMspecVict_2, CTS_SGMspecPerp_1, CTS_SGMspecVict_2),
         CTS_SGMspecPerp_HR_2 = if_else(CTS_SGMspecPerp_2 >= CTS_SGMspecVict_1, CTS_SGMspecPerp_2, CTS_SGMspecVict_1),
         CTS_SGMspecVict_HR_1 = if_else(CTS_SGMspecVict_1 >= CTS_SGMspecPerp_2, CTS_SGMspecVict_1, CTS_SGMspecPerp_2),
         CTS_SGMspecVict_HR_2 = if_else(CTS_SGMspecVict_2 >= CTS_SGMspecPerp_1, CTS_SGMspecVict_2, CTS_SGMspecPerp_1)) 

# Move partner 1s and partner 2s to a separate datasets, then merge into 1 to be joined with the full CTS data.  
CTS.p1 <- CTS.w %>% 
 dplyr::select(CoupleID, CTS_PsychPerp_HR = CTS_PsychPerp_HR_1, CTS_PsychVict_HR = CTS_PsychVict_HR_1, CTS_PhysPerp_HR = CTS_PhysPerp_HR_1, CTS_PhysVict_HR = CTS_PhysVict_HR_1, CTS_SGMspecPerp_HR = CTS_SGMspecPerp_HR_1, CTS_SGMspecVict_HR = CTS_SGMspecVict_HR_1) %>% 
  mutate(rownum = 1)

CTS.p2 <- CTS.w %>% 
 dplyr::select(CoupleID, CTS_PsychPerp_HR = CTS_PsychPerp_HR_2, CTS_PsychVict_HR = CTS_PsychVict_HR_2, CTS_PhysPerp_HR = CTS_PhysPerp_HR_2, CTS_PhysVict_HR = CTS_PhysVict_HR_2, CTS_SGMspecPerp_HR = CTS_SGMspecPerp_HR_2, CTS_SGMspecVict_HR = CTS_SGMspecVict_HR_2) %>% 
  mutate(rownum = 2)

CTS.hr <- rbind(CTS.p1, CTS.p2) %>% 
  arrange(CoupleID)

# Join HR variables with full dataset. 
ccs <- ccs %>% 
  left_join(CTS.hr, by = c("CoupleID", "rownum")) %>% 
  dplyr::select(CoupleID, ParticipantID, everything(), -rownum) # note, if you want to double-check results then delete "-rownum"

# Remove unneeded datasets 
rm(CTS.w) 
rm(CTS.p1)
rm(CTS.p2)
rm(CTS.hr) 

# Finally, 2 participants (149 & 356) did not have enough data to calculate a summary score. Given the way the code was written above, this will mark the variables for BOTH partners in each couple as NA. This code sets the scores for this couple based on the partner that had available data - thus, make sure to document in any write-up with these variables that 2 couples' scores on the CTS2 were not calculated based on HR. 
ccs$CTS_PsychPerp_HR[which(ccs$ParticipantID == 149)] <- 5
ccs$CTS_PsychVict_HR[which(ccs$ParticipantID == 149)] <- 8
ccs$CTS_PsychPerp_HR[which(ccs$ParticipantID == 150)] <- 8
ccs$CTS_PsychVict_HR[which(ccs$ParticipantID == 150)] <- 5

ccs$CTS_PhysPerp_HR[which(ccs$CoupleID == 1025)] <- 0
ccs$CTS_PhysVict_HR[which(ccs$CoupleID == 1025)] <- 0
ccs$CTS_SGMspecPerp_HR[which(ccs$CoupleID == 1025)] <- 0
ccs$CTS_SGMspecVict_HR[which(ccs$CoupleID == 1025)] <- 0

ccs$CTS_PsychPerp_HR[which(ccs$ParticipantID == 355)] <- 1
ccs$CTS_PsychVict_HR[which(ccs$ParticipantID == 355)] <- 0
ccs$CTS_PsychPerp_HR[which(ccs$ParticipantID == 356)] <- 0
ccs$CTS_PsychVict_HR[which(ccs$ParticipantID == 356)] <- 1

ccs$CTS_PhysPerp_HR[which(ccs$CoupleID == 1128)] <- 0
ccs$CTS_PhysVict_HR[which(ccs$CoupleID == 1128)] <- 0
ccs$CTS_SGMspecPerp_HR[which(ccs$CoupleID == 1128)] <- 0
ccs$CTS_SGMspecVict_HR[which(ccs$CoupleID == 1128)] <- 0
    
## NOTE: Reliability needs to be calculated based on which partner's highest score was used for the composite score of interest for the research question. See notes above about the two participants missing data and make sure to account for this with reliability. 

## Frequencies - note that victimization and perpetration will be the same with HR variables 
describe(ccs$CTS_PsychPerp_HR)
describe(ccs$CTS_PsychVict_HR)
describe(ccs$CTS_PhysPerp_HR)
describe(ccs$CTS_PhysVict_HR)
describe(ccs$CTS_SGMspecPerp_HR)
describe(ccs$CTS_SGMspecVict_HR)

## Histograms - note that victimization and perpetration will be the same with HR variables 
ggplot(data = ccs, aes(CTS_PsychPerp_HR)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CTS_PsychVict_HR)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CTS_PhysPerp_HR)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CTS_PhysVict_HR)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CTS_SGMspecPerp_HR)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CTS_SGMspecVict_HR)) + geom_histogram(binwidth = 1)
```

##### *Communication Patterns Questionnaire (CPQ)*  
```{r}
## Recodes: items 1, 24, and 26 are reverse-scored. 
ccs <- ccs %>% 
  mutate(CPQ_1r = recode(CPQ_1, "1" = 9, "2" = 8, "3" = 7,"4" = 6,"5" = 5, "6" = 4, "7" = 3, "8" = 2, "9" = 1),
         CPQ_24r = recode(CPQ_24, "1" = 9, "2" = 8, "3" = 7,"4" = 6,"5" = 5, "6" = 4, "7" = 3, "8" = 2, "9" = 1), 
         CPQ_26r = recode(CPQ_26, "1" = 9, "2" = 8, "3" = 7,"4" = 6,"5" = 5, "6" = 4, "7" = 3, "8" = 2, "9" = 1))

## Scoring Instructions: Take the sum of all items in the subscale. 
# Constructive Communication (CC; 9 items): Item #2, 6, 8, 23, 25, 27, plus reverse-scored items 1, 24, and 26
ccs$CPQ_CCsum <-rowSums(ccs[c("CPQ_2","CPQ_6","CPQ_8","CPQ_23", "CPQ_25", "CPQ_27", "CPQ_1r", "CPQ_24r", "CPQ_26r")], na.rm = TRUE)
# Self-demand/Partner-withdraw (SDPW; 7 items): Item #3, 9, 11, 13, 17, 19, and 32
ccs$CPQ_SDPWsum <-rowSums(ccs[c("CPQ_3","CPQ_9","CPQ_11","CPQ_13","CPQ_17", "CPQ_19", "CPQ_32")], na.rm = TRUE)
# Partner-demand/Self-withdraw (PDSW; 7 items): Item #4, 10, 12, 14, 18, 20, and 33
ccs$CPQ_PDSWsum <-rowSums(ccs[c("CPQ_4","CPQ_10","CPQ_12","CPQ_14","CPQ_18", "CPQ_20", "CPQ_33")], na.rm = TRUE)

## Reliability
# Constructive Communication
dplyr::select(ccs, CPQ_2, CPQ_6, CPQ_8, CPQ_23, CPQ_25, CPQ_27, CPQ_1r, CPQ_24r, CPQ_26r) %>% psych::alpha()
# Self-demand/Partner-withdraw
dplyr::select(ccs, CPQ_3, CPQ_9, CPQ_11, CPQ_13, CPQ_17, CPQ_19, CPQ_32) %>% psych::alpha()
# Partner-demand/Self-withdraw 
dplyr::select(ccs, CPQ_4, CPQ_10, CPQ_12, CPQ_14, CPQ_18, CPQ_20, CPQ_33) %>% psych::alpha()

## Frequencies 
describe(ccs$CPQ_CCsum)
describe(ccs$CPQ_PDSWsum)
describe(ccs$CPQ_SDPWsum)

## Histogram 
ggplot(data = ccs, aes(CPQ_CCsum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CPQ_PDSWsum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CPQ_SDPWsum)) + geom_histogram(binwidth = 1)
```

##### *Dyadic Coping Inventory (DCI)*  
```{r}
## Recodes: items 7, 10, 11, 15, 22, 25, 26, and 27 are reverse-scored for the total DCI score only. 
ccs <- ccs %>% 
  mutate(DCI_7r = recode(DCI_7, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1), 
         DCI_10r = recode(DCI_10, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1),
         DCI_11r = recode(DCI_11, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1),
         DCI_15r = recode(DCI_15, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1),
         DCI_22r = recode(DCI_22, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1),
         DCI_25r = recode(DCI_25, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1),
         DCI_26r = recode(DCI_26, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1),
         DCI_27r = recode(DCI_27, "1" = 5, "2" = 4, "3" = 3,"4" = 2, "5" = 1))

## Scoring Instructions: Take the sum of all items in the scale. There are 10 subscales overall and a total score. 
# Stress communicated by oneself (SCO: items 1,2,3 and 4)
ccs$DCI_SCOsum <- rowSums(ccs[c("DCI_1", "DCI_2", "DCI_3", "DCI_4")], na.rm = TRUE)
# Supportive dyadic coping by oneself (SDCO: items 20,21,23,24, and 29)
ccs$DCI_SDCOsum <- rowSums(ccs[c("DCI_20", "DCI_21", "DCI_23", "DCI_24", "DCI_29")],na.rm = TRUE)
# Delegated dyadic coping by oneself (DDCO: items 28, and 30)
ccs$DCI_DDCOsum <- rowSums(ccs[c("DCI_28", "DCI_30")],na.rm = TRUE)
# Negative dyadic coping by oneself (NDCO: items 22,25,26 and 27) - note this is NOT reverse-scored, the reverse-scored items are only used for the total DCI score. 
ccs$DCI_NDCOsum <- rowSums(ccs[c("DCI_22", "DCI_25", "DCI_26", "DCI_27")], na.rm = TRUE)
# Stress communication of the partner(SCP: items 16, 17, 18 and 19)
ccs$DCI_SCPsum <- rowSums(ccs[c("DCI_16", "DCI_17", "DCI_18", "DCI_19")], na.rm = TRUE)
# Supportive dyadic coping of the parter(SDCP: items 5,6,8,9,and 13)
ccs$DCI_SDCPsum <-rowSums(ccs[c("DCI_5", "DCI_6", "DCI_8", "DCI_9", "DCI_13")], na.rm = TRUE)
# Delegated dyadic coping of the partner (DDCP items 12 and 14)
ccs$DCI_DDCPsum <- rowSums(ccs[c("DCI_12", "DCI_14")],na.rm = TRUE)
# Negative dyadic coping by partner (NDCP: items 7, 10, 11, and 15) - note this is NOT reverse-scored, the reverse-scored items are only used for the total DCI score. 
ccs$DCI_NDCPsum <- rowSums(ccs[c("DCI_7", "DCI_10", "DCI_11", "DCI_15")], na.rm = TRUE)
# Common dyadic coping (CDC: items 31,32,33,34, and 35)
ccs$DCI_CDCsum <- rowSums(ccs[c("DCI_31", "DCI_32", "DCI_33", "DCI_34", "DCI_35")], na.rm = TRUE)
# Evaluation of dyadic coping (EDC: items 36 and 37) 
ccs$DCI_EDCsum <-rowSums(ccs[c("DCI_36", "DCI_37")], na.rm = TRUE)
# Total scale (items 1 through 35)
ccs$DCI_total_sum <- rowSums(ccs[c("DCI_1", "DCI_2", "DCI_3", "DCI_4", "DCI_5", "DCI_6", "DCI_7r", "DCI_8", "DCI_9", "DCI_10r", "DCI_11r", "DCI_12", "DCI_13", "DCI_14", "DCI_15r", "DCI_16", "DCI_17", "DCI_18", "DCI_19", "DCI_20",  "DCI_21", "DCI_22r", "DCI_23", "DCI_24", "DCI_25r", "DCI_26r", "DCI_27r", "DCI_28", "DCI_29", "DCI_30", "DCI_31", "DCI_32", "DCI_33", "DCI_34", "DCI_35")], na.rm = TRUE)

## Reliability:
# Stress communicated by oneself (SCO: items 1,2,3 and 4)
dplyr::select(ccs, DCI_1, DCI_2, DCI_3, DCI_4) %>% psych::alpha()
# Supportive dyadic coping by oneself (SDCO: items 20,21,23,24, and 29)
dplyr::select(ccs, DCI_20, DCI_21, DCI_23, DCI_24, DCI_29) %>% psych::alpha()
# Delegated dyadic coping by oneself (DDCO: items 28, and 30)
dplyr::select(ccs, DCI_28, DCI_30) %>% psych::alpha()
# Negative dyadic coping by oneself (NDCO: items 22, 25, 26 and 27)
dplyr::select(ccs, DCI_22, DCI_25, DCI_26, DCI_27) %>% psych::alpha()
# Stress communication of the partner(SCP: items 16, 17, 18 and 19)
dplyr::select(ccs, DCI_16, DCI_17, DCI_18, DCI_18, DCI_19) %>% psych::alpha()
# Supportive dyadic coping of the parter(SDCP: items 5,6,8,9,and 13)
dplyr::select(ccs, DCI_5, DCI_6, DCI_8, DCI_9, DCI_13) %>% psych::alpha()
# Delegated dyadic coping of the partner (DDCP items 12 and 14)
dplyr::select(ccs, DCI_12, DCI_14) %>% psych::alpha()
# Negative dyadic coping by partner (NDCP: items 7, 10, 11, and 15)
dplyr::select(ccs, DCI_7, DCI_10, DCI_11, DCI_15) %>% psych::alpha()
# Common dyadic coping (CDC: items 31,32,33,34, and 35)
dplyr::select(ccs, DCI_31, DCI_32, DCI_33, DCI_34, DCI_35) %>% psych::alpha()
# Evaluation of dyadic coping (EDC: items 36 and 37) 
dplyr::select(ccs, DCI_36, DCI_37) %>% psych::alpha()
# Total scale (items 1 through 35)
dplyr::select(ccs, DCI_1, DCI_2, DCI_3, DCI_4, DCI_5, DCI_6, DCI_7r, DCI_8, DCI_9, DCI_10r, DCI_11r, DCI_12, DCI_13, DCI_14, DCI_15r, DCI_16, DCI_17, DCI_18, DCI_19, DCI_20, DCI_21, DCI_22r, DCI_23, DCI_24, DCI_25r, DCI_26r, DCI_27r, DCI_28, DCI_29, DCI_30, DCI_31, DCI_32, DCI_33, DCI_34, DCI_35) %>% psych::alpha()

## Frequencies:
# Stress communicated by oneself (SCO: items 1,2,3 and 4)
describe(ccs$DCI_SCOsum)
# Supportive dyadic coping by oneself (SDCO: items 20,21,23,24, and 29)
describe(ccs$DCI_SDCOsum)
# Delegated dyadic coping by oneself (DDCO: items 28, and 30)
describe(ccs$DCI_DDCOsum)
# Negative dyadic coping by oneself (NDCO: items 22r,25r,26r and 27r)
describe(ccs$DCI_NDCOsum)
# Stress communication of the partner(SCP: items 16, 17, 18 and 19)
describe(ccs$DCI_SCOsum)
# Supportive dyadic coping of the parter(SDCP: items 5,6,8,9,and 13)
describe(ccs$DCI_SDCPsum)
# Delegated dyadic coping of the partner (DDCP items 12 and 14)
describe(ccs$DCI_DDCPsum)
# Negative dyadic coping by partner (NDCP: items 7r,10r,11r, and 15r)
describe(ccs$DCI_NDCPsum)
# Common dyadic coping (CDC: items 31,32,33,34, and 35)
describe(ccs$DCI_CDCsum)
# Evaluation of dyadic coping (EDC: items 36 and 37) 
describe(ccs$DCI_EDCsum)
# Total scale (items 1 through 35)
describe(ccs$DCI_total_sum)

## Histograms: 
# Stress communicated by oneself (SCO: items 1,2,3 and 4)
ggplot(data = ccs, aes(DCI_SCOsum)) + geom_histogram(binwidth = 1)
# Supportive dyadic coping by oneself (SDCO: items 20,21,23,24, and 29)
ggplot(data = ccs, aes(DCI_SDCOsum)) + geom_histogram(binwidth = 1)
# Delegated dyadic coping by oneself (DDCO: items 28, and 30)
ggplot(data = ccs, aes(DCI_DDCOsum)) + geom_histogram(binwidth = 1)
# Negative dyadic coping by oneself (NDCO: items 22r,25r,26r and 27r)
ggplot(data = ccs, aes(DCI_NDCOsum)) + geom_histogram(binwidth = 1)
# Stress communication of the partner(SCP: items 16, 17, 18 and 19)
ggplot(data = ccs, aes(DCI_SCPsum)) + geom_histogram(binwidth = 1)
# Supportive dyadic coping of the parter(SDCP: items 5,6,8,9,and 13)
ggplot(data = ccs, aes(DCI_SDCPsum)) + geom_histogram(binwidth = 1)
# Delegated dyadic coping of the partner (DDCP items 12 and 14)
ggplot(data = ccs, aes(DCI_DDCPsum)) + geom_histogram(binwidth = 1)
# Negative dyadic coping by partner (NDCP: items 7r,10r,11r, and 15r)
ggplot(data = ccs, aes(DCI_NDCPsum)) + geom_histogram(binwidth = 1)
# Common dyadic coping (CDC: items 31,32,33,34, and 35)
ggplot(data = ccs, aes(DCI_CDCsum)) + geom_histogram(binwidth = 1)
# Evaluation of dyadic coping (EDC: items 36 and 37) 
ggplot(data = ccs, aes(DCI_EDCsum)) + geom_histogram(binwidth = 1)
# Total scale (items 1 through 35)
ggplot(data = ccs, aes(DCI_total_sum)) + geom_histogram(binwidth = 1)
```

##### *Support in Intimate Relationships Rating Scale (SIRRS)*  
```{r}
# Note, the scoring the the SIRRS is not consistent with the original validation paper. There was a missing response option for the last anchor point of the scale. In this study, responses ranged from 1 = never to 4 = often. In the original validation paper, the scale was 0 = never to 4 = almost always. This recodes responses to be on the same numerical scale, recognizing that there was not the final anchor point. 
ccs <- ccs %>% 
  mutate_at(vars(SIRRS_1:SIRRS_25), list(~ recode(., "1" = 0, "2" = 1, "3" = 2, "4" = 3)))

## Scoring Instructions: Take the sum of all items in the subscale. 
# Esteem/Emotional (Items: 13, 14, 15, 16, 17, 18, 19, 20)
ccs$SIRRS_emot_sum <- rowSums(ccs[c("SIRRS_13", "SIRRS_14", "SIRRS_15", "SIRRS_16", "SIRRS_17", "SIRRS_18", "SIRRS_19", "SIRRS_20")], na.rm = TRUE)
# Physical Comfort (Items: 9, 10, 11, 12)
ccs$SIRRS_phys_sum <- rowSums(ccs[c("SIRRS_9", "SIRRS_10", "SIRRS_11", "SIRRS_12")], na.rm = TRUE)
# Information (Items: 1, 2, 3, 4, 5, 6, 7, 8)
ccs$SIRRS_info_sum <- rowSums(ccs[c("SIRRS_1", "SIRRS_2", "SIRRS_3", "SIRRS_4", "SIRRS_5", "SIRRS_6", "SIRRS_7", "SIRRS_8")], na.rm = TRUE)
# Tangible (Items: 21, 22, 23, 24, 25)
ccs$SIRRS_tang_sum <- rowSums(ccs[c("SIRRS_21", "SIRRS_22", "SIRRS_23","SIRRS_24","SIRRS_25")], na.rm = TRUE)
# Full Scale
ccs$SIRRS_total_sum <- rowSums(ccs[c("SIRRS_1", "SIRRS_2", "SIRRS_3", "SIRRS_4", "SIRRS_5", "SIRRS_6", "SIRRS_7", "SIRRS_8", "SIRRS_9", "SIRRS_10", "SIRRS_11", "SIRRS_12", "SIRRS_13", "SIRRS_14", "SIRRS_15", "SIRRS_16", "SIRRS_17", "SIRRS_18", "SIRRS_19", "SIRRS_20", "SIRRS_21", "SIRRS_22", "SIRRS_23","SIRRS_24","SIRRS_25")], na.rm = TRUE)

## Reliability for SIRRS
# Esteem/Emotional (Items: 13, 14, 15, 16, 17, 18, 19, 20)
dplyr::select(ccs, SIRRS_13:SIRRS_20) %>% psych::alpha()
# Physical Comfort (Items: 9, 10, 11, 12)
dplyr::select(ccs, SIRRS_9:SIRRS_12) %>% psych::alpha()
# Information (Items: 1, 2, 3, 4, 5, 6, 7, 8)
dplyr::select(ccs, SIRRS_1:SIRRS_8) %>% psych::alpha()
# Tangible (Items: 21, 22, 23, 24, 25)
dplyr::select(ccs, SIRRS_21:SIRRS_25) %>% psych::alpha()
# Full Scale
dplyr::select(ccs, SIRRS_1:SIRRS_25) %>% psych::alpha()

## Frequencies for SIRRS
describe(ccs$SIRRS_emot_sum)
describe(ccs$SIRRS_info_sum)
describe(ccs$SIRRS_phys_sum)
describe(ccs$SIRRS_tang_sum)
describe(ccs$SIRRS_total_sum)

## Histogram for SIRRS
ggplot(data = ccs, aes(SIRRS_emot_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SIRRS_info_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SIRRS_phys_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SIRRS_tang_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SIRRS_total_sum)) + geom_histogram(binwidth = 1)
```

##### *Behavioral Inhibition/Activation Scale (BISBAS)*  
```{r}
## Recodes: all items EXCEPT 2 and 22 are reverse-scored. Items 1, 6, 11, 17 are fillers. 
ccs <- ccs %>% 
  mutate(BISBAS_3r = recode(BISBAS_3, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_9r = recode(BISBAS_9, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_12r = recode(BISBAS_12, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_21r = recode(BISBAS_21, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_5r = recode(BISBAS_5, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_10r = recode(BISBAS_10, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_15r = recode(BISBAS_15, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_20r = recode(BISBAS_20, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_4r = recode(BISBAS_4, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_7r = recode(BISBAS_7, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_14r = recode(BISBAS_14, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_18r = recode(BISBAS_18, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_23r = recode(BISBAS_23, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_8r = recode(BISBAS_8, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_13r = recode(BISBAS_13, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_16r = recode(BISBAS_16, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_19r = recode(BISBAS_19, "1" = 4, "2" = 3, "3" = 2, "4" = 1),
         BISBAS_24r = recode(BISBAS_24, "1" = 4, "2" = 3, "3" = 2, "4" = 1))

## Scoring Instructions: Take sum of all items in the subscale. 
# BAS Drive:  3r, 9r, 12r, 21r
ccs$BAS_drive_sum <- rowSums(ccs[c("BISBAS_3r","BISBAS_9r","BISBAS_12r","BISBAS_21r")], na.rm = TRUE)
# BAS Fun Seeking:  5r, 10r, 15r, 20r
ccs$BAS_fun_sum <- rowSums(ccs[c("BISBAS_5r","BISBAS_10r","BISBAS_15r", "BISBAS_20r")], na.rm = TRUE)
# BAS Reward Responsiveness:  4r, 7r, 14r, 18r, 23r 
ccs$BAS_reward_sum <- rowSums(ccs[c("BISBAS_4r","BISBAS_7r","BISBAS_14r","BISBAS_18r","BISBAS_23r")], na.rm = TRUE)
# BIS:  2, 8r, 13r, 16r, 19r, 22, 24r   
ccs$BIS_sum <- rowSums(ccs[c("BISBAS_2","BISBAS_8r","BISBAS_13r","BISBAS_16r","BISBAS_19r","BISBAS_22","BISBAS_24r")], na.rm = TRUE)

## Reliability for BISBAS
# BAS Drive
dplyr::select(ccs, BISBAS_3r, BISBAS_9r, BISBAS_12r, BISBAS_21r) %>% psych::alpha() 
# BAS Fun Seeking
dplyr::select(ccs, BISBAS_5r, BISBAS_10r, BISBAS_15r, BISBAS_20r) %>% psych::alpha() 
# BAS Reward Responsiveness  
dplyr::select(ccs, BISBAS_4r, BISBAS_7r, BISBAS_14r, BISBAS_18r, BISBAS_23r) %>% psych::alpha() 
# BIS  
dplyr::select(ccs, BISBAS_2, BISBAS_8r, BISBAS_13r, BISBAS_16r, BISBAS_19r, BISBAS_22, BISBAS_24r) %>% psych::alpha() 

## Frequencies for BISBAS
describe(ccs$BAS_drive_sum)
describe(ccs$BAS_fun_sum)
describe(ccs$BAS_reward_sum)
describe(ccs$BIS_sum)

## Histogram for BISBAS
ggplot(data = ccs, aes(BAS_drive_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(BAS_fun_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(BAS_reward_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(BIS_sum)) + geom_histogram(binwidth = 1)
```

##### *Relationship Attribution Measure (RAM)*  
```{r}
## NOTE: There was a programming error with this scale that might affect the validity of this measure. 4 situations are presented to participants and they are asked to imagine that their partner does that behavior (e.g., criticizes you, spends less time with you, etc.) and then rate 6 different attributions for such behavior. The 6 attribution items to rate should be worded to match each behavior/secnario  (e.g., item 1 scenario is "Your partner criticizes something you say" and then one of the attribution items, RAM_1b, is "The reason my partner criticized me is not likely to change"). The attribution items should have been changed for each of the 4 scenarios. However, this was not done (so item 2 scenario is "Your partner begins to spend less time with you" where the attribution item, RAM_2b, was also "The reason my partner criticized me is not likely to change" when this should have been "The reason my partner begins to spend less time with me is not likely to change"). 
# To potentially use this measure, we will create composite scores with the full 4 scenarios here, as well as a composite score with just scenario 1 (which was worded correctly). 

## Scoring Instructions. 
# From Fincham & Bradbury, 1992 - responses to the 4 situations have 6 ratings (3 are related to causal attributions (locus, stability, globality), and 3 are related to responsibility (intentionality, motivation, blame)). You can sum across each of the 4 items to get individual ratings for each of those 6 dimensions - higher scores reflect more negative attributions. 
# Composite indices of causal & responsibility attributions can be created by summing responses across the 12 causal attributions (3 ratings for 4 different events) and the 12 responsibility attributions (3 ratings for 4 different events). This 2-factor model received support in the original validation studies, and so this will be the index used in this study. a, b, and c corresponds to causal attribution items, d, e, and f corresponds to responsibility attribution items. 
# Causal - 1 item. 
ccs$RAM_cause_sum_1item <- rowSums(ccs[c("RAM_1a", "RAM_1b", "RAM_1c")], na.rm = TRUE)
# Responsibility - 1 item.
ccs$RAM_resp_sum_1item <- rowSums(ccs[c("RAM_1d", "RAM_1e", "RAM_1f")], na.rm = TRUE)
# Causal - all items.
ccs$RAM_cause_sum <- rowSums(ccs[c("RAM_1a", "RAM_1b", "RAM_1c", "RAM_2a", "RAM_2b", "RAM_2c", "RAM_3a", "RAM_3b", "RAM_3c", "RAM_4a", "RAM_4b", "RAM_4c")], na.rm = TRUE)
# Responsibility - all items. 
ccs$RAM_resp_sum <- rowSums(ccs[c("RAM_1d", "RAM_1e", "RAM_1f", "RAM_2d", "RAM_2e", "RAM_2f", "RAM_3d", "RAM_3e", "RAM_3f", "RAM_4d", "RAM_4e", "RAM_4f")], na.rm = TRUE)

# Note that the 1 item and full scales for both the causal and responsibility dimensions are highly correlated (.72 and .83 respectively) - though this does not take interdependence into account 
#cor.test(ccs$RAM_cause_sum_1item, ccs$RAM_cause_sum)
#cor.test(ccs$RAM_resp_sum_1item, ccs$RAM_resp_sum)

## Reliability
# Causal - 1 item.
dplyr::select(ccs, RAM_1a, RAM_1b, RAM_1c) %>% psych::alpha()
# Responsibility - 1 item.
dplyr::select(ccs, RAM_1d, RAM_1e, RAM_1f) %>% psych::alpha()
# Causal - all items.
dplyr::select(ccs, RAM_1a, RAM_1b, RAM_1c, RAM_2a, RAM_2b, RAM_2c, RAM_3a, RAM_3b, RAM_3c, RAM_4a, RAM_4b, RAM_4c) %>% psych::alpha()
# Responsibility - all items. 
dplyr::select(ccs, RAM_1d, RAM_1e, RAM_1f, RAM_2d, RAM_2e, RAM_2f, RAM_3d, RAM_3e, RAM_3f, RAM_4d, RAM_4e, RAM_4f) %>% psych::alpha()

## Frequencies
describe(ccs$RAM_cause_sum_1item)
describe(ccs$RAM_resp_sum_1item)
describe(ccs$RAM_cause_sum)
describe(ccs$RAM_resp_sum)

## Histograms
ggplot(data = ccs, aes(RAM_cause_sum_1item)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RAM_resp_sum_1item)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RAM_cause_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(RAM_resp_sum)) + geom_histogram(binwidth = 1)
```

##### *Interpersonal Reactivity Index for Couples (IRIC)* 
```{r}
## Recodes: Items 2, 6, 7, and 8 are reverse coded.
ccs <- ccs %>% 
  mutate(IRIC_2r = recode(IRIC_2, "0" = 4, "1" = 3, "2" = 2, "3" = 1, "4" = 0),
         IRIC_6r = recode(IRIC_6, "0" = 4, "1" = 3, "2" = 2, "3" = 1, "4" = 0),
         IRIC_7r = recode(IRIC_7, "0" = 4, "1" = 3, "2" = 2, "3" = 1, "4" = 0),
         IRIC_8r = recode(IRIC_8, "0" = 4, "1" = 3, "2" = 2, "3" = 1, "4" = 0))

## Scoring Instructions: Items in each scale are summed to obtain scale scores. 
# Empathic Concern subscale: items 1, 2, 4, 6, 8, 9, 11
ccs$IRIC_emp_sum <- rowSums(ccs[c("IRIC_1","IRIC_2r","IRIC_4","IRIC_6r","IRIC_8r","IRIC_9","IRIC_11")], na.rm = TRUE)
# Perspective Taking subscale: items 3, 5, 7, 10, 12, 13
ccs$IRIC_persp_sum <- rowSums(ccs[c("IRIC_3","IRIC_5","IRIC_7r","IRIC_10","IRIC_12","IRIC_13")], na.rm = TRUE)

## Reliability for IRIC. Note low reliability for the empathic concern subscale is within range of what is reported inv alidation article (Péloquin & lafontaine, 2010)
dplyr::select(ccs, IRIC_1, IRIC_2r, IRIC_4, IRIC_6r, IRIC_8r, IRIC_9, IRIC_11) %>% psych::alpha()
dplyr::select(ccs, IRIC_3, IRIC_5, IRIC_7r, IRIC_10, IRIC_12, IRIC_13) %>% psych::alpha()

## Frequencies for IRIC
describe(ccs$IRIC_emp_sum)
describe(ccs$IRIC_persp_sum)

## Histogram for IRIC
ggplot(data = ccs, aes(IRIC_emp_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(IRIC_persp_sum)) + geom_histogram(binwidth = 1)
```

##### *Ruminative Responses Scale - Brooding Subscale (RRS)*  
```{r}
## Recodes: none.

## Scoring Instructions:  Note we only used the 5-item "brooding" subscale, not the full 22 item scale. Score is the sum of the 5 items. 
ccs$RRS_sum <- rowSums(ccs[c("RRS_1", "RRS_2", "RRS_3", "RRS_4", "RRS_5")], na.rm = TRUE)

## Reliability for RRS
dplyr::select(ccs, RRS_1, RRS_2, RRS_3, RRS_4, RRS_5) %>% psych::alpha()

## Frequencies for RRS
describe(ccs$RRS_sum)

## Histogram for RRS
ggplot(data = ccs, aes(RRS_sum)) + geom_histogram(binwidth = 1)
```

##### *Difficulties in Emotion Regulation Scale - Short Form (DERS)*  
```{r}
## Recodes: Items 1, 4, and 6 are reverse-scored. 
ccs <- ccs %>% 
  mutate(DERS_1r = recode(DERS_1, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         DERS_4r = recode(DERS_4, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         DERS_6r = recode(DERS_6, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1))

## Scoring Instructions: Sum all items in each subscale. NOTE: b/c there were only 3 items per subscale and there are some missing values, this code is specified to set the subscale scores to NA (missing) if there are any missing items (since they would have only completed 66% of the scale). The total scale uses all available data though, as no cases had less than 70% of the data on the total DERS. This is done by setting "na.rm = T" for the total score but not the subscales. 
# Nonacceptance of Emotional Responses subscale: 7, 12, 16
ccs$DERS_nonaccept_sum <- rowSums(ccs[c("DERS_7", "DERS_12", "DERS_16")]) 
# Difficulties Engaging in Goal-Directed Behavior subscale:  8, 11, 13
ccs$DERS_goals_sum <- rowSums(ccs[c("DERS_8", "DERS_11", "DERS_13")])
# Impulse Control Difficulties subscale: 9, 14, 17
ccs$DERS_impulse_sum <- rowSums(ccs[c("DERS_9", "DERS_14", "DERS_17")])
# Lack of Emotional Awareness subscale: 1r, 4r, 6r
ccs$DERS_aware_sum <- rowSums(ccs[c("DERS_1r", "DERS_4r", "DERS_6r")])
# Limited Access to Emotion Regulation Strategies subscale: 10, 15, 18
ccs$DERS_strat_sum <- rowSums(ccs[c("DERS_10", "DERS_15", "DERS_18")])
# Lack of Emotional Clarity subscale: 2, 3, 5
ccs$DERS_clarity_sum <- rowSums(ccs[c("DERS_2", "DERS_3", "DERS_5")])
# Total scale: all items
ccs$DERS_total_sum <- rowSums(ccs[c("DERS_7", "DERS_12", "DERS_16", "DERS_8", "DERS_11", "DERS_13", "DERS_9", "DERS_14", "DERS_17", "DERS_1r", "DERS_4r", "DERS_6r", "DERS_10", "DERS_15", "DERS_18", "DERS_2", "DERS_3", "DERS_5")], na.rm = T)

## Reliability for DERS-SF
# Nonacceptance subscale
dplyr::select(ccs, DERS_7, DERS_12, DERS_16) %>% psych::alpha()
# Goals subscale
dplyr::select(ccs, DERS_8, DERS_11, DERS_13) %>% psych::alpha()
# Impulse subscale
dplyr::select(ccs, DERS_9, DERS_14, DERS_17) %>% psych::alpha()
# Awareness subscale
dplyr::select(ccs, DERS_1r, DERS_4r, DERS_6r) %>% psych::alpha()
# Strategies subscale
dplyr::select(ccs, DERS_10, DERS_15, DERS_18) %>% psych::alpha()
# Clarity subscale
dplyr::select(ccs, DERS_2, DERS_3, DERS_5) %>% psych::alpha()
# Total scale
dplyr::select(ccs, DERS_7, DERS_12, DERS_16, DERS_8, DERS_11, DERS_13, DERS_9, DERS_14, DERS_17, DERS_1r, DERS_4r, DERS_6r, DERS_10, DERS_15, DERS_18, DERS_2, DERS_3, DERS_5) %>% psych::alpha()

## Frequencies for DERS-SF
describe(ccs$DERS_nonaccept_sum)
describe(ccs$DERS_goals_sum)
describe(ccs$DERS_impulse_sum)
describe(ccs$DERS_aware_sum)
describe(ccs$DERS_strat_sum)
describe(ccs$DERS_clarity_sum)
describe(ccs$DERS_total_sum)

## Histogram for DERS-SF
ggplot(data = ccs, aes(DERS_nonaccept_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DERS_goals_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DERS_impulse_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DERS_aware_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DERS_strat_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DERS_clarity_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DERS_total_sum)) + geom_histogram(binwidth = 1)
```

##### *Fear of Intimacy Scale (FIS)*  
```{r}
## Recodes: items 3, 6, 7, 8, 10, 14, 17, 18, 19, 21, 22, 25, 27, 29, and 30 are reverse-scored. 
ccs <- ccs %>% 
  mutate(FIS_3r = recode(FIS_3, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_6r = recode(FIS_6, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_7r = recode(FIS_7, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_8r = recode(FIS_8, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_10r = recode(FIS_10, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_14r = recode(FIS_14, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_17r = recode(FIS_17, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_18r = recode(FIS_18, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_19r = recode(FIS_19, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_21r = recode(FIS_21, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_22r = recode(FIS_22, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_25r = recode(FIS_25, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_27r = recode(FIS_27, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_29r = recode(FIS_29, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1),
         FIS_30r = recode(FIS_30, "1" = 5, "2" = 4, "3" = 3, "4" = 2, "5" = 1))

## Scoring Instructions: Original paper summed all 35 items, studies have used the mean as well. We will use the mean here. 
ccs$FIS_mean <- rowMeans(ccs[c("FIS_1", "FIS_2", "FIS_3r", "FIS_4", "FIS_5", "FIS_6r", "FIS_7r", "FIS_8r", "FIS_9", "FIS_10r", "FIS_11", "FIS_12", "FIS_13", "FIS_14r", "FIS_15", "FIS_16", "FIS_17r", "FIS_18r", "FIS_19r", "FIS_20", "FIS_21r", "FIS_22r", "FIS_23", "FIS_24", "FIS_25r", "FIS_26", "FIS_27r", "FIS_28", "FIS_29r", "FIS_30r", "FIS_31", "FIS_32", "FIS_33", "FIS_34", "FIS_35")], na.rm = TRUE)

## Reliability for FIS
dplyr::select(ccs, FIS_1, FIS_2, FIS_3r, FIS_4, FIS_5, FIS_6r, FIS_7r, FIS_8r, FIS_9, FIS_10r, FIS_11, FIS_12, FIS_13, FIS_14r, FIS_15, FIS_16, FIS_17r, FIS_18r, FIS_19r, FIS_20, FIS_21r, FIS_22r, FIS_23, FIS_24, FIS_25r, FIS_26, FIS_27r, FIS_28, FIS_29r, FIS_30r, FIS_31, FIS_32, FIS_33, FIS_34, FIS_35) %>% psych::alpha()

## Frequencies for FIS
describe(ccs$FIS_mean)

## Histogram for FIS
ggplot(data = ccs, aes(FIS_mean)) + geom_histogram(binwidth = 1)
```

##### *Affective Control Scale (ACS)*  
```{r}
## Recodes: items 4, 9, 12, 16, 17, 18, 21, 22, 27, 30, 31, and 38 are reverse-scored.  
ccs <- ccs %>% 
  mutate(ACS_4r = recode(ACS_4, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_9r = recode(ACS_9, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_12r = recode(ACS_12, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_16r = recode(ACS_16, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_17r = recode(ACS_17, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_18r = recode(ACS_18, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_21r = recode(ACS_21, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_22r = recode(ACS_22, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_27r = recode(ACS_27, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_30r = recode(ACS_30, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_31r = recode(ACS_31, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1),
         ACS_38r = recode(ACS_38, '1' = 7, '2' = 6, '3' = 5, '4' = 4, '5' = 3, '6' = 2, '7' = 1))

## Scoring items: Mean of items in each subscale
# Anger: 1, 8, 11, 16r, 28, 30r, 34, 39 
ccs$ACS_ang_mean <-rowMeans(ccs[c("ACS_1", "ACS_8", "ACS_11", "ACS_16r", "ACS_28", "ACS_30r", "ACS_34", "ACS_39")], na.rm = TRUE)
# Positive Affect: 2, 6, 10, 12r, 14, 18r, 22r, 23, 31r, 32, 36, 41, 42 
ccs$ACS_PA_mean <-rowMeans(ccs[c("ACS_2", "ACS_6", "ACS_10", "ACS_12r", "ACS_14", "ACS_18r", "ACS_22r", "ACS_23", "ACS_31r", "ACS_32", "ACS_36", "ACS_41", "ACS_42")], na.rm = TRUE)
# Depressed Mood: 3, 4r, 13, 19, 25, 27r, 29, 37 
ccs$ACS_dep_mean <- rowMeans(ccs[c("ACS_3", "ACS_4r", "ACS_13", "ACS_19", "ACS_25", "ACS_27r", "ACS_29", "ACS_37")], na.rm = TRUE)
# Anxiety: 5, 7, 9r, 15, 17r, 20, 21r, 24, 26, 33, 35, 38, 40
ccs$ACS_anx_mean <- rowMeans(ccs[c("ACS_5", "ACS_7", "ACS_9r", "ACS_15", "ACS_17r", "ACS_20", "ACS_21r", "ACS_24", "ACS_26", "ACS_33", "ACS_35", "ACS_38r", "ACS_40")], na.rm = TRUE)

## Reliability for ACS
# Anger: 1, 8, 11, 16r, 28, 30r, 34, 39 
dplyr::select(ccs, ACS_1, ACS_8, ACS_11, ACS_16r, ACS_28, ACS_30r, ACS_34, ACS_39) %>% psych::alpha()
# Positive Affect: 2, 6, 10, 12r, 14, 18r, 22r, 23, 31r, 32, 36, 41, 42 
dplyr::select(ccs, ACS_2, ACS_6, ACS_10, ACS_12r, ACS_14, ACS_18r, ACS_22r, ACS_23, ACS_31r, ACS_32, ACS_36, ACS_41, ACS_42) %>% psych::alpha()
# Depressed Mood: 3, 4r, 13, 19, 25, 27r, 29, 37 
dplyr::select(ccs, ACS_5, ACS_7, ACS_9r, ACS_15, ACS_17r, ACS_20, ACS_21r, ACS_24, ACS_26, ACS_33, ACS_35, ACS_38r, ACS_40) %>% psych::alpha()
# Anxiety: 5, 7, 9r, 15, 17r, 20, 21r, 24, 26, 33, 35, 38, 40
dplyr::select(ccs, ACS_5, ACS_7, ACS_9r, ACS_15, ACS_17r, ACS_20, ACS_21r, ACS_24, ACS_26, ACS_33, ACS_35, ACS_38r, ACS_40) %>% psych::alpha()

## Frequencies for ACS
describe(ccs$ACS_ang_mean)
describe(ccs$ACS_PA_mean)
describe(ccs$ACS_dep_mean)
describe(ccs$ACS_anx_mean)

## Histogram for ACS
ggplot(data = ccs, aes(ACS_ang_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ACS_PA_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ACS_dep_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ACS_anx_mean)) + geom_histogram(binwidth = 1)
```

##### *Generalized Anxiety Disorder - 7 Item Screen (GAD7)*  
```{r}
## Recodes: none

## Scoring Insturctions: Sum all items together. Note: Scores of 5, 10, and 15 are taken as the cut-off points for mild, moderate and severe anxiety, respectively. When used as a screening tool, further evaluation is recommended when the score is 10 or greater.
ccs$GAD7_sum <- rowSums(ccs[c("GAD7_1", "GAD7_2", "GAD7_3", "GAD7_4", "GAD7_5", "GAD7_6", "GAD7_7")], na.rm = TRUE)

## Reliability for GAD7
dplyr::select(ccs, GAD7_1, GAD7_2, GAD7_3, GAD7_4, GAD7_5, GAD7_6, GAD7_7) %>% psych::alpha()

## Frequencies for GAD7
describe(ccs$GAD7_sum)

## Histogram for GAD7
ggplot(data = ccs, aes(GAD7_sum)) + geom_histogram(binwidth = 1)
```

##### *Patient Health Questionnaire - 9 Item Screen (PHQ9)*  
```{r}
## Recodes: none

## Scoring Instructions: Sum all items
ccs$PHQ9_sum <- rowSums(ccs[c("PHQ9_1", "PHQ9_2", "PHQ9_3", "PHQ9_4", "PHQ9_5", "PHQ9_6", "PHQ9_7", "PHQ9_8", "PHQ9_9")], na.rm = TRUE)

## Reliability for PHQ9
dplyr::select(ccs, PHQ9_1, PHQ9_2, PHQ9_3, PHQ9_4, PHQ9_5, PHQ9_6, PHQ9_7, PHQ9_8, PHQ9_9) %>% psych::alpha()

# Frequencies for PHQ9
describe(ccs$PHQ9_sum)

# Histogram for PHQ9
ggplot(data = ccs, aes(PHQ9_sum)) + geom_histogram(binwidth = 1)
```

##### *Alcohol, Smoking, & Substance Involvement Screening Test (ASSIST)*  
```{r}
## Recodes:
# Items 3, 4, and 5 were all coded incorrectly in the Qualtrics survey. This code makes it match the WHO ASSIST Packet formulation. 
ccs <- ccs %>% 
  mutate(ASSIST_3.tobac = recode(ASSIST_3.tobac, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.alc = recode(ASSIST_3.alc, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6), 
         ASSIST_3.weed = recode(ASSIST_3.weed, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.coke = recode(ASSIST_3.coke, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.amphet = recode(ASSIST_3.amphet, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.inhale = recode(ASSIST_3.inhale, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.sedat = recode(ASSIST_3.sedat, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.halluc = recode(ASSIST_3.halluc, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_3.opiates = recode(ASSIST_3.opiates, "0" = 0, "2" = 3, "3" = 4, "4" = 5, "6" = 6),
         ASSIST_4.tobac = recode(ASSIST_4.tobac, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.alc = recode(ASSIST_4.alc, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7), 
         ASSIST_4.weed = recode(ASSIST_4.weed, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.coke = recode(ASSIST_4.coke, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.amphet = recode(ASSIST_4.amphet, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.inhale = recode(ASSIST_4.inhale, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.sedat = recode(ASSIST_4.sedat, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.halluc = recode(ASSIST_4.halluc, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_4.opiates = recode(ASSIST_4.opiates, "0" = 0, "2" = 4, "3" = 5, "4" = 6, "6" = 7),
         ASSIST_5.tobac = recode(ASSIST_5.tobac, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.alc = recode(ASSIST_5.alc, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8), 
         ASSIST_5.weed = recode(ASSIST_5.weed, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.coke = recode(ASSIST_5.coke, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.amphet = recode(ASSIST_5.amphet, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.inhale = recode(ASSIST_5.inhale, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.sedat = recode(ASSIST_5.sedat, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.halluc = recode(ASSIST_5.halluc, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8),
         ASSIST_5.opiates = recode(ASSIST_5.opiates, "0" = 0, "2" = 5, "3" = 6, "4" = 7, "6" = 8))

# For ASSIST_2: if response is "never", all answers for items 3, 4, and 5 should be NA (basically if they didn't use in the past 3 months everything else should be 0). Programming was not able to skip these questions (given Qualtrics limitations with carryover choices), so this is done manually here. 
ccs <- ccs %>% 
  mutate(ASSIST_3.tobac = if_else(ASSIST_2.tobac == 0, 0, ASSIST_3.tobac),
         ASSIST_4.tobac = if_else(ASSIST_2.tobac == 0, 0, ASSIST_4.tobac),
         ASSIST_5.tobac = if_else(ASSIST_2.tobac == 0, 0, ASSIST_5.tobac),
         ASSIST_3.alc = if_else(ASSIST_2.alc == 0, 0, ASSIST_3.alc),
         ASSIST_4.alc = if_else(ASSIST_2.alc == 0, 0, ASSIST_4.alc),
         ASSIST_5.alc = if_else(ASSIST_2.alc == 0, 0, ASSIST_5.alc),
         ASSIST_3.weed = if_else(ASSIST_2.weed == 0, 0, ASSIST_3.weed),
         ASSIST_4.weed = if_else(ASSIST_2.weed == 0, 0, ASSIST_4.weed),
         ASSIST_5.weed = if_else(ASSIST_2.weed == 0, 0, ASSIST_5.weed),
         ASSIST_3.coke = if_else(ASSIST_2.coke == 0, 0, ASSIST_3.coke),
         ASSIST_4.coke = if_else(ASSIST_2.coke == 0, 0, ASSIST_4.coke),
         ASSIST_5.coke = if_else(ASSIST_2.coke == 0, 0, ASSIST_5.coke),
         ASSIST_3.amphet = if_else(ASSIST_2.amphet == 0, 0, ASSIST_3.amphet),
         ASSIST_4.amphet = if_else(ASSIST_2.amphet == 0, 0, ASSIST_4.amphet),
         ASSIST_5.amphet = if_else(ASSIST_2.amphet == 0, 0, ASSIST_5.amphet),
         ASSIST_3.inhale = if_else(ASSIST_2.inhale == 0, 0, ASSIST_3.inhale),
         ASSIST_4.inhale = if_else(ASSIST_2.inhale == 0, 0, ASSIST_4.inhale),
         ASSIST_5.inhale = if_else(ASSIST_2.inhale == 0, 0, ASSIST_5.inhale),
         ASSIST_3.sedat = if_else(ASSIST_2.sedat == 0, 0, ASSIST_3.sedat),
         ASSIST_4.sedat = if_else(ASSIST_2.sedat == 0, 0, ASSIST_4.sedat),
         ASSIST_5.sedat = if_else(ASSIST_2.sedat == 0, 0, ASSIST_5.sedat),
         ASSIST_3.halluc = if_else(ASSIST_2.halluc == 0, 0, ASSIST_3.halluc),
         ASSIST_4.halluc = if_else(ASSIST_2.halluc == 0, 0, ASSIST_4.halluc),
         ASSIST_5.halluc = if_else(ASSIST_2.halluc == 0, 0, ASSIST_5.halluc),
         ASSIST_3.opiates = if_else(ASSIST_2.opiates == 0, 0, ASSIST_3.opiates),
         ASSIST_4.opiates = if_else(ASSIST_2.opiates == 0, 0, ASSIST_4.opiates),
         ASSIST_5.opiates = if_else(ASSIST_2.opiates == 0, 0, ASSIST_5.opiates))

## Scoring Instructions:
# Sources: (WHO ASSIST Packet, Humeniuk et al. 2008, McNeely et al. 2015 - psychometrics of computer-admin version)
# ASSIST_1 items are not part of the total, they just indicate lifetime use of any drug to assess for the scale. Item 2 assesses for past 3 month use. If 0, items 3, 4, and 5 are skipped. If anything else, those items are administered. Items 6 and 7 are administered even if no past 3-month use according to item 2. 
# The primary score for this measure is a "Substance-Specific Involvement (SSI)" or "Substance Involvement" score - also termed ASSIST risk score - to obtain, sum items 2, 3, 4, 5, 6, 7 for each drug category separately (theoretical range is 0-39). FOR TOBACCO ONLY: you skip item 5 so this only includes items 2, 3, 4, 6, 7 (theoreteical range is 0-31).
# Current frequency of substance use past 3-months - just get Q2 frequencies for each substance
# NOTE: You can get a ton of different scores here depending on the research question (including dependence scores, abuse scores, global continuum risk scores, etc.). The SSI scores are the most commonly used from this measure for screening purposes and will be calculated here. 

# IMPORTANT INTERPRETATION NOTE: the code below will score a "0" even for people who have never used the substance. If the research question requires to isolate to people who have every used substances, make sure to recode the SSI scores to be NA for anyone who responded 0 to item 1 for that drug class. 

# Tobacco SSI: items 2, 3, 4, 6, and 7 (skip 5). 
ccs$ASSIST_tobac_ssi <- rowSums(ccs[c("ASSIST_2.tobac", "ASSIST_3.tobac", "ASSIST_4.tobac", "ASSIST_6.tobac", "ASSIST_7.tobac")], na.rm = TRUE)
# Alcohol SSI: items 2-7
ccs$ASSIST_alc_ssi <- rowSums(ccs[c("ASSIST_2.alc", "ASSIST_3.alc", "ASSIST_4.alc", "ASSIST_5.alc", "ASSIST_6.alc", "ASSIST_7.alc")], na.rm = TRUE)
# Marijuana SSI: items 2-7
ccs$ASSIST_weed_ssi <- rowSums(ccs[c("ASSIST_2.weed", "ASSIST_3.weed", "ASSIST_4.weed", "ASSIST_5.weed", "ASSIST_6.weed", "ASSIST_7.weed")], na.rm = TRUE)
# Cocaine SSI: items 2-7
ccs$ASSIST_coke_ssi <- rowSums(ccs[c("ASSIST_2.coke", "ASSIST_3.coke", "ASSIST_4.coke", "ASSIST_5.coke", "ASSIST_6.coke", "ASSIST_7.coke")], na.rm = TRUE)
# Amphetamines SSI: items 2-7
ccs$ASSIST_amphet_ssi <- rowSums(ccs[c("ASSIST_2.amphet", "ASSIST_3.amphet", "ASSIST_4.amphet", "ASSIST_5.amphet", "ASSIST_6.amphet", "ASSIST_7.amphet")], na.rm = TRUE)
# Inhalants SSI: items 2-7
ccs$ASSIST_inhale_ssi <- rowSums(ccs[c("ASSIST_2.inhale", "ASSIST_3.inhale", "ASSIST_4.inhale", "ASSIST_5.inhale", "ASSIST_6.inhale", "ASSIST_7.inhale")], na.rm = TRUE)
# Sedatives SSI: items 2-7
ccs$ASSIST_sedat_ssi <- rowSums(ccs[c("ASSIST_2.sedat", "ASSIST_3.sedat", "ASSIST_4.sedat", "ASSIST_5.sedat", "ASSIST_6.sedat", "ASSIST_7.sedat")], na.rm = TRUE)
# Hallucinogens SSI: items 2-7
ccs$ASSIST_halluc_ssi <- rowSums(ccs[c("ASSIST_2.halluc", "ASSIST_3.halluc", "ASSIST_4.halluc", "ASSIST_5.halluc", "ASSIST_6.halluc", "ASSIST_7.halluc")], na.rm = TRUE)
# Opiates SSI: items 2-7
ccs$ASSIST_opiates_ssi <- rowSums(ccs[c("ASSIST_2.opiates", "ASSIST_3.opiates", "ASSIST_4.opiates", "ASSIST_5.opiates", "ASSIST_6.opiates", "ASSIST_7.opiates")], na.rm = TRUE)

# For the "Other" drug class, we visually examined which drug categories were included for this. In this sample, all of the "other" choices specified a drug that was already included in the list so code here fixes that manually, and removes the other drug category variables from this dataset. 
# PTID 132 indicated nicotine vape in the "Other" category, which should be coded under tobacco. They also responded to the tobacco question, so this recodes the tobacco questions to be the average of the two responses. For the other category, their responses were: item 2 = 6, item 3 = 6, item 4 = 0, item 5 = 0, item 6 = 3, item 7 = 6, item 8 = 0 (total SSI score = 21). For the tobacco category, their responses were: item 2 = 2, item 3 = 6, item 4 = 0, item 5 = 0, item 6 = 3, item 7 = 3 (total SSI score = 14). 
ccs$ASSIST_2.tobac[which(ccs$ParticipantID == 132)] <- 4
ccs$ASSIST_3.tobac[which(ccs$ParticipantID == 132)] <- 6
ccs$ASSIST_4.tobac[which(ccs$ParticipantID == 132)] <- 0
ccs$ASSIST_5.tobac[which(ccs$ParticipantID == 132)] <- 0
ccs$ASSIST_6.tobac[which(ccs$ParticipantID == 132)] <- 3
ccs$ASSIST_7.tobac[which(ccs$ParticipantID == 132)] <- 4.5
ccs$ASSIST_8.tobac[which(ccs$ParticipantID == 132)] <- 0
ccs$ASSIST_tobac_ssi[which(ccs$ParticipantID == 132)] <- 17.5 
# PTID 189 indicated benzos in the "Other" category, which should be coded uunder sedatives. SSI score = 29
# For the other category, their responses were: item 2 = 6, item 3 = 6, item 4 = 4, item 5 = 4, item 6 = 6, item 7 = 3, item 8 = 0 (total SSI score = 29). For the sedative category, their responses were: item 2 = 6, item 3 = 6, item 4 = 0, item 5 = 6, item 6 = 0, item 7 = 0, item 8 = 0 (total SSI score = 18). 
ccs$ASSIST_2.sedat[which(ccs$ParticipantID == 189)] <- 6
ccs$ASSIST_3.sedat[which(ccs$ParticipantID == 189)] <- 6
ccs$ASSIST_4.sedat[which(ccs$ParticipantID == 189)] <- 2
ccs$ASSIST_5.sedat[which(ccs$ParticipantID == 189)] <- 5
ccs$ASSIST_6.sedat[which(ccs$ParticipantID == 189)] <- 3
ccs$ASSIST_7.sedat[which(ccs$ParticipantID == 189)] <- 1.5
ccs$ASSIST_8.sedat[which(ccs$ParticipantID == 189)] <- 0
ccs$ASSIST_sedat_ssi[which(ccs$ParticipantID == 189)] <- 23.5
# PTID 275 indicated Xanax in the "Other" category, but did not respond to any items 2-8 for this so N/A. 
# PTID 282 did not indicate any drug in the "Other" category and had 0s for every item, so N/A. 
# Deleting "Other" variables since no longer needed.
ccs <- dplyr::select(ccs, everything(), -ASSIST_1.other, -ASSIST_1.other_TEXT, -ASSIST_2.other, -ASSIST_2.other_TEXT, -ASSIST_3.other, -ASSIST_3.other_TEXT, -ASSIST_4.other, -ASSIST_4.other_TEXT, -ASSIST_5.other, -ASSIST_5.other_TEXT, -ASSIST_6.other, -ASSIST_6.other_TEXT, -ASSIST_7.other, -ASSIST_7.other_TEXT, -ASSIST_8.other, -ASSIST_8.other_TEXT)

## Reliability: 
# Tobacco SSI
dplyr::select(ccs, c("ASSIST_2.tobac", "ASSIST_3.tobac", "ASSIST_4.tobac", "ASSIST_6.tobac", "ASSIST_7.tobac")) %>% psych::alpha()
# Alcohol SSI
dplyr::select(ccs, c("ASSIST_2.alc", "ASSIST_3.alc", "ASSIST_4.alc", "ASSIST_5.alc", "ASSIST_6.alc", "ASSIST_7.alc")) %>% psych::alpha()
# Marijuana SSI
dplyr::select(ccs, c("ASSIST_2.weed", "ASSIST_3.weed", "ASSIST_4.weed", "ASSIST_5.weed", "ASSIST_6.weed", "ASSIST_7.weed")) %>% psych::alpha()
# Cocaine SSI
dplyr::select(ccs, c("ASSIST_2.coke", "ASSIST_3.coke", "ASSIST_4.coke", "ASSIST_5.coke", "ASSIST_6.coke", "ASSIST_7.coke")) %>% psych::alpha()
# Amphetamines SSI
dplyr::select(ccs, c("ASSIST_2.amphet", "ASSIST_3.amphet", "ASSIST_4.amphet", "ASSIST_5.amphet", "ASSIST_6.amphet", "ASSIST_7.amphet")) %>% psych::alpha()
# Inhalants SSI
dplyr::select(ccs, c("ASSIST_2.inhale", "ASSIST_3.inhale", "ASSIST_4.inhale", "ASSIST_5.inhale", "ASSIST_6.inhale", "ASSIST_7.inhale")) %>% psych::alpha()
# Sedatives SSI - note: might need to exclude the case above (pt 189) for reliability as it may mess up this analysis. 
dplyr::select(ccs, c("ASSIST_2.sedat", "ASSIST_3.sedat", "ASSIST_4.sedat", "ASSIST_5.sedat", "ASSIST_6.sedat", "ASSIST_7.sedat")) %>% psych::alpha()
# Hallucinogens SSI
dplyr::select(ccs, c("ASSIST_2.halluc", "ASSIST_3.halluc", "ASSIST_4.halluc", "ASSIST_5.halluc", "ASSIST_6.halluc", "ASSIST_7.halluc")) %>% psych::alpha()
# Opiates SSI 
dplyr::select(ccs, c("ASSIST_2.opiates", "ASSIST_3.opiates", "ASSIST_4.opiates", "ASSIST_5.opiates", "ASSIST_6.opiates", "ASSIST_7.opiates")) %>% psych::alpha()

## Descriptives
describe(ccs$ASSIST_tobac_ssi)
describe(ccs$ASSIST_alc_ssi)
describe(ccs$ASSIST_weed_ssi)
describe(ccs$ASSIST_coke_ssi)
describe(ccs$ASSIST_amphet_ssi)
describe(ccs$ASSIST_inhale_ssi)
describe(ccs$ASSIST_sedat_ssi)
describe(ccs$ASSIST_halluc_ssi)
describe(ccs$ASSIST_opiates_ssi)

## Get frequency of past 3-month drug use - anything other than a 0 among valid cases tells you they used in last 3 months at least once. 
frq(ccs$ASSIST_2.tobac)
frq(ccs$ASSIST_2.alc)
frq(ccs$ASSIST_2.weed)
frq(ccs$ASSIST_2.coke)
frq(ccs$ASSIST_2.amphet)
frq(ccs$ASSIST_2.inhale)
frq(ccs$ASSIST_2.sedat)
frq(ccs$ASSIST_2.halluc)
frq(ccs$ASSIST_2.opiates)

## Histograms 
ggplot(data = ccs, aes(ASSIST_tobac_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_alc_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_weed_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_coke_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_amphet_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_inhale_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_sedat_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_halluc_ssi)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(ASSIST_opiates_ssi)) + geom_histogram(binwidth = 1)
```

##### *Coping with Discrimination Scale (CDS)*  
```{r}
## Note original validation article for this scale (Wei et al. 2010) is a 25-item measure. The adaptation for sexual minorities (Ngamake et al. 2014) found that the 5 negatively worded items loaded poorly and deleted them. This code scores the 20-item version. 

## Recodes: none 

##Scoring Instructions: Take the mean of all items in the scale
# Education/advocacy Subscale (items 21, 16, 11, 6, 1) 
ccs$CDS_educ_mean <- rowMeans(ccs[c("CDS_21", "CDS_16", "CDS_11", "CDS_6", "CDS_1")], na.rm = TRUE)
# Resistance Subscale (items 9, 4, 24)
ccs$CDS_resist_mean <-rowMeans(ccs[c("CDS_9", "CDS_4", "CDS_24")], na.rm = TRUE)
# Drug and alcohol use Subscale (items 23, 3, 8) 
ccs$CDS_drug_mean <- rowMeans(ccs[c("CDS_23", "CDS_3", "CDS_8")], na.rm = TRUE)
# Internalization Subscale (items 10, 20, 15, 5) 
ccs$CDS_int_mean <-rowMeans(ccs[c("CDS_10", "CDS_20", "CDS_15", "CDS_5")], na.rm = TRUE)
# Detachment Subscale (items 7, 12, 22, 17, 2) 
ccs$CDS_detach_mean <-rowMeans(ccs[c("CDS_7", "CDS_12", "CDS_22", "CDS_17", "CDS_2")], na.rm = TRUE)

# 1 couple did not complete this scale, so this changes their scores to NA. 
ccs$CDS_educ_mean[ccs$CoupleID == 1138] <- NA
ccs$CDS_resist_mean[ccs$CoupleID == 1138] <- NA
ccs$CDS_drug_mean[ccs$CoupleID == 1138] <- NA
ccs$CDS_int_mean[ccs$CoupleID == 1138] <- NA
ccs$CDS_detach_mean[ccs$CoupleID == 1138] <- NA

## Reliability 
# Education/advocacy Subscale (items 1, 6, 11, 16, 21)
dplyr::select(ccs, CDS_21, CDS_16, CDS_11, CDS_6, CDS_1) %>% psych::alpha()
# Resistance Subscale (items 9, 4, 24, 14r, 19r)
dplyr::select(ccs, CDS_9, CDS_4, CDS_24) %>% psych::alpha()
# Drug and alcohol use Subscale (items 23, 3, 8, 13r, 18r) 
dplyr::select(ccs, CDS_23, CDS_3, CDS_8) %>% psych::alpha()
# Internalization Subscale (items 10, 20, 15, 5, 25r) 
dplyr::select(ccs, CDS_10, CDS_20, CDS_15, CDS_5) %>% psych::alpha()
# Detachment Subscale (items 7, 12, 22, 17, 2) 
dplyr::select(ccs, CDS_7, CDS_12, CDS_22, CDS_17, CDS_2) %>% psych::alpha()

## Frequencies 
describe(ccs$CDS_educ_mean)
describe(ccs$CDS_resist_mean)
describe(ccs$CDS_drug_mean)
describe(ccs$CDS_int_mean)
describe(ccs$CDS_detach_mean)

## Histogram for CDS
ggplot(data = ccs, aes(CDS_educ_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CDS_resist_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CDS_drug_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CDS_int_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CDS_detach_mean)) + geom_histogram(binwidth = 1)
```

##### *Coping Flexibility Scale (CFS)*  
```{r}
## Recodes: Items 1 and 7 are reverse-scored.
ccs <- ccs %>% 
  mutate(CFS_2r = recode(CFS_2, '0' = 3, '1' = 2, '2' = 1, '3' = 0),
         CFS_7r = recode(CFS_7, '0' = 3, '1' = 2, '2' = 1, '3' = 0))

##Scoring Instructions: Sum items for each subscale. 
# Evaluation Coping subscale (items 2r, 6, 7r, 8, 9) 
ccs$CFS_eval_sum <- rowSums(ccs[c("CFS_2r", "CFS_6", "CFS_7r", "CFS_8", "CFS_9")], na.rm = TRUE)
# Adaptive Coping subscale (items 1, 3, 4, 5, 10)
ccs$CFS_adapt_sum <- rowSums(ccs[c("CFS_1", "CFS_3", "CFS_4", "CFS_5", "CFS_10")], na.rm = TRUE)

## Reliability for CFS
# Evaluation Coping subscale (items 2r, 6, 7r, 8, 9) 
dplyr::select(ccs, CFS_2r, CFS_6, CFS_7r, CFS_8, CFS_9) %>% psych::alpha()
# Adaptive Coping subscale (items 1, 3, 4, 5, 10)
dplyr::select(ccs, CFS_1, CFS_3, CFS_4, CFS_5, CFS_10) %>% psych::alpha()

## Frequencies for CFS
describe(ccs$CFS_eval_sum)
describe(ccs$CFS_adapt_sum)

## Histogram for CFS
ggplot(data = ccs, aes(CFS_eval_sum)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(CFS_adapt_sum)) + geom_histogram(binwidth = 1)
```

##### *Nebraska Outness Scale (NOS)*  
```{r}
## Recodes: NOSC items are reverse-scored to be computed for the full scale (higher scores = greater outness). 
ccs <- ccs %>% 
  mutate(NOSC_1r = recode(NOSC_1, '0' = 10, '1' = 9, '2' = 8, '3' = 7, '4' = 6, '5' = 5, '6' = 4, '7' = 3, '8' = 2, '9' = 1, '10' = 0),
         NOSC_2r = recode(NOSC_2, '0' = 10, '1' = 9, '2' = 8, '3' = 7, '4' = 6, '5' = 5, '6' = 4, '7' = 3, '8' = 2, '9' = 1, '10' = 0),
         NOSC_3r = recode(NOSC_3, '0' = 10, '1' = 9, '2' = 8, '3' = 7, '4' = 6, '5' = 5, '6' = 4, '7' = 3, '8' = 2, '9' = 1, '10' = 0),
         NOSC_4r = recode(NOSC_4, '0' = 10, '1' = 9, '2' = 8, '3' = 7, '4' = 6, '5' = 5, '6' = 4, '7' = 3, '8' = 2, '9' = 1, '10' = 0),
         NOSC_5r = recode(NOSC_5, '0' = 10, '1' = 9, '2' = 8, '3' = 7, '4' = 6, '5' = 5, '6' = 4, '7' = 3, '8' = 2, '9' = 1, '10' = 0))

##Scoring Instructions: Compute mean for concealment items and for disclosure items. Then, compute total outness score with the disclosure subscale + reverse-coded concealment items. 
# Disclosure subscale mean
ccs$NOSD_mean <- rowMeans(ccs[c("NOSD_1", "NOSD_2", "NOSD_3", "NOSD_4", "NOSD_5")], na.rm = TRUE)
# Concealment subscale mean
ccs$NOSC_mean <- rowMeans(ccs[c("NOSC_1", "NOSC_2", "NOSC_3", "NOSC_4", "NOSC_5")], na.rm = TRUE)
# Total outness score mean
ccs$NOS_mean <- rowMeans(ccs[c("NOSD_1", "NOSD_2", "NOSD_3", "NOSD_4", "NOSD_5", "NOSC_1r", "NOSC_2r", "NOSC_3r", "NOSC_4r", "NOSC_5r")],na.rm = TRUE)

## Reliability for NOS
# Disclosure subscale
dplyr::select(ccs, NOSD_1, NOSD_2, NOSD_3, NOSD_4, NOSD_5) %>% psych::alpha()
# Concealment subscale
dplyr::select(ccs, NOSC_1, NOSC_2, NOSC_3, NOSC_4, NOSC_5) %>% psych::alpha()
# Total outness score
dplyr::select(ccs, NOSD_1, NOSD_2, NOSD_3, NOSD_4, NOSD_5, NOSC_1r, NOSC_2r, NOSC_3r, NOSC_4r, NOSC_5r) %>% psych::alpha()

## Frequencies for NOS
describe(ccs$NOSD_mean)
describe(ccs$NOSC_mean)
describe(ccs$NOS_mean)

## Histogram for NOS
ggplot(data = ccs, aes(NOSD_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(NOSC_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(NOS_mean)) + geom_histogram(binwidth = 1)
```

##### *Gay-Related Rejection Sensitivity (GRRS)*  
```{r}
## Recodes: Need to multiply likelihood ratings by anxiety ratings for each item.
ccs <- ccs %>% 
  mutate(GRRS_1 = GRRS_1anx*GRRS_1likely,
         GRRS_2 = GRRS_2anx*GRRS_2likely,
         GRRS_3 = GRRS_3anx*GRRS_3likely,
         GRRS_4 = GRRS_4anx*GRRS_4likely,
         GRRS_5 = GRRS_5anx*GRRS_5likely,
         GRRS_6 = GRRS_6anx*GRRS_6likely,
         GRRS_7 = GRRS_7anx*GRRS_7likely,
         GRRS_8 = GRRS_8anx*GRRS_8likely,
         GRRS_9 = GRRS_9anx*GRRS_9likely,
         GRRS_10 = GRRS_10anx*GRRS_10likely,
         GRRS_11 = GRRS_11anx*GRRS_11likely,
         GRRS_12 = GRRS_12anx*GRRS_12likely)

##Scoring Instructions: Take mean of all 12 anx*likelihood variables.
ccs$GRRS_mean <- rowMeans(ccs[c("GRRS_1", "GRRS_2", "GRRS_3", "GRRS_4", "GRRS_5", "GRRS_6", "GRRS_7", "GRRS_8", "GRRS_9", "GRRS_10", "GRRS_11", "GRRS_12")], na.rm = TRUE)
# 1 couple did not complete this scale, so this changes their scores to NA. 
ccs$GRRS_mean[ccs$CoupleID == 1138] <- NA

## Reliability for GRRS
dplyr::select(ccs, GRRS_1, GRRS_2, GRRS_3, GRRS_4, GRRS_5, GRRS_6, GRRS_7, GRRS_8, GRRS_9, GRRS_10, GRRS_11, GRRS_12) %>% psych::alpha()

## Frequencies for GRRS
describe(ccs$GRRS_mean)

## Histogram for GRRS
ggplot(data = ccs, aes(GRRS_mean)) + geom_histogram(binwidth = 1)

```

##### *Internalized Homophobia Scale (IHS)*  
```{r}
## Recodes: none

## Scoring Instructions: Total score is mean of all 9 items.
ccs$IHS_mean <- rowMeans(ccs[c("IHS_1", "IHS_2", "IHS_3", "IHS_4", "IHS_5", "IHS_6", "IHS_7", "IHS_8", "IHS_9")], na.rm = TRUE)

## Reliability for IHS
dplyr::select(ccs, IHS_1, IHS_2, IHS_3, IHS_4, IHS_5, IHS_6, IHS_7, IHS_8, IHS_9) %>% psych::alpha()

## Frequencies for IHS
describe(ccs$IHS_mean)

## Histogram for IHS
ggplot(data = ccs, aes(IHS_mean)) + geom_histogram(binwidth = 1)
```

##### *Sexual Orientation-Related Discrimination Inventory (SORDI)*  
```{r}
## Recodes: Each SORDI item has an a and b stem, reflecting frequency and severity (if any frequency is endorsed other than 0). Given the way this scale was programmed in Qualtrics, it is possible that participants responded w/ a severity rating for each SORDI event (item b, severity) even if they endorsed that they had never experienced that discrimination event. This code will set item b (severity) for each SORDI event to NA if 0 was endorsed for item a (frequency)
ccs <- ccs %>% 
  mutate(SORDI_1b = if_else(SORDI_1a == 0, NA_real_, SORDI_1b),
         SORDI_2b = if_else(SORDI_2a == 0, NA_real_, SORDI_2b),
         SORDI_3b = if_else(SORDI_3a == 0, NA_real_, SORDI_3b),
         SORDI_4b = if_else(SORDI_4a == 0, NA_real_, SORDI_4b),
         SORDI_5b = if_else(SORDI_5a == 0, NA_real_, SORDI_5b),
         SORDI_6b = if_else(SORDI_6a == 0, NA_real_, SORDI_6b),
         SORDI_7b = if_else(SORDI_7a == 0, NA_real_, SORDI_7b),
         SORDI_8b = if_else(SORDI_8a == 0, NA_real_, SORDI_8b),
         SORDI_9b = if_else(SORDI_9a == 0, NA_real_, SORDI_9b),
         SORDI_10b = if_else(SORDI_10a == 0, NA_real_, SORDI_10b),
         SORDI_11b = if_else(SORDI_11a == 0, NA_real_, SORDI_11b),
         SORDI_12b = if_else(SORDI_12a == 0, NA_real_, SORDI_12b),
         SORDI_13b = if_else(SORDI_13a == 0, NA_real_, SORDI_13b),
         SORDI_14b = if_else(SORDI_14a == 0, NA_real_, SORDI_14b),
         SORDI_15b = if_else(SORDI_15a == 0, NA_real_, SORDI_15b),
         SORDI_16b = if_else(SORDI_16a == 0, NA_real_, SORDI_16b),
         SORDI_17b = if_else(SORDI_17a == 0, NA_real_, SORDI_17b),
         SORDI_18b = if_else(SORDI_18a == 0, NA_real_, SORDI_18b),
         SORDI_19b = if_else(SORDI_19a == 0, NA_real_, SORDI_19b),
         SORDI_20b = if_else(SORDI_20a == 0, NA_real_, SORDI_20b),
         SORDI_21b = if_else(SORDI_21a == 0, NA_real_, SORDI_21b),
         SORDI_22b = if_else(SORDI_22a == 0, NA_real_, SORDI_22b),
         SORDI_23b = if_else(SORDI_23a == 0, NA_real_, SORDI_23b),
         SORDI_24b = if_else(SORDI_24a == 0, NA_real_, SORDI_24b),
         SORDI_25b = if_else(SORDI_25a == 0, NA_real_, SORDI_25b),
         SORDI_26b = if_else(SORDI_26a == 0, NA_real_, SORDI_26b),
         SORDI_27b = if_else(SORDI_27a == 0, NA_real_, SORDI_27b),
         SORDI_28b = if_else(SORDI_28a == 0, NA_real_, SORDI_28b),
         SORDI_29b = if_else(SORDI_29a == 0, NA_real_, SORDI_29b),
         SORDI_30b = if_else(SORDI_30a == 0, NA_real_, SORDI_30b),
         SORDI_31b = if_else(SORDI_31a == 0, NA_real_, SORDI_31b),
         SORDI_32b = if_else(SORDI_32a == 0, NA_real_, SORDI_32b),
         SORDI_33b = if_else(SORDI_33a == 0, NA_real_, SORDI_33b),
         SORDI_34b = if_else(SORDI_34a == 0, NA_real_, SORDI_34b),
         SORDI_35b = if_else(SORDI_35a == 0, NA_real_, SORDI_35b))

## Scoring Instructions: Items 1-30 reflect non-traumatic discrimination experiences and items 31-35 reflect traumatic discrimination experiences. Two scores can be obtained, one reflecting past 6-month frequency of discrimination (take the sum) and one reflecting perceived severity of the experience (if endorsed, take the mean). 

# SORDI non-trauma discrimination FREQUENCY
ccs$SORDI_nontraum_freq <- rowSums(ccs[c("SORDI_1a", "SORDI_2a", "SORDI_3a", "SORDI_4a","SORDI_5a", "SORDI_6a", "SORDI_7a", "SORDI_8a", "SORDI_9a","SORDI_10a", "SORDI_11a", "SORDI_12a", "SORDI_13a", "SORDI_14a","SORDI_15a","SORDI_16a", "SORDI_17a", "SORDI_18a", "SORDI_19a","SORDI_20a", "SORDI_21a", "SORDI_22a", "SORDI_23a", "SORDI_24a", "SORDI_25a", "SORDI_26a", "SORDI_27a", "SORDI_28a", "SORDI_29a", "SORDI_30a")], na.rm = TRUE)
# SORDI trauma discrimination FREQUENCY
ccs$SORDI_traum_freq <- rowSums(ccs[c("SORDI_31a", "SORDI_32a", "SORDI_33a", "SORDI_34a", "SORDI_35a")], na.rm = TRUE)

# SORDI non-trauma discrimination SEVERITY
ccs$SORDI_nontraum_sev <- rowMeans(ccs[c("SORDI_1b", "SORDI_2b", "SORDI_3b", "SORDI_4b","SORDI_5b", "SORDI_6b", "SORDI_7b", "SORDI_8b", "SORDI_9b","SORDI_10b", "SORDI_11b", "SORDI_12b", "SORDI_13b", "SORDI_14b","SORDI_15b","SORDI_16b", "SORDI_17b", "SORDI_18b", "SORDI_19b","SORDI_20b", "SORDI_21b", "SORDI_22b", "SORDI_23b", "SORDI_24b", "SORDI_25b", "SORDI_26b", "SORDI_27b", "SORDI_28b", "SORDI_29b", "SORDI_30b")], na.rm = TRUE)
# SORDI trauma discrimination SEVERITY
ccs$SORDI_traum_sev <- rowMeans(ccs[c("SORDI_31b", "SORDI_32b", "SORDI_33b", "SORDI_34b", "SORDI_35b")], na.rm = TRUE)

# SORDI total scale FREQUENCY
ccs$SORDI_tot_freq <- rowSums(ccs[c("SORDI_1a", "SORDI_2a", "SORDI_3a", "SORDI_4a","SORDI_5a", "SORDI_6a", "SORDI_7a", "SORDI_8a", "SORDI_9a","SORDI_10a", "SORDI_11a", "SORDI_12a", "SORDI_13a", "SORDI_14a","SORDI_15a","SORDI_16a", "SORDI_17a", "SORDI_18a", "SORDI_19a","SORDI_20a", "SORDI_21a", "SORDI_22a", "SORDI_23a", "SORDI_24a", "SORDI_25a", "SORDI_26a", "SORDI_27a", "SORDI_28a", "SORDI_29a", "SORDI_30a", "SORDI_31a", "SORDI_32a", "SORDI_33a", "SORDI_34a", "SORDI_35a")], na.rm = TRUE)
# SORDI total scale SEVERITY 
ccs$SORDI_tot_sev <- rowMeans(ccs[c("SORDI_1b", "SORDI_2b", "SORDI_3b", "SORDI_4b","SORDI_5b", "SORDI_6b", "SORDI_7b", "SORDI_8b", "SORDI_9b","SORDI_10b", "SORDI_11b", "SORDI_12b", "SORDI_13b", "SORDI_14b","SORDI_15b","SORDI_16b", "SORDI_17b", "SORDI_18b", "SORDI_19b","SORDI_20b", "SORDI_21b", "SORDI_22b", "SORDI_23b", "SORDI_24b", "SORDI_25b", "SORDI_26b", "SORDI_27b", "SORDI_28b", "SORDI_29b", "SORDI_30b", "SORDI_31b", "SORDI_32b", "SORDI_33b", "SORDI_34b", "SORDI_35b")], na.rm = TRUE)

## Reliability 
# Non-trauma discrimination FREQUENCY
dplyr::select(ccs, c("SORDI_1a", "SORDI_2a", "SORDI_3a", "SORDI_4a","SORDI_5a", "SORDI_6a", "SORDI_7a", "SORDI_8a", "SORDI_9a","SORDI_10a", "SORDI_11a", "SORDI_12a", "SORDI_13a", "SORDI_14a","SORDI_15a","SORDI_16a", "SORDI_17a", "SORDI_18a", "SORDI_19a","SORDI_20a", "SORDI_21a", "SORDI_22a", "SORDI_23a", "SORDI_24a", "SORDI_25a", "SORDI_26a", "SORDI_27a", "SORDI_28a", "SORDI_29a", "SORDI_30a")) %>% psych::alpha()
# Trauma discrimination FREQUENCY
dplyr::select(ccs, c("SORDI_31a", "SORDI_32a", "SORDI_33a", "SORDI_34a", "SORDI_35a")) %>% psych::alpha()
# Non-trauma discrimination SEVERITY - need to deal with missing values to run
#dplyr::select(ccs, c("SORDI_1b", "SORDI_2b", "SORDI_3b", "SORDI_4b","SORDI_5b", "SORDI_6b", "SORDI_7b", "SORDI_8b", "SORDI_9b","SORDI_10b", "SORDI_11b", "SORDI_12b", "SORDI_13b", "SORDI_14b","SORDI_15b","SORDI_16b", "SORDI_17b", "SORDI_18b", "SORDI_19b","SORDI_20b", "SORDI_21b", "SORDI_22b", "SORDI_23b", "SORDI_24b", "SORDI_25b", "SORDI_26b", "SORDI_27b", "SORDI_28b", "SORDI_29b", "SORDI_30b")) %>% psych::alpha()
# Trauma discrimination SEVERITY - need to deal with missing values to run
#dplyr::select(ccs, c("SORDI_31b", "SORDI_32b", "SORDI_33b", "SORDI_34b", "SORDI_35b")) %>% psych::alpha()
# Total discrimination FREQUENCY
dplyr::select(ccs, c("SORDI_1a", "SORDI_2a", "SORDI_3a", "SORDI_4a","SORDI_5a", "SORDI_6a", "SORDI_7a", "SORDI_8a", "SORDI_9a","SORDI_10a", "SORDI_11a", "SORDI_12a", "SORDI_13a", "SORDI_14a","SORDI_15a","SORDI_16a", "SORDI_17a", "SORDI_18a", "SORDI_19a","SORDI_20a", "SORDI_21a", "SORDI_22a", "SORDI_23a", "SORDI_24a", "SORDI_25a", "SORDI_26a", "SORDI_27a", "SORDI_28a", "SORDI_29a", "SORDI_30a", "SORDI_31a", "SORDI_32a", "SORDI_33a", "SORDI_34a", "SORDI_35a")) %>% psych::alpha()
# Total discrimination SEVERITY - need to deal with missing values to run
#dplyr::select(cs, c("SORDI_1b", "SORDI_2b", "SORDI_3b", "SORDI_4b","SORDI_5b", "SORDI_6b", "SORDI_7b", "SORDI_8b", "SORDI_9b","SORDI_10b", "SORDI_11b", "SORDI_12b", "SORDI_13b", "SORDI_14b","SORDI_15b","SORDI_16b", "SORDI_17b", "SORDI_18b", "SORDI_19b","SORDI_20b", "SORDI_21b", "SORDI_22b", "SORDI_23b", "SORDI_24b", "SORDI_25b", "SORDI_26b", "SORDI_27b", "SORDI_28b", "SORDI_29b", "SORDI_30b", "SORDI_31b", "SORDI_32b", "SORDI_33b", "SORDI_34b", "SORDI_35b")) %>% psych::alpha()

## Frequencies for SORDI
describe(ccs$SORDI_nontraum_freq)
describe(ccs$SORDI_traum_freq)
describe(ccs$SORDI_nontraum_sev)
describe(ccs$SORDI_traum_sev)
describe(ccs$SORDI_tot_freq)
describe(ccs$SORDI_tot_sev)

## Histogram for SORDI
ggplot(data = ccs, aes(SORDI_nontraum_freq)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SORDI_traum_freq)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SORDI_nontraum_sev)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SORDI_traum_sev)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SORDI_tot_freq)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(SORDI_tot_sev)) + geom_histogram(binwidth = 1)

```

##### *Everyday Discrimination Scale (EDS)*  
```{r}
## Recodes: none

## Scoring Instructions: Sum all 9 items.
ccs$EDS_sum <- rowSums(ccs[c("EDS_1", "EDS_2", "EDS_3", "EDS_4", "EDS_5", "EDS_6", "EDS_7", "EDS_8", "EDS_9")], na.rm = TRUE)

## Reliability for EDS
dplyr::select(ccs, EDS_1, EDS_2, EDS_3, EDS_4, EDS_5, EDS_6, EDS_7, EDS_8, EDS_9) %>% psych::alpha()

## Frequencies for EDS
describe(ccs$EDS_sum)

## Histogram for EDS
ggplot(data = ccs, aes(EDS_sum)) + geom_histogram(binwidth = 1)

```

##### *Heterosexist Harassment, Rejection, and Discrimination Scale (HHRDS)*  
```{r}
## Recodes: none

## Scoring Instructions: Take mean of all 14 items. 
ccs$HHRDS_mean <- rowMeans(ccs[c("HHRDS_1", "HHRDS_2", "HHRDS_3", "HHRDS_4", "HHRDS_5", "HHRDS_6", "HHRDS_7", "HHRDS_8", "HHRDS_9", "HHRDS_10", "HHRDS_11", "HHRDS_12", "HHRDS_13", "HHRDS_14")], na.rm = TRUE) 

## Reliability for HHRDS
dplyr::select(ccs, HHRDS_1, HHRDS_2, HHRDS_3, HHRDS_4, HHRDS_5, HHRDS_6, HHRDS_7, HHRDS_8, HHRDS_9, HHRDS_10, HHRDS_11, HHRDS_12, HHRDS_13, HHRDS_14) %>% psych::alpha()

## Frequencies for HHRDS
describe(ccs$HHRDS_mean)

## Histogram for HHRDS
ggplot(data = ccs, aes(HHRDS_mean)) + geom_histogram(binwidth = 1)
```

##### *Daily Heterosexist Experiences Questionnaire (DHEQ)*  
```{r}
## Recodes: none

## Scoring Instructions: Take mean of all items in each subscale. Only Discrimination/Harassment and Victimization subscales were measured in this study. 
# Discrimination/Harassment subscale: items 15, 29, 44, 45, 46, 49
ccs$DHHQ_disc_mean <- rowMeans(ccs[c("DHHQ_15", "DHHQ_29", "DHHQ_44", "DHHQ_45", "DHHQ_46", "DHHQ_49")], na.rm = TRUE) 
# Victimization subscale: items 76, 77, 78, 79, 80
ccs$DHHQ_vict_mean <- rowMeans(ccs[c("DHHQ_76", "DHHQ_77", "DHHQ_78", "DHHQ_79", "DHHQ_80")], na.rm = TRUE) 
# Total scale (includes victimization & discrimination/harassment subscales)
ccs$DHHQ_total_mean <- rowMeans(ccs[c("DHHQ_15", "DHHQ_29", "DHHQ_44", "DHHQ_45", "DHHQ_46", "DHHQ_49", "DHHQ_76", "DHHQ_77", "DHHQ_78", "DHHQ_79", "DHHQ_80")], na.rm = TRUE) 

## Reliability 
# Discrimination/Harassment subscale
dplyr::select(ccs, c("DHHQ_15", "DHHQ_29", "DHHQ_44", "DHHQ_45", "DHHQ_46", "DHHQ_49")) %>% psych::alpha()
# Vicitmization subscale
dplyr::select(ccs, c("DHHQ_76", "DHHQ_77", "DHHQ_78", "DHHQ_79", "DHHQ_80")) %>% psych::alpha()
# Total scale
dplyr::select(ccs, c("DHHQ_15", "DHHQ_29", "DHHQ_44", "DHHQ_45", "DHHQ_46", "DHHQ_49", "DHHQ_76", "DHHQ_77", "DHHQ_78", "DHHQ_79", "DHHQ_80")) %>% psych::alpha()

## Frequencies for DHHQ
describe(ccs$DHHQ_disc_mean)
describe(ccs$DHHQ_vict_mean)
describe(ccs$DHHQ_total_mean)

## Histogram for DHHQ
ggplot(data = ccs, aes(DHHQ_disc_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DHHQ_vict_mean)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(DHHQ_total_mean)) + geom_histogram(binwidth = 1)
```

##### *Life Events List (LEL)*  
```{r}
## NOTE: There were some intentional edits to this scale that warrant drawing attention to here. 
# 1. The version of the scale administered here intentionally skips item 12. Item 12 is about abortion, and thus was omitted from this study b/c it was not particularly applicable to this sample (where decisions about having a child are generally going to be intentional, outside the context of sexual assault). 
# 2. The original LEL administers items 11 and 13 separately to men and women with different wording b/c they deal with pregnancy. For this study, we modified the wording of these items to be gender inclusive and thus these items were not separated by gender. 
# 3. Items 11b, 12a, 12b, and 13b of the original LEL were thus not administered.
# 4. There was a scoring error with item 4 - this was supposed to be a "select all that apply" variable but it was programmed where only 1 option (out of 8 total) could be selected. 
# 5. IMPORTANT: We added questions to this measure (to items 6, 14, 16, 19, 20, 21, 24) if they could plausibly be experienced due to sexual orientation (e.g., breaking up with a friend). The scoring below will NOT count stressful life events related to sexual orientation for the purposes of the main analyses of this study (so this measure does not unintentionally pick up on discrimination). This is likely imperfect, as for some items it was not particularly feasible with Qualtrics programming to ask about sexual orientation related reasons for the event (e.g., item 7 - did you have any important relationship significantly worsen?)

## Recodes: 

# These items were not appropriately keyed with 0 = no, 1 = yes. 
ccs <- ccs %>% 
  mutate(LEL_21 = recode(LEL_21, '1' = 0, '2' = 1),
         LEL_22 = recode(LEL_22, '1' = 0, '2' = 1))

# Each item gets a sum of positive and negative events, as some items can contain multiple events. Events are scored as either pertaining to the self or other (depending on the nature of it). Most items are rated on a 6-point likert scale (1 = very good to 6 = very bad) and categorized as positive or negative accordingly. This code will sort out variables according to this so they can be used for summary scores below. 
ccs <- ccs %>%
  rowwise() %>% 
  mutate(LEL_1pos_self = if_else(LEL_1b <= 3, 1, 0),
         LEL_1neg_self = if_else(LEL_1b >= 4, 1, 0),
         LEL_2pos_self = if_else(LEL_2a <= 3, 1, 0),
         LEL_2neg_self = if_else(LEL_2a >= 4, 1, 0),
         LEL_3pos_self = if_else(LEL_3b <= 3, 1, 0),
         LEL_3neg_self = if_else(LEL_3b >= 4, 1, 0),
         LEL_4neg_self = if_else(LEL_4 == 1, 1, 0), # given scoring error above this variable is consistent with other yes/no variables in dataset - counted as negative 
         LEL_5pos_self = if_else(LEL_5b <= 3, 1, 0),
         LEL_5neg_self = if_else(LEL_5b >= 4, 1, 0),
         LEL_6pos_self = if_else(LEL_6b <= 3 & LEL_6c == 0, 1, 0), # & LEL_6c == 0 makes sure that the event is only counted if it was NOT related to sexual orientation, this format is continued throughout the syntax below.  
         LEL_6neg_self = if_else(LEL_6b >= 4 & LEL_6c == 0, 1, 0),
         LEL_7neg_self = sum(c(LEL_7a_boss, LEL_7a_spouse, LEL_7a_friend, LEL_7a_child, LEL_7a_parent, LEL_7a_other)),
         LEL_8pos_self = if_else(LEL_8c <= 3, 1, 0),
         LEL_8neg_self = if_else(LEL_8c >= 4, 1, 0),
         LEL_9neg_self = if_else(LEL_9a_you == 1, 1, 0),
         LEL_9neg_other = sum(c(LEL_9a_spouse, LEL_9a_child, LEL_9a_parent, LEL_9a_inlaw, LEL_9a_sibling, LEL_9a_friend, LEL_9a_other)),
         LEL_10neg_self = if_else(LEL_10a_you == 1, 1, 0),
         LEL_10neg_other = sum(c(LEL_10a_spouse, LEL_10a_child, LEL_10a_parent, LEL_10a_inlaw, LEL_10a_sibling, LEL_10a_friend, LEL_10a_other)),
         LEL_11pos_self = if_else(LEL_11a <= 3, 1, 0),
         LEL_11neg_self = if_else(LEL_11a >= 4, 1, 0), # note original scale asked this question separately to men and women; in this study we made it into one and rephrased to be gender inclusive 
         LEL_13neg_self = if_else(LEL_13 == 1, 1, 0), # this event is coded as a negative self event; variable created to be consistent with other variables used for scoring
         LEL_14self = if_else(LEL_14a == 1 | LEL_14a == 3, 1, 0),
         LEL_14pos_self = if_else(LEL_14self == 1 & LEL_14e == 0 & LEL_14d <= 3, 1, 0), # & LEL_14e for this and following lines of code for this item makes sure event is only counted if it was NOT related to sexual orientation.  
         LEL_14neg_self = if_else(LEL_14self == 1 & LEL_14e == 0 & LEL_14d >= 4, 1, 0), 
         LEL_14pos_other = if_else(LEL_14self == 0 & LEL_14e == 0 & LEL_14d <= 3, 1, 0), 
         LEL_14neg_other = if_else(LEL_14self == 0 & LEL_14e == 0 & LEL_14d >= 4, 1, 0),
         LEL_15neg_self = if_else(LEL_15a == 1 | LEL_15a == 3, 1, 0),
         LEL_15neg_other = if_else(LEL_15a == 2, 1, 0),
         LEL_16neg_self = if_else((LEL_16a == 1 | LEL_16a == 3) & LEL_16c == 0, 1, 0),
         LEL_16neg_other = if_else(LEL_16a == 2 & LEL_16c == 0, 1, 0),
         LEL_17pos_self = if_else(LEL_17a == 1 | LEL_17a == 3, 1, 0), 
         LEL_17pos_other = if_else(LEL_17a == 2, 1, 0),
         LEL_18pos_self = if_else(LEL_18a == 1, 1, 0),
         LEL_18neg_self = if_else(LEL_18a == 2, 1, 0), 
         LEL_19neg_self = if_else(LEL_19 == 1 & LEL_19a == 0, 1, 0),
         LEL_20neg_self = if_else(LEL_20a_you == 1 & LEL_20b == 0, 1, 0),
         LEL_20neg_other = if_else(LEL_20b == 0, sum(c(LEL_20a_spouse, LEL_20a_child, LEL_20a_parent, LEL_20a_sibling, LEL_20a_other)), 0),
         LEL_21neg_self = if_else(LEL_21b == 0, sum(c(LEL_21a_spouse, LEL_21a_child, LEL_21a_parent, LEL_21a_sibling, LEL_21a_other)), 0),
         LEL_22self = if_else(LEL_22a == 1 | LEL_22a == 3, 1, 0), 
         LEL_22pos_self = if_else(LEL_22self == 1 & LEL_22b <= 3, 1, 0),
         LEL_22neg_self = if_else(LEL_22self == 1 & LEL_22b >= 4, 1, 0),
         LEL_22pos_other = if_else(LEL_22self == 0 & LEL_22b <= 3, 1, 0),
         LEL_22neg_other = if_else(LEL_22self == 0 & LEL_22b >= 4, 1, 0),
         LEL_23neg_self = if_else(LEL_23 == 1, 1, 0),
         LEL_24.1self = if_else(LEL_24event1a == 1, 1, 0),
         LEL_24.1pos_self = if_else(LEL_24.1self == 1 & LEL_24event1e == 0 & LEL_24event1d <= 3, 1, 0),
         LEL_24.1neg_self = if_else(LEL_24.1self == 1 & LEL_24event1e == 0 & LEL_24event1d >= 4, 1, 0),
         LEL_24.1pos_other = if_else(LEL_24.1self == 0 & LEL_24event1e == 0 & LEL_24event1d <= 3, 1, 0),
         LEL_24.1neg_other = if_else(LEL_24.1self == 0 & LEL_24event1e == 0 & LEL_24event1d >= 4, 1, 0),
         LEL_24.2self = if_else(LEL_24event2a == 1, 1, 0),
         LEL_24.2pos_self = if_else(LEL_24.2self == 1 & LEL_24event2e == 0 & LEL_24event2d <= 3, 1, 0),
         LEL_24.2neg_self = if_else(LEL_24.2self == 1 & LEL_24event2e == 0 & LEL_24event2d >= 4, 1, 0),
         LEL_24.2pos_other = if_else(LEL_24.2self == 0 & LEL_24event2e == 0 & LEL_24event2d <= 3, 1, 0),
         LEL_24.2neg_other = if_else(LEL_24.2self == 0 & LEL_24event2e == 0 & LEL_24event2d >= 4, 1, 0),
         LEL_24.3self = if_else(LEL_24event3a == 1, 1, 0),
         LEL_24.3pos_self = if_else(LEL_24.3self == 1 & LEL_24event3e == 0 & LEL_24event3d <= 3, 1, 0),
         LEL_24.3neg_self = if_else(LEL_24.3self == 1 & LEL_24event3e == 0 & LEL_24event3d >= 4, 1, 0),
         LEL_24.3pos_other = if_else(LEL_24.3self == 0 & LEL_24event3e == 0 & LEL_24event3d <= 3, 1, 0),
         LEL_24.3neg_other = if_else(LEL_24.3self == 0 & LEL_24event3e == 0 & LEL_24event3d >= 4, 1, 0)) %>% 
  ungroup() 

## Scoring Instructions: 

# Note: these are derived from the PDF on scoring instructions posted to Cohen's webpage. 

# Sum total negative self-events
ccs$LEL_negself <- rowSums(ccs[c("LEL_1neg_self", "LEL_2neg_self", "LEL_3neg_self", "LEL_4neg_self", "LEL_5neg_self", "LEL_6neg_self", "LEL_7neg_self", "LEL_8neg_self", "LEL_9neg_self", "LEL_10neg_self", "LEL_11neg_self", "LEL_13neg_self", "LEL_14neg_self", "LEL_15neg_self", "LEL_16neg_self", "LEL_18neg_self", "LEL_19neg_self", "LEL_20neg_self", "LEL_21neg_self", "LEL_22neg_self", "LEL_23neg_self", "LEL_24.1neg_self", "LEL_24.2neg_self", "LEL_24.3neg_self")], na.rm = TRUE) 
# Sum total positive self-events
ccs$LEL_posself <- rowSums(ccs[c("LEL_1pos_self", "LEL_2pos_self", "LEL_3pos_self", "LEL_5pos_self", "LEL_6pos_self", "LEL_8pos_self", "LEL_11pos_self", "LEL_14pos_self", "LEL_17pos_self", "LEL_18pos_self", "LEL_22pos_self", "LEL_24.1pos_self", "LEL_24.2pos_self", "LEL_24.3pos_self")], na.rm = TRUE)
# Sum total negative other-events
ccs$LEL_negother <-rowSums(ccs[c("LEL_9neg_other", "LEL_10neg_other", "LEL_14neg_other", "LEL_15neg_other", "LEL_16neg_other", "LEL_20neg_other", "LEL_22neg_other", "LEL_24.1neg_other", "LEL_24.2neg_other", "LEL_24.3neg_other")], na.rm = TRUE)
# Sum total positive other-events
ccs$LEL_posother <- rowSums(ccs[c("LEL_14pos_other", "LEL_17pos_other", "LEL_22pos_other", "LEL_24.1pos_other", "LEL_24.2pos_other", "LEL_24.3pos_other")], na.rm = TRUE)
# Sum total self events
ccs$LEL_totalself <- rowSums(ccs[c("LEL_posself", "LEL_negself")], na.rm = TRUE)
# Sum total other events
ccs$LEL_totalother <- rowSums(ccs[c("LEL_posother", "LEL_negother")], na.rm = TRUE)
# Sum total positive events
ccs$LEL_totalpos <- rowSums(ccs[c("LEL_posself", "LEL_posother")], na.rm = TRUE)
# Sum total negative events
ccs$LEL_totalneg <- rowSums(ccs[c("LEL_negself", "LEL_negother")], na.rm = TRUE)
# Sum total life events (pos + neg)
ccs$LEL_totalevents <- rowSums(ccs[c("LEL_totalself", "LEL_totalother")], na.rm = TRUE)

## Frequencies
describe(ccs$LEL_negself)
describe(ccs$LEL_posself)
describe(ccs$LEL_negother)
describe(ccs$LEL_posother)
describe(ccs$LEL_totalself)
describe(ccs$LEL_totalother)
describe(ccs$LEL_totalpos)
describe(ccs$LEL_totalneg)
describe(ccs$LEL_totalevents)

## Histograms
ggplot(data = ccs, aes(LEL_negself)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_posself)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_negother)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_posother)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_totalself)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_totalother)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_totalpos)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_totalneg)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(LEL_totalevents)) + geom_histogram(binwidth = 1)

```

##### *Traumatic Life Events Questionnaire (TLEQ)*  
```{r}
# Given the nature of this scale and the varying ways it could be used according to research question, this code does not specifically score this questionnaire. 
```

##### *Positive and Negative Affect Schedule (PANAS)*  
```{r}
## IMPORTANT NOTE:
# Participants completed the PANAS 4 different times (BL + after each of the 3 discuussions_. In the original Qualtrics programming, PANAS 1 = pre first discussion/baseline, PANAS2 = post first discussion & pre second discussion, PANAS3 = post second discussion and pre positive discussion, PANAS4 = post positive discussion. Because the order of stressor discussions were randomized, PANAS2 and 3 could reflect either post discrimination stressor or post life stressor scores. The code here scores the PANAS according to whether it is a measure of POST DISCUSSION affect, thus we recode PANAS2 and 3 to reflect this based on the discussion order. The intention here was to make sure that we had post discussion affect scores. That being said, if there is substantive interest in changes from BL to the discussions, other configurations may be necessary so edit the code accordingly. 
# Thus, the way this code is written preserves the original ordering of the PANAS1-PANAS4 in case that is needed. It ALSO separates out new variables to reflect what assessment point it is - PANAS_bl, PANAS_life (post life stressor), PANAS_discrim (post discrimination stressor), and PANAS_posit (post positive discussions). PANAS1 and PANAS4 variables are exactly the same as PANAS_bl and PANAS_posit - they are repeated to make everything easier to understand based on the variable labelling. 

## Recodes: none

## Scoring Instructions: split into positive & negative affect subscales (sum of all items in the scale, no reverse-scoring). Positive items = 1, 3, 5, 9, 10, 12, 14, 16, 17, and 19. Negative items = 2, 4, 6, 7, 8, 11, 13, 15, 18, and 20
ccs$PANAS1_pos <- rowSums(ccs[c("PANAS1_1", "PANAS1_3", "PANAS1_5", "PANAS1_9", "PANAS1_10", "PANAS1_12", "PANAS1_14", "PANAS1_16", "PANAS1_17", "PANAS1_19")], na.rm = TRUE)
ccs$PANAS1_neg <- rowSums(ccs[c("PANAS1_2", "PANAS1_4", "PANAS1_6", "PANAS1_7", "PANAS1_8", "PANAS1_11", "PANAS1_13", "PANAS1_15", "PANAS1_18", "PANAS1_20")], na.rm = TRUE)

ccs$PANAS2_pos <- rowSums(ccs[c("PANAS2_1", "PANAS2_3", "PANAS2_5", "PANAS2_9", "PANAS2_10", "PANAS2_12", "PANAS2_14", "PANAS2_16", "PANAS2_17", "PANAS2_19")], na.rm = TRUE)
ccs$PANAS2_neg <- rowSums(ccs[c("PANAS2_2", "PANAS2_4", "PANAS2_6", "PANAS2_7", "PANAS2_8", "PANAS2_11", "PANAS2_13", "PANAS2_15", "PANAS2_18", "PANAS2_20")], na.rm = TRUE)

ccs$PANAS3_pos <- rowSums(ccs[c("PANAS3_1", "PANAS3_3", "PANAS3_5", "PANAS3_9", "PANAS3_10", "PANAS3_12", "PANAS3_14", "PANAS3_16", "PANAS3_17", "PANAS3_19")], na.rm = TRUE)
ccs$PANAS3_neg <- rowSums(ccs[c("PANAS3_2", "PANAS3_4", "PANAS3_6", "PANAS3_7", "PANAS3_8", "PANAS3_11", "PANAS3_13", "PANAS3_15", "PANAS3_18", "PANAS3_20")], na.rm = TRUE)

ccs$PANAS4_pos <- rowSums(ccs[c("PANAS4_1", "PANAS4_3", "PANAS4_5", "PANAS4_9", "PANAS4_10", "PANAS4_12", "PANAS4_14", "PANAS4_16", "PANAS4_17", "PANAS4_19")], na.rm = TRUE)
ccs$PANAS4_neg <- rowSums(ccs[c("PANAS4_2", "PANAS4_4", "PANAS4_6", "PANAS4_7", "PANAS4_8", "PANAS4_11", "PANAS4_13", "PANAS4_15", "PANAS4_18", "PANAS4_20")], na.rm = TRUE)

# Above code sets cases where there are all missing responses to 0 (it allows ones where there was only 1-2 missing items to be calculated), so this code sets the following couples to have NA values for PANAS summary scores appropriately. CoupleID 1138 did not complete any of the PANAS. CoupleID 1021 & CoupleID 1054 were missing PANAS data for PANAS 2-4. CoupleID 1012 did not complete PANAS4.   
ccs <- ccs %>% 
  mutate(PANAS1_pos = if_else(CoupleID == 1138, NA_real_, PANAS1_pos),
         PANAS1_neg = if_else(CoupleID == 1138, NA_real_, PANAS1_neg),
         PANAS2_pos = if_else(CoupleID == 1021 | CoupleID == 1054 | CoupleID == 1138, NA_real_, PANAS2_pos),
         PANAS2_neg = if_else(CoupleID == 1021 | CoupleID == 1054 | CoupleID == 1138, NA_real_, PANAS2_neg),
         PANAS3_pos = if_else(CoupleID == 1021 | CoupleID == 1054 | CoupleID == 1138, NA_real_, PANAS3_pos),
         PANAS3_neg = if_else(CoupleID == 1021 | CoupleID == 1054 | CoupleID == 1138, NA_real_, PANAS3_neg),
         PANAS4_pos = if_else(CoupleID == 1012 | CoupleID == 1021 | CoupleID == 1054 | CoupleID == 1138, NA_real_, PANAS4_pos),
         PANAS4_neg = if_else(CoupleID == 1012 | CoupleID == 1021 | CoupleID == 1054 | CoupleID == 1138, NA_real_, PANAS4_neg))

# This code adds in a variable denoting the discussion order. Discussion order (either life stressor or discrimination first) was randomly determined for this study. 
ccs <- ccs %>% 
  mutate(DiscussionOrder = if_else(CoupleID == 1006 | CoupleID == 1007 | CoupleID == 1009 | CoupleID == 1015 | CoupleID == 1018 | CoupleID == 1021 | CoupleID == 1023 | CoupleID == 1027 | CoupleID == 1029 | CoupleID == 1045 | CoupleID == 1055 | CoupleID == 1060 | CoupleID == 1061 | CoupleID == 1065 | CoupleID == 1068 | CoupleID == 1069 | CoupleID == 1070 | CoupleID == 1074 | CoupleID == 1075 | CoupleID == 1076 | CoupleID == 1077 | CoupleID == 1081 | CoupleID == 1083 | CoupleID == 1084 | CoupleID == 1086 | CoupleID == 1090 | CoupleID == 1091 | CoupleID == 1094 | CoupleID == 1095 | CoupleID == 1097 | CoupleID == 1102 | CoupleID == 1104 | CoupleID == 1105 | CoupleID == 1107 | CoupleID == 1108 | CoupleID == 1113 | CoupleID == 1115 | CoupleID == 1122 | CoupleID == 1128 | CoupleID == 1134 | CoupleID == 1137 | CoupleID == 1138, 0, 1), # Note 1054 and 1138 did not complete discussions, but they were assigned a discussion order. Demarcating as such makes it so they don't get cut out of the code below
         DiscussionOrder = recode_factor(DiscussionOrder,
                                         `0` = "Discrimination stressor discussion first",
                                         `1` = "Life stressor discussion first"))

# Renames the PANAS1 to reflect BL scores and PANAS4 to reflect post positive discussions. 
ccs <- ccs %>% 
  mutate(PANAS_bl_pos = PANAS1_pos, 
         PANAS_bl_neg = PANAS1_neg, 
         PANAS_bl_1 = PANAS1_1, 
         PANAS_bl_2 = PANAS1_2, 
         PANAS_bl_3 = PANAS1_3, 
         PANAS_bl_4 = PANAS1_4, 
         PANAS_bl_5 = PANAS1_5, 
         PANAS_bl_6 = PANAS1_6, 
         PANAS_bl_7 = PANAS1_7, 
         PANAS_bl_8 = PANAS1_8, 
         PANAS_bl_9 = PANAS1_9, 
         PANAS_bl_10 = PANAS1_10, 
         PANAS_bl_11 = PANAS1_11, 
         PANAS_bl_12 = PANAS1_12, 
         PANAS_bl_13 = PANAS1_13, 
         PANAS_bl_14 = PANAS1_14, 
         PANAS_bl_15 = PANAS1_15, 
         PANAS_bl_16 = PANAS1_16, 
         PANAS_bl_17 = PANAS1_17, 
         PANAS_bl_18 = PANAS1_18, 
         PANAS_bl_19 = PANAS1_19, 
         PANAS_bl_20 = PANAS1_20,
         PANAS_posit_pos = PANAS4_pos, 
         PANAS_posit_neg = PANAS4_neg, 
         PANAS_posit_1 = PANAS4_1, 
         PANAS_posit_2 = PANAS4_2, 
         PANAS_posit_3 = PANAS4_3, 
         PANAS_posit_4 = PANAS4_4, 
         PANAS_posit_5 = PANAS4_5, 
         PANAS_posit_6 = PANAS4_6, 
         PANAS_posit_7 = PANAS4_7, 
         PANAS_posit_8 = PANAS4_8, 
         PANAS_posit_9 = PANAS4_9, 
         PANAS_posit_10 = PANAS4_10, 
         PANAS_posit_11 = PANAS4_11, 
         PANAS_posit_12 = PANAS4_12, 
         PANAS_posit_13 = PANAS4_13, 
         PANAS_posit_14 = PANAS4_14, 
         PANAS_posit_15 = PANAS4_15, 
         PANAS_posit_16 = PANAS4_16, 
         PANAS_posit_17 = PANAS4_17, 
         PANAS_posit_18 = PANAS4_18, 
         PANAS_posit_19 = PANAS4_19, 
         PANAS_posit_20 = PANAS4_20,
         Post_posit_sim = Post3_Sim, 
         Post_posit_impt = Post3_Impt, 
         Post_posit_freq = Post3_Freq)

## Because the discussion order was randomized, the labeling of the PANAS needs to be fixed according to which discussion it referenced (post life stressor or post discrimination). 

# Separates out post life stressor discussion ratings, then merges them into a single dataset
life_pt1 <- ccs %>% 
  filter(DiscussionOrder == 'Life stressor discussion first') %>% 
  dplyr::select(ParticipantID, PANAS2_pos, PANAS2_neg, Post1_Sim, Post1_Impt, Post1_Freq, PANAS2_1:PANAS2_20) %>% 
  arrange(ParticipantID)

life_pt1 <- life_pt1 %>% 
  rename(PANAS_life_pos = PANAS2_pos, 
         PANAS_life_neg = PANAS2_neg, 
         Post_life_sim = Post1_Sim, 
         Post_life_impt = Post1_Impt, 
         Post_life_freq = Post1_Freq, 
         PANAS_life_1 = PANAS2_1, 
         PANAS_life_2 = PANAS2_2, 
         PANAS_life_3 = PANAS2_3, 
         PANAS_life_4 = PANAS2_4, 
         PANAS_life_5 = PANAS2_5, 
         PANAS_life_6 = PANAS2_6, 
         PANAS_life_7 = PANAS2_7, 
         PANAS_life_8 = PANAS2_8, 
         PANAS_life_9 = PANAS2_9, 
         PANAS_life_10 = PANAS2_10, 
         PANAS_life_11 = PANAS2_11, 
         PANAS_life_12 = PANAS2_12, 
         PANAS_life_13 = PANAS2_13, 
         PANAS_life_14 = PANAS2_14, 
         PANAS_life_15 = PANAS2_15, 
         PANAS_life_16 = PANAS2_16, 
         PANAS_life_17 = PANAS2_17, 
         PANAS_life_18 = PANAS2_18, 
         PANAS_life_19 = PANAS2_19, 
         PANAS_life_20 = PANAS2_20)

life_pt2 <- ccs %>% 
  filter(DiscussionOrder == 'Discrimination stressor discussion first') %>% 
  dplyr::select(ParticipantID, PANAS3_pos, PANAS3_neg, Post2_Sim, Post2_Impt, Post2_Freq, PANAS3_1:PANAS3_20) %>% 
  arrange(ParticipantID)

life_pt2 <- life_pt2 %>% 
  rename(PANAS_life_pos = PANAS3_pos, 
         PANAS_life_neg = PANAS3_neg, 
         Post_life_sim = Post2_Sim, 
         Post_life_impt = Post2_Impt, 
         Post_life_freq = Post2_Freq, 
         PANAS_life_1 = PANAS3_1, 
         PANAS_life_2 = PANAS3_2, 
         PANAS_life_3 = PANAS3_3, 
         PANAS_life_4 = PANAS3_4, 
         PANAS_life_5 = PANAS3_5, 
         PANAS_life_6 = PANAS3_6, 
         PANAS_life_7 = PANAS3_7, 
         PANAS_life_8 = PANAS3_8, 
         PANAS_life_9 = PANAS3_9, 
         PANAS_life_10 = PANAS3_10, 
         PANAS_life_11 = PANAS3_11, 
         PANAS_life_12 = PANAS3_12, 
         PANAS_life_13 = PANAS3_13, 
         PANAS_life_14 = PANAS3_14, 
         PANAS_life_15 = PANAS3_15, 
         PANAS_life_16 = PANAS3_16, 
         PANAS_life_17 = PANAS3_17, 
         PANAS_life_18 = PANAS3_18, 
         PANAS_life_19 = PANAS3_19, 
         PANAS_life_20 = PANAS3_20)

LifeStress <- rbind(life_pt1, life_pt2)

rm(life_pt1)
rm(life_pt2)

# Separates out post discrimination stressor discussion ratings, then merges them into a single dataset
disc_pt1 <- ccs %>% 
  filter(DiscussionOrder == 'Discrimination stressor discussion first') %>% 
  dplyr::select(ParticipantID, PANAS2_pos, PANAS2_neg, Post1_Sim, Post1_Impt, Post1_Freq, PANAS2_1:PANAS2_20) %>% 
  arrange(ParticipantID)

disc_pt1 <- disc_pt1 %>% 
  rename(PANAS_disc_pos = PANAS2_pos, 
         PANAS_disc_neg = PANAS2_neg,
         Post_disc_sim = Post1_Sim, 
         Post_disc_impt = Post1_Impt, 
         Post_disc_freq = Post1_Freq, 
         PANAS_disc_1 = PANAS2_1, 
         PANAS_disc_2 = PANAS2_2, 
         PANAS_disc_3 = PANAS2_3, 
         PANAS_disc_4 = PANAS2_4, 
         PANAS_disc_5 = PANAS2_5, 
         PANAS_disc_6 = PANAS2_6, 
         PANAS_disc_7 = PANAS2_7, 
         PANAS_disc_8 = PANAS2_8, 
         PANAS_disc_9 = PANAS2_9, 
         PANAS_disc_10 = PANAS2_10, 
         PANAS_disc_11 = PANAS2_11, 
         PANAS_disc_12 = PANAS2_12, 
         PANAS_disc_13 = PANAS2_13, 
         PANAS_disc_14 = PANAS2_14, 
         PANAS_disc_15 = PANAS2_15, 
         PANAS_disc_16 = PANAS2_16, 
         PANAS_disc_17 = PANAS2_17, 
         PANAS_disc_18 = PANAS2_18, 
         PANAS_disc_19 = PANAS2_19, 
         PANAS_disc_20 = PANAS2_20)

disc_pt2 <- ccs %>% 
  filter(DiscussionOrder == 'Life stressor discussion first') %>% 
  dplyr::select(ParticipantID, PANAS3_pos, PANAS3_neg, Post2_Sim, Post2_Impt, Post2_Freq, PANAS3_1:PANAS3_20) %>% 
  arrange(ParticipantID)

disc_pt2 <- disc_pt2 %>% 
  rename(PANAS_disc_pos = PANAS3_pos, 
         PANAS_disc_neg = PANAS3_neg, 
         Post_disc_sim = Post2_Sim, 
         Post_disc_impt = Post2_Impt, 
         Post_disc_freq = Post2_Freq, 
         PANAS_disc_1 = PANAS3_1, 
         PANAS_disc_2 = PANAS3_2, 
         PANAS_disc_3 = PANAS3_3, 
         PANAS_disc_4 = PANAS3_4, 
         PANAS_disc_5 = PANAS3_5, 
         PANAS_disc_6 = PANAS3_6, 
         PANAS_disc_7 = PANAS3_7, 
         PANAS_disc_8 = PANAS3_8, 
         PANAS_disc_9 = PANAS3_9, 
         PANAS_disc_10 = PANAS3_10, 
         PANAS_disc_11 = PANAS3_11, 
         PANAS_disc_12 = PANAS3_12, 
         PANAS_disc_13 = PANAS3_13, 
         PANAS_disc_14 = PANAS3_14, 
         PANAS_disc_15 = PANAS3_15, 
         PANAS_disc_16 = PANAS3_16, 
         PANAS_disc_17 = PANAS3_17, 
         PANAS_disc_18 = PANAS3_18, 
         PANAS_disc_19 = PANAS3_19, 
         PANAS_disc_20 = PANAS3_20)

DiscrimStress <- rbind(disc_pt1, disc_pt2)

rm(disc_pt1)
rm(disc_pt2)

# Merges all variables from post life stressor and discrimination stressor discussions into the main dataset
ccs <- left_join(ccs, LifeStress, by = "ParticipantID")
ccs <- left_join(ccs, DiscrimStress, by = "ParticipantID")
rm(DiscrimStress)
rm(LifeStress)

## Reliability
# BL ratings.
dplyr::select(ccs, c(PANAS_bl_1, PANAS_bl_3, PANAS_bl_5, PANAS_bl_9, PANAS_bl_10, PANAS_bl_12, PANAS_bl_14, PANAS_bl_16, PANAS_bl_17, PANAS_bl_19)) %>% psych::alpha()
dplyr::select(ccs, c(PANAS_bl_2, PANAS_bl_4, PANAS_bl_6, PANAS_bl_7, PANAS_bl_8, PANAS_bl_11, PANAS_bl_13, PANAS_bl_15, PANAS_bl_18, PANAS_bl_20)) %>% psych::alpha()
# Post life stressor discussion ratings.
dplyr::select(ccs, c(PANAS_life_1, PANAS_life_3, PANAS_life_5, PANAS_life_9, PANAS_life_10, PANAS_life_12, PANAS_life_14, PANAS_life_16, PANAS_life_17, PANAS_life_19)) %>% psych::alpha()
dplyr::select(ccs, c(PANAS_life_2, PANAS_life_4, PANAS_life_6, PANAS_life_7, PANAS_life_8, PANAS_life_11, PANAS_life_13, PANAS_life_15, PANAS_life_18, PANAS_life_20)) %>% psych::alpha()
# Post discrimination stressor discussion ratings. 
dplyr::select(ccs, c(PANAS_disc_1, PANAS_disc_3, PANAS_disc_5, PANAS_disc_9, PANAS_disc_10, PANAS_disc_12, PANAS_disc_14, PANAS_disc_16, PANAS_disc_17, PANAS_disc_19)) %>% psych::alpha()
dplyr::select(ccs, c(PANAS_disc_2, PANAS_disc_4, PANAS_disc_6, PANAS_disc_7, PANAS_disc_8, PANAS_disc_11, PANAS_disc_13, PANAS_disc_15, PANAS_disc_18, PANAS_disc_20)) %>% psych::alpha()
# Post positive discussion ratings. 
dplyr::select(ccs, c(PANAS_posit_1, PANAS_posit_3, PANAS_posit_5, PANAS_posit_9, PANAS_posit_10, PANAS_posit_12, PANAS_posit_14, PANAS_posit_16, PANAS_posit_17, PANAS_posit_19)) %>% psych::alpha()
dplyr::select(ccs, c(PANAS_posit_2, PANAS_posit_4, PANAS_posit_6, PANAS_posit_7, PANAS_posit_8, PANAS_posit_11, PANAS_posit_13, PANAS_posit_15, PANAS_posit_18, PANAS_posit_20)) %>% psych::alpha()

## Frequencies
# BL ratings
describe(ccs$PANAS_bl_pos)
describe(ccs$PANAS_bl_neg)
# Post life stressor discussion ratings
describe(ccs$PANAS_life_pos)
describe(ccs$PANAS_life_neg)
describe(ccs$Post_life_sim)
describe(ccs$Post_life_impt)
describe(ccs$Post_life_freq)
# Post discrimination stressor discussion ratings 
describe(ccs$PANAS_disc_pos)
describe(ccs$PANAS_disc_neg)
describe(ccs$Post_disc_sim)
describe(ccs$Post_disc_impt)
describe(ccs$Post_disc_freq)
# Post positive discussion ratings
describe(ccs$PANAS_posit_pos)
describe(ccs$PANAS_posit_neg)
describe(ccs$Post_posit_sim)
describe(ccs$Post_posit_impt)
describe(ccs$Post_posit_freq)

## Histograms
# BL ratings
ggplot(data = ccs, aes(PANAS_bl_pos)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(PANAS_bl_neg)) + geom_histogram(binwidth = 1)
# Post life stressor discussion ratings
ggplot(data = ccs, aes(PANAS_life_pos)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(PANAS_life_neg)) + geom_histogram(binwidth = 1)
# Post discrimination stressor discussion ratings 
ggplot(data = ccs, aes(PANAS_disc_pos)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(PANAS_disc_neg)) + geom_histogram(binwidth = 1)
# Post positive discussion ratings
ggplot(data = ccs, aes(PANAS_posit_pos)) + geom_histogram(binwidth = 1)
ggplot(data = ccs, aes(PANAS_posit_neg)) + geom_histogram(binwidth = 1)

```

# *Cleaning & Scoring Discussion Topic Selections and Order* 
```{r}
# Discussion topics for the behavioral observation tasks were selected by RAs during study appointments. These were initially reported in Qualtrics by both partners and RAs copied them (plus their ratings) down on a sheet of paper. They then selected whichever topic was highest rated or rank ordered by EITHER partner as the topic. Where possible, RAs tried to keep the severity ratings similar between chosen topics and to make sure each partner got one of their topics selected, although this was not always possible depending on how many topics were supplied and how they were appraised. 
# The chosen topics were highlighted on this physical form and stored with the participant data file. TJS went through and verified which topics were selected by RAs and used for discussions. This is in a separate Excel file where only the selected topics & ratings are included to be merged here - see below. 

# A few couples did not have either partner report on discrimination topics, in which case RAs probed for potential topics and had them select a rating. This code makes sure those are entered into the survey data. This was for CoupleID 1027 (PTID 154), CoupleID 1057 (PTID 214 - note for this one, the RA did not probe about severity rating so this is missing for this topic), CoupleID 1072 (PTID 243), CoupleID 1107 (PTID 313), and CoupleID 1128 (PTID 355). 
ccs <- ccs %>% 
  mutate(StressorTopic_1 = if_else(ParticipantID == 154, 'problems at work/school', StressorTopic_1), 
         StressorExp1_rating = if_else(ParticipantID == 154, 3, StressorExp1_rating),
         DiscrimTopic_1 = if_else(ParticipantID == 214, 'discrimination in family', DiscrimTopic_1),
         StressorTopic_1 = if_else(ParticipantID == 243, 'international student/traveling', StressorTopic_1),
         StressorExp1_rating = if_else(ParticipantID == 243, 3, StressorExp1_rating),
         DiscrimTopic_1 = if_else(ParticipantID == 313, 'dirty looks', DiscrimTopic_1),
         DiscrimExp1_rating = if_else(ParticipantID == 313, 2, DiscrimExp1_rating),
         DiscrimTopic_1 = if_else(ParticipantID == 355, 'called a faggot by a cheerleading teammate', DiscrimTopic_1),
         DiscrimExp1_rating = if_else(ParticipantID == 355, 2, DiscrimExp1_rating))

# Read in file with just the selected topics (SelectedTopics.xlsx). This contains all of the columns for discussion topics but has blanks cells for anything that was not selected to make tabulations easier here. 
selected <- read_excel(file.choose())

# PTID 214 has a character response "NA" that needs to be converted so the variable is numeric. 
selected$DiscrimExp1_rating[which(selected$ParticipantID == 214)] <- NA
selected$DiscrimExp1_rating <- as.numeric(selected$DiscrimExp1_rating)

# This will create a variable for each topic that indicates what rank order it was placed in (1-5 from most to least stressful according to instructiosn)
selected <- selected %>% 
  mutate(PosTopic_rank = if_else(!is.na(PosTopic_1), 1, NA_real_),
         PosTopic_rank = if_else(!is.na(PosTopic_2), 2, PosTopic_rank),
         PosTopic_rank = if_else(!is.na(PosTopic_3), 3, PosTopic_rank),
         PosTopic_rank = if_else(!is.na(PosTopic_4), 4, PosTopic_rank),
         PosTopic_rank = if_else(!is.na(PosTopic_5), 5, PosTopic_rank),
         StressorTopic_rank = if_else(!is.na(StressorTopic_1), 1, NA_real_),
         StressorTopic_rank = if_else(!is.na(StressorTopic_2), 2, StressorTopic_rank),
         StressorTopic_rank = if_else(!is.na(StressorTopic_3), 3, StressorTopic_rank),
         StressorTopic_rank = if_else(!is.na(StressorTopic_4), 4, StressorTopic_rank),
         StressorTopic_rank = if_else(!is.na(StressorTopic_5), 5, StressorTopic_rank),
         DiscrimTopic_rank = if_else(!is.na(DiscrimTopic_1), 1, NA_real_),
         DiscrimTopic_rank = if_else(!is.na(DiscrimTopic_2), 2, DiscrimTopic_rank),
         DiscrimTopic_rank = if_else(!is.na(DiscrimTopic_3), 3, DiscrimTopic_rank),
         DiscrimTopic_rank = if_else(!is.na(DiscrimTopic_4), 4, DiscrimTopic_rank),
         DiscrimTopic_rank = if_else(!is.na(DiscrimTopic_5), 5, DiscrimTopic_rank))

# This will place the selected topic into 1 variable (rather than being in separate variables). 
selected$PosTopic <- ''
selected$StressorTopic <- ''
selected$DiscrimTopic <- ''

selected <- selected %>% 
  mutate(PosTopic = if_else(PosTopic_rank == 1, PosTopic_1, PosTopic),
         PosTopic = if_else(PosTopic_rank == 2, PosTopic_2, PosTopic),
         PosTopic = if_else(PosTopic_rank == 3, PosTopic_3, PosTopic),
         PosTopic = if_else(PosTopic_rank == 4, PosTopic_4, PosTopic),
         PosTopic = if_else(PosTopic_rank == 5, PosTopic_5, PosTopic),
         StressorTopic = if_else(StressorTopic_rank == 1, StressorTopic_1, StressorTopic),
         StressorTopic = if_else(StressorTopic_rank == 2, StressorTopic_2, StressorTopic),
         StressorTopic = if_else(StressorTopic_rank == 3, StressorTopic_3, StressorTopic),
         StressorTopic = if_else(StressorTopic_rank == 4, StressorTopic_4, StressorTopic),
         StressorTopic = if_else(StressorTopic_rank == 5, StressorTopic_5, StressorTopic),
         DiscrimTopic = if_else(DiscrimTopic_rank == 1, DiscrimTopic_1, DiscrimTopic),
         DiscrimTopic = if_else(DiscrimTopic_rank == 2, DiscrimTopic_2, DiscrimTopic),
         DiscrimTopic = if_else(DiscrimTopic_rank == 3, DiscrimTopic_3, DiscrimTopic),
         DiscrimTopic = if_else(DiscrimTopic_rank == 4, DiscrimTopic_4, DiscrimTopic),
         # note Discrim Topic 5 is not included here b/c no topics picked were ranked at 5
         StressorTopic_sev = if_else(StressorTopic_rank == 1, StressorExp1_rating, NA_real_),
         StressorTopic_sev = if_else(StressorTopic_rank == 2, StressorExp2_rating, StressorTopic_sev),
         StressorTopic_sev = if_else(StressorTopic_rank == 3, StressorExp3_rating, StressorTopic_sev),
         StressorTopic_sev = if_else(StressorTopic_rank == 4, StressorExp4_rating, StressorTopic_sev),
         StressorTopic_sev = if_else(StressorTopic_rank == 5, StressorExp5_rating, StressorTopic_sev),
         DiscrimTopic_sev = if_else(DiscrimTopic_rank == 1, DiscrimExp1_rating, NA_real_),
         DiscrimTopic_sev = if_else(DiscrimTopic_rank == 2, DiscrimExp2_rating, DiscrimTopic_sev),
         DiscrimTopic_sev = if_else(DiscrimTopic_rank == 3, DiscrimExp3_rating, DiscrimTopic_sev),
         DiscrimTopic_sev = if_else(DiscrimTopic_rank == 4, DiscrimExp4_rating, DiscrimTopic_sev)
  ) %>% 
  dplyr::select(CoupleID, ParticipantID, PosTopic, PosTopic_rank, StressorTopic, StressorTopic_sev, StressorTopic_rank, DiscrimTopic, DiscrimTopic_sev, DiscrimTopic_rank, everything())

# This code makes sure that the positive topics are exactly the same (including case/spelling & grammar) between both partners to facilitate restructuring the dataset from long to wide. In cases where 1 partner says more than the other (e.g., mutual trust/commitment vs. mutual trust) we use the more inclusive response. 
selected <- selected %>% 
  mutate(PosTopic = if_else(CoupleID == 1007 | CoupleID == 1018 | CoupleID == 1023 | CoupleID == 1025 | CoupleID == 1029 | CoupleID == 1038 | CoupleID == 1046 | CoupleID == 1070 | CoupleID == 1077 | CoupleID == 1129, 'Shared beliefs, values, or interests', PosTopic),
         PosTopic = if_else(CoupleID == 1012, 'Mutual trust/commitment', PosTopic),
         PosTopic = if_else(CoupleID == 1015, 'Connection/Love', PosTopic),
         PosTopic = if_else(CoupleID == 1016 | CoupleID == 1062 | CoupleID == 1076 | CoupleID == 1088 | CoupleID == 1111 | CoupleID == 1127 | CoupleID == 1128, 'Positive communication', PosTopic),
         PosTopic = if_else(CoupleID == 1024 | CoupleID == 1027 | CoupleID == 1049 | CoupleID == 1054 | CoupleID == 1069 | CoupleID == 1072 | CoupleID == 1125, 'Love', PosTopic),
         PosTopic = if_else(CoupleID == 1045 | CoupleID == 1091 | CoupleID == 1093, 'Friendship', PosTopic),
         PosTopic = if_else(CoupleID == 1047, 'Love and affection', PosTopic),
         PosTopic = if_else(CoupleID == 1068, 'Cuddles', PosTopic),
         PosTopic = if_else(CoupleID == 1081 | CoupleID == 1102, 'Connection and chemistry', PosTopic),
         PosTopic = if_else(CoupleID == 1084, 'Caregiving/support', PosTopic),
         PosTopic = if_else(CoupleID == 1089, 'Support', PosTopic),
         PosTopic = if_else(CoupleID == 1105, 'Sex/connection/chemistry', PosTopic),
         PosTopic = if_else(CoupleID == 1138, 'Trust/love', PosTopic))

# Make a factor variable indicating which partner's topic was chosen. 
selected <- selected %>% 
  mutate(StressorTopic_choice = if_else(!is.na(StressorTopic), 1, 0),
         StressorTopic_choice = recode_factor(StressorTopic_choice,
                                              `0` = "NOT chosen for discussion",
                                              `1` = "Chosen for discussion"),
         DiscrimTopic_choice = if_else(!is.na(DiscrimTopic), 1, 0),
         DiscrimTopic_choice = recode_factor(DiscrimTopic_choice,
                                              `0` = "NOT chosen for discussion",
                                              `1` = "Chosen for discussion"))

# Make a variable coding whether the choice of partner topic was balanced or not. There are two variables created for this - one that is more specific with 4 different categories as follows: 
# 0 = Balanced (discrimination stressor) means that the THEIR discrimination topic and THEIR PARTNER'S life stressor topic was chosen. 
# 1 = Balanced (life stressor) means that THEIR life stressor topic and THEIR PARTNER'S discrimination topic was chosen.
# 2 = One-sided (chosen) means that this person had BOTH of THEIR topics (discrimination + life) chosen for discussions. 
# 3 = One-sided (not chosen) means that this person had NEITHER of their topics (discrimination + life) chosen for discussions, instead it was their partner's topics that were chosen. 
# The second variable is a dichotomous variable indicating whether it was balanced (0) or one-sided (1) for the wide dataset. 
selected <- selected %>% 
  mutate(TopicBalance = case_when(
    StressorTopic_choice == 'NOT chosen for discussion' & DiscrimTopic_choice == 'Chosen for discussion' ~ 0,
    StressorTopic_choice == 'Chosen for discussion' & DiscrimTopic_choice == 'NOT chosen for discussion' ~ 1,
    StressorTopic_choice == 'Chosen for discussion' & DiscrimTopic_choice == 'Chosen for discussion' ~ 2,
    StressorTopic_choice == 'NOT chosen for discussion' & DiscrimTopic_choice == 'NOT chosen for discussion' ~ 3),
    TopicBalance = recode_factor(TopicBalance,
                                 `0` = "Balanced (discrim stressor)",
                                 `1` = "Balanced (life stressor)",
                                 `2` = "One-sided (chosen)",
                                 `3` = "One-sided (not chosen)"),
    TopicBalance_yn = if_else(TopicBalance == 'Balanced (discrim stressor)' | TopicBalance == 'Balanced (life stressor)', 0, 1),
    TopicBalance_yn = recode_factor(TopicBalance_yn,
                                    `0` = "Balanced",
                                    `1` = "One-sided")) 

# Delete variables that aren't needed for merging into main dataframe.
selected <- dplyr::select(selected, ParticipantID, StressorTopic_choice, DiscrimTopic_choice, TopicBalance, TopicBalance_yn, PosTopic, PosTopic_rank, StressorTopic, StressorTopic_sev, StressorTopic_rank, DiscrimTopic, DiscrimTopic_sev, DiscrimTopic_rank) 

# Finally, merge the created variables with the main dataset, remove selected dataframe since no longer needed. 
ccs <- ccs %>% 
  left_join(selected, by = "ParticipantID")

rm(selected)

```

# *Merging Dyadic Coping Coding Data*
### NOTES ABOUT ALL CODING DATA: Coding data comes from multiple sources. Data was collected via Qualtrics and cleaned in SPSS. Cleaned files were then saved as Excel files to be imported into R and merged with the self-report data here. The coding manual contains all information regarding coding and what was involved. The Qualtrics codebook for coding data shows how the data was organized and what variables mean (also mostly defined below). Although intimacy behaviors were in fact coded, reliability was too low to include. The data are NOT currently cleaned, but can be added if necessary. This code only imports the dyadic coping and social support coding. 
```{r}
##### Dyadic Coping Coding Data #####
# File name is "CodingData_DC_final_2020.11.23"
dc <- read_excel(file.choose())

# Recode factor variables. 
dc <- dc %>% 
  mutate(coder = recode_factor(coder,
                               `0` = "Amanda",
                               `1` = "Jared",
                               `2` = "Marisa",
                               `3` = "Jeffrey"),
         discussion = recode_factor(discussion,
                                    `0` = "Life Stressor",
                                    `1` = "Discrimination Stressor"),
         part1_side = recode_factor(part1_side,
                                    `0` = "Right side of the video",
                                    `1` = "Left side of the video"),
         part2_side = recode_factor(part2_side,
                                    `0` = "Right side of the video",
                                    `1` = "Left side of the video"),
         disc_list_role = recode_factor(disc_list_role,
                                        `0` = "Partners stayed in discloser/listener roles",
                                        `1` = "Partners about equal in discloser/listener roles",
                                        `2` = "Partners switched discloser/listener roles"), 
         stressor_type = recode_factor(stressor_type,
                                       `0` = "Individual stressor",
                                       `1` = "Joint stressor"),
         recode = recode_factor(recode,
                                `0` = "Not recoded due to audio",
                                `1` = "Recoded due to audio"),
         reliability = recode_factor(reliability,
                                     `0` = "Not used for reliability",
                                     `1` = "Used for reliability"),
         consensus = recode_factor(consensus,
                                   `0` = "No consensus recodes",
                                   `1` = "At least 1 code recoded for consensus"),
         stressor_type_rc = recode_factor(stressor_type_rc,
                                          `0` = "Individual stressor",
                                          `1` = "Joint stressor"),
         disc_list_role_rc = recode_factor(disc_list_role_rc,
                                        `0` = "Partners stayed in discloser/listener roles",
                                        `1` = "Partners about equal in discloser/listener roles",
                                        `2` = "Partners switched discloser/listener roles"),
         StressExpFreq_part2_rc = StressExpFreq_part2 # Note this last variable is technically not a recode because none of this variable was actually recoded. The purposes of labeling it as such as so that there's a block of original codes, and then a block of variables with recodes added. This makes it so we can just select all of the recoded variables for analyses if we want, or we can sub out original variables if needed (e.g., for a sensitivity analysis). Results for this variable would be the same. 
         ) %>%  
  dplyr::select(StartDate:part2_side,
                StressExpFreq_part1, StressExpSev_part1, PosDC_part1, NegDC_part1, 
                StressExpFreq_part2, StressExpSev_part2, PosDC_part2, NegDC_part2, 
                youVSwe, disc_list_role, stressor_type, GlobalCoping, 
                StressExpFreq_part1_rc, StressExpSev_part1_rc, PosDC_part1_rc, NegDC_part1_rc,
                StressExpFreq_part2_rc, StressExpSev_part2_rc, PosDC_part2_rc, NegDC_part2_rc,
                youVSwe_rc, disc_list_role_rc, stressor_type_rc, GlobalCoping_rc, 
                comments, recode, reliability, consensus)

# Select out life stressor & discrimination discussions into separate data frames. 
dc.life <- filter(dc, discussion == 'Life Stressor')
dc.disc <- filter(dc, discussion == 'Discrimination Stressor')

## These data are technically in WIDE format (1 row for each couple). To merge these variables with the self-report data, we need to make them into LONG format (so each couple gets 2 cases, 1 for each partner). Some variables are measured at the partner level (meaning partners may have different scores), others are measured at the couple level (meaning both partners will have the same score for that variable). 
# Life stressor discussion codes:
# Separate out partners into separate dataframes to rename variables. 
dc.life_p1 <- dplyr::select(dc.life,
                            coder_dc_life = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part1,
                            StressExpFreq_life = StressExpFreq_part1,
                            StressExpSev_life = StressExpSev_part1,
                            PosDC_life = PosDC_part1,
                            NegDC_life = NegDC_part1,
                            youVSwe_life = youVSwe,
                            disc_list_role_life = disc_list_role,
                            stressor_type_life = stressor_type,
                            GlobalCoping_life = GlobalCoping,
                            StressExpFreq_rc_life = StressExpFreq_part1_rc,
                            StressExpSev_rc_life = StressExpSev_part1_rc,
                            PosDC_rc_life = PosDC_part1_rc,
                            NegDC_rc_life = NegDC_part1_rc, 
                            youVSwe_rc_life = youVSwe_rc,
                            disc_list_role_rc_life = disc_list_role_rc,
                            stressor_type_rc_life = stressor_type_rc,
                            GlobalCoping_rc_life = GlobalCoping_rc,
                            comments_dc_life = comments,
                            recode_dc_life = recode,
                            reliability_dc_life = reliability,
                            consensus_dc_life = consensus)
dc.life_p2 <- dplyr::select(dc.life,
                            coder_dc_life = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part2,
                            StressExpFreq_life = StressExpFreq_part2,
                            StressExpSev_life = StressExpSev_part2,
                            PosDC_life = PosDC_part2,
                            NegDC_life = NegDC_part2,
                            youVSwe_life = youVSwe,
                            disc_list_role_life = disc_list_role,
                            stressor_type_life = stressor_type,
                            GlobalCoping_life = GlobalCoping,
                            StressExpFreq_rc_life = StressExpFreq_part2_rc,
                            StressExpSev_rc_life = StressExpSev_part2_rc,
                            PosDC_rc_life = PosDC_part2_rc,
                            NegDC_rc_life = NegDC_part2_rc, 
                            youVSwe_rc_life = youVSwe_rc,
                            disc_list_role_rc_life = disc_list_role_rc,
                            stressor_type_rc_life = stressor_type_rc,
                            GlobalCoping_rc_life = GlobalCoping_rc,
                            comments_dc_life = comments,
                            recode_dc_life = recode,
                            reliability_dc_life = reliability,
                            consensus_dc_life = consensus)

# Merge separated dataframes into 1 - now in long format
dc.life <- rbind(dc.life_p1, dc.life_p2)
dc.life <- arrange(dc.life, ParticipantID)
# Delete unneeded dataframes
rm(dc.life_p1)
rm(dc.life_p2)
# Join partner-level data into the main dataset 
ccs <- ccs %>% 
  left_join(dc.life, by = c("ParticipantID", "CoupleID"))
rm(dc.life) # no longer needed

# Discrimination stressor discussion codes:
dc.disc_p1 <- dplyr::select(dc.disc,
                            coder_dc_disc = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part1,
                            StressExpFreq_disc = StressExpFreq_part1,
                            StressExpSev_disc = StressExpSev_part1,
                            PosDC_disc = PosDC_part1,
                            NegDC_disc = NegDC_part1,
                            youVSwe_disc = youVSwe,
                            disc_list_role_disc = disc_list_role,
                            stressor_type_disc = stressor_type,
                            GlobalCoping_disc = GlobalCoping,
                            StressExpFreq_rc_disc = StressExpFreq_part1_rc,
                            StressExpSev_rc_disc = StressExpSev_part1_rc,
                            PosDC_rc_disc = PosDC_part1_rc,
                            NegDC_rc_disc = NegDC_part1_rc, 
                            youVSwe_rc_disc = youVSwe_rc,
                            disc_list_role_rc_disc = disc_list_role_rc,
                            stressor_type_rc_disc = stressor_type_rc,
                            GlobalCoping_rc_disc = GlobalCoping_rc,
                            comments_dc_disc = comments,
                            recode_dc_disc = recode,
                            reliability_dc_disc = reliability,
                            consensus_dc_disc = consensus)
dc.disc_p2 <- dplyr::select(dc.disc,
                            coder_dc_disc = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part2,
                            StressExpFreq_disc = StressExpFreq_part2,
                            StressExpSev_disc = StressExpSev_part2,
                            PosDC_disc = PosDC_part2,
                            NegDC_disc = NegDC_part2,
                            youVSwe_disc = youVSwe,
                            disc_list_role_disc = disc_list_role,
                            stressor_type_disc = stressor_type,
                            GlobalCoping_disc = GlobalCoping,
                            StressExpFreq_rc_disc = StressExpFreq_part2_rc,
                            StressExpSev_rc_disc = StressExpSev_part2_rc,
                            PosDC_rc_disc = PosDC_part2_rc,
                            NegDC_rc_disc = NegDC_part2_rc, 
                            youVSwe_rc_disc = youVSwe_rc,
                            disc_list_role_rc_disc = disc_list_role_rc,
                            stressor_type_rc_disc = stressor_type_rc,
                            GlobalCoping_rc_disc = GlobalCoping_rc,
                            comments_dc_disc = comments,
                            recode_dc_disc = recode,
                            reliability_dc_disc = reliability,
                            consensus_dc_disc = consensus)
# Merge separated dataframes into 1 - now in long format
dc.disc <- rbind(dc.disc_p1, dc.disc_p2)
dc.disc <- arrange(dc.disc, ParticipantID)
# Delete unneeded dataframes
rm(dc.disc_p1)
rm(dc.disc_p2)
# Join partner-level data into the main dataset 
ccs <- ccs %>% 
  left_join(dc.disc, by = c("ParticipantID", "CoupleID"))
rm(dc.disc) # no longer needed
rm(dc)


```

## *Merging Social Support Coding Data*
```{r}
##### Social Support Coding Data #####
ss <- read_excel(file.choose())

# Recode factor variables. 
ss <- ss %>% 
  mutate(coder = recode_factor(coder,
                               `0` = "Jonathan",
                               `1` = "Derek",
                               `2` = "Lilian",
                               `3` = "Victoria"),
         discussion = recode_factor(discussion,
                                    `0` = "Life Stressor",
                                    `1` = "Discrimination Stressor"),
         part1_side = recode_factor(part1_side,
                                    `0` = "Right side of the video",
                                    `1` = "Left side of the video"),
         part2_side = recode_factor(part2_side,
                                    `0` = "Right side of the video",
                                    `1` = "Left side of the video"),
         recode = recode_factor(recode,
                                `0` = "Not recoded due to audio",
                                `1` = "Recoded due to audio"),
         reliability = recode_factor(reliability,
                                     `0` = "Not used for reliability",
                                     `1` = "Used for reliability"),
         consensus = recode_factor(consensus,
                                   `0` = "No consensus recodes",
                                   `1` = "At least 1 code recoded for consensus"),
         NegRec_part1_rc = NegRec_part1,
         NegProv_part1_rc = NegProv_part1,
         NegProv_part2_rc = NegProv_part2 # Note these last 3 variables are technically not a recode because they were not actually recoded. The purposes of labeling it as such as so that there's a block of original codes, and then a block of variables with recodes added. This makes it so we can just select all of the recoded variables for analyses if we want, or we can sub out original variables if needed (e.g., for a sensitivity analysis). Results for this variable would be the same. 
         ) %>%  
  dplyr::select(StartDate:part2_side,
                PosProv_part1, PosRec_part1, NegProv_part1, NegRec_part1,
                PosProv_part2, PosRec_part2, NegProv_part2, NegRec_part2,
                GlobalSocialSupport,
                PosProv_part1_rc, PosRec_part1_rc, NegProv_part1_rc, NegRec_part1_rc,
                PosProv_part2_rc, PosRec_part2_rc, NegProv_part2_rc, NegRec_part2_rc,
                GlobalSocialSupport_rc, 
                comments, recode, reliability, consensus)

# Select out life stressor & discrimination discussions into separate data frames. 
ss.life <- filter(ss, discussion == 'Life Stressor')
ss.disc <- filter(ss, discussion == 'Discrimination Stressor')

## These data are technically in WIDE format (1 row for each couple). To merge these variables with the self-report data, we need to make them into LONG format (so each couple gets 2 cases, 1 for each partner). Some variables are measured at the partner level (meaning partners may have different scores), others are measured at the couple level (meaning both partners will have the same score for that variable). 
# Separate out partners into separate dataframes to rename variables. 
ss.life_p1 <- dplyr::select(ss.life,
                            coder_ss_life = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part1,
                            PosProv_life = PosProv_part1,
                            PosRec_life = PosRec_part1,
                            NegProv_life = NegProv_part1,
                            NegRec_life = NegRec_part1,
                            GlobalSocialSupport_life = GlobalSocialSupport,
                            PosProv_rc_life = PosProv_part1_rc,
                            PosRec_rc_life = PosRec_part1_rc,
                            NegProv_rc_life = NegProv_part1_rc,
                            NegRec_rc_life = NegRec_part1_rc,
                            GlobalSocialSupport_rc_life = GlobalSocialSupport_rc,
                            comments_ss_life = comments,
                            recode_ss_life = recode,
                            reliability_ss_life = reliability,
                            consensus_ss_life = consensus)
ss.life_p2 <- dplyr::select(ss.life,
                            coder_ss_life = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part2,
                            PosProv_life = PosProv_part2,
                            PosRec_life = PosRec_part2,
                            NegProv_life = NegProv_part2,
                            NegRec_life = NegRec_part2,
                            GlobalSocialSupport_life = GlobalSocialSupport,
                            PosProv_rc_life = PosProv_part2_rc,
                            PosRec_rc_life = PosRec_part2_rc,
                            NegProv_rc_life = NegProv_part2_rc,
                            NegRec_rc_life = NegRec_part2_rc,
                            GlobalSocialSupport_rc_life = GlobalSocialSupport_rc,
                            comments_ss_life = comments,
                            recode_ss_life = recode,
                            reliability_ss_life = reliability,
                            consensus_ss_life = consensus)

# Merge separated dataframes into 1 - now in long format
ss.life <- rbind(ss.life_p1, ss.life_p2)
ss.life <- arrange(ss.life, ParticipantID)
# Delete unneeded dataframes
rm(ss.life_p1)
rm(ss.life_p2)
# Join partner-level data into the main dataset 
ccs <- ccs %>% 
  left_join(ss.life, by = c("ParticipantID", "CoupleID"))
rm(ss.life) # no longer needed

ss.disc_p1 <- dplyr::select(ss.disc,
                            coder_ss_disc = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part1,
                            PosProv_disc = PosProv_part1,
                            PosRec_disc = PosRec_part1,
                            NegProv_disc = NegProv_part1,
                            NegRec_disc = NegRec_part1,
                            GlobalSocialSupport_disc = GlobalSocialSupport,
                            PosProv_rc_disc = PosProv_part1_rc,
                            PosRec_rc_disc = PosRec_part1_rc,
                            NegProv_rc_disc = NegProv_part1_rc,
                            NegRec_rc_disc = NegRec_part1_rc,
                            GlobalSocialSupport_rc_disc = GlobalSocialSupport_rc,
                            comments_ss_disc = comments,
                            recode_ss_disc = recode,
                            reliability_ss_disc = reliability,
                            consensus_ss_disc = consensus)
ss.disc_p2 <- dplyr::select(ss.disc,
                            coder_ss_disc = coder,
                            CoupleID = coupleID,
                            ParticipantID = participantID_part2,
                            PosProv_disc = PosProv_part2,
                            PosRec_disc = PosRec_part2,
                            NegProv_disc = NegProv_part2,
                            NegRec_disc = NegRec_part2,
                            GlobalSocialSupport_disc = GlobalSocialSupport,
                            PosProv_rc_disc = PosProv_part2_rc,
                            PosRec_rc_disc = PosRec_part2_rc,
                            NegProv_rc_disc = NegProv_part2_rc,
                            NegRec_rc_disc = NegRec_part2_rc,
                            GlobalSocialSupport_rc_disc = GlobalSocialSupport_rc,
                            comments_ss_disc = comments,
                            recode_ss_disc = recode,
                            reliability_ss_disc = reliability,
                            consensus_ss_disc = consensus)

# Merge separated dataframes into 1 - now in long format
ss.disc <- rbind(ss.disc_p1, ss.disc_p2)
ss.disc <- arrange(ss.disc, ParticipantID)
# Delete unneeded dataframes
rm(ss.disc_p1)
rm(ss.disc_p2)
# Join partner-level data into the main dataset 
ccs <- ccs %>% 
  left_join(ss.disc, by = c("ParticipantID", "CoupleID"))
rm(ss.disc) # no longer needed
rm(ss)
```

## *Merging Contamination Coding Data*
```{r}
##### Contamination Coding Data #####
# These data were collected as manipulation checks. All variables are at the couple level. 
# Dataset is "CodingData_Contam_final_2020.12.17"
cont <- read_excel(file.choose())

# Recode factor variables. 
cont <- cont %>% 
  mutate(coder = recode_factor(coder,
                               `0` = "Marisa",
                               `1` = "Ying",
                               `2` = "TJ"),
         discussion = recode_factor(discussion,
                                    `0` = "Life Stressor",
                                    `1` = "Discrimination Stressor"),
         contam = recode_factor(contam,
                                `0` = "Not at all",
                                `1` = "Mentioned, and it did NOT impact the conversation",
                                `2` = "Mentioned, and it DID impact the conversation"),
         sexism = recode_factor(sexism,
                                `0` = "No discussion of sexism",
                                `1` = "Yes there was discussion of sexism"),
         gi = recode_factor(gi,
                            `0` = "No discussion of gender identity",
                            `1` = "Yes there was discussion of gender identity"),
         race = recode_factor(race, 
                              `0` = "No discussion of race",
                              `1` = "Yes there was discussion of race"),
         ses = recode_factor(ses,
                             `0` = "No discussion of SES",
                             `1` = "Yes there was discussion of SES"),
         trauma = recode_factor(trauma,
                                `0` = "Event discussed NOT traumatic in nature",
                                `1` = "Event discussed traumatic in nature"),
         offtopic = recode_factor(offtopic,
                                  `0` = "On topic for at least 50% of the conversation",
                                  `1` = "Off topic for at least 50% of the conversation"),
         reliability = recode_factor(reliability,
                                     `0` = "Not used for reliability",
                                     `1` = "Used for reliability"))


# Select out life stressor & discrimination discussions into separate data frames. 
cont.life <- cont %>% 
  filter(discussion == 'Life Stressor') %>% 
  dplyr::select(CoupleID = coupleID,
                coder_life = coder,
                contam_life = contam,
                sexism_life = sexism,
                gi_life = gi,
                race_life = race,
                ses_life = ses,
                trauma_life = trauma,
                offtopic_life = offtopic,
                reliability_contam_life = reliability)
  
cont.disc <- cont %>% 
  filter(discussion == 'Discrimination Stressor') %>% 
    dplyr::select(CoupleID = coupleID,
                  coder_disc = coder,
                  contam_disc = contam,
                  sexism_disc = sexism,
                  gi_disc = gi,
                  race_disc = race,
                  ses_disc = ses,
                  trauma_disc = trauma,
                  offtopic_disc = offtopic,
                  reliability_contam_disc = reliability)

# Merge separate dataframes into the main - this code will merge based on CoupleID so both partners will have the same values for these variables. 
ccs <- ccs %>% 
  left_join(cont.life, by = c("CoupleID"))
ccs <- ccs %>% 
  left_join(cont.disc, by = c("CoupleID"))
# Delete unneeded dataframes
rm(cont.disc)
rm(cont.life)
rm(cont)
```


# *Remove identifying information from character variables* 
```{r}
# All free response/character variables were manually reviewed for any potentially identifiable information (e.g., names, specific details that could indicate identity). People who are NOT the participant's partner identitified are indicated as [person] in these variables. 
ccs$HowMet[which(ccs$ParticipantID == 219)] <- "We met during Freshman year. My partner saw me wearing a crop top and thought it was really cool and we started talking. Then we were best friends from then on."
ccs$HowMet[which(ccs$ParticipantID == 132)] <- "At community college"
ccs$HowMet[which(ccs$ParticipantID == 137)] <- "We attended the same college and initially met at a club called [masked to protect identity] — but that meeting occurred in a group of people, not on an individual level. We didn't have one-on-one interaction until 3 years later when we matched on Tinder and met up at a party."
ccs$HowMet[which(ccs$ParticipantID == 263)] <- "Mutual friend"
ccs$HowMet[which(ccs$ParticipantID == 248)] <- "OkCupid"
ccs$HowMet[which(ccs$ParticipantID == 280)] <- "We met through the Tinder app while we were both on Christmas break with our families in [masked to protect identity]. We realized we both attended universities in Florida and began to date when we returned in January 2017."
ccs$HowMet[which(ccs$ParticipantID == 227)] <- "Random roommates first year in college"
ccs$HowMet[which(ccs$ParticipantID == 239)] <- "My partner contacted me on social media about a land project they were working on. I left them on read for a while until I reached out to them about a friend who was interested in going to the land project. I connected them, and when they were together, I would see their social media posts. I became intersted in the land project, and when my partner came to visit DC, we met."

ccs$CNM_RelAgreeQual[which(ccs$ParticipantID == 343)] <- "No. I'm not opposed to it but I am a little hesitant to initiate that conversation. Based on my knowledge of my partner and his personality, he is committed to being in a monogamous relationship."
ccs$CNM_RelAgreeQual[which(ccs$ParticipantID == 240)] <- "Sorta. I've always felt that since we agreed to be monogamous that like the boundaries there were clear. Switching our relationship to being one of polyamory, primarily for my partner, has come up in discussions before and I mentioned wanting to talk about boundaries however nothing more has really been said"
ccs$CNM_RelAgreeQual[which(ccs$ParticipantID == 223)] <- "Yes. I've been diagnosed with MDD/GAD and my partner and I wanted to be on the same page about boundaries. We also wanted to make sure that (generally speaking) that we're both aware of each others' comfort zones in our daily lives."
ccs$CNM_RelAgreeQual[which(ccs$ParticipantID == 122)] <- "My partner is asexual, and when we began dating I was very explicit about always wanting to respect that and being open, and I made my partner promise that they would always let me know if I did anything that made them uncomfortable (since I am allosexual). We have also at a different point explicitly agreed that we are in a monogamous relationship. I think this has served to be a relationship agreement, but it wasn't as formal or specific as your definition implied."
ccs$CNM_RelAgreeQual[which(ccs$ParticipantID == 263)] <- "My partner & I have never really thought about the idea of having a relationship agreement, but since we have had boundary issues throughout our relationship, now that we pretty much just learned or heard of the idea I think we will definitely discuss it further & see if we think it would benefit our relationship."
ccs$CNM_RelAgreeQual[which(ccs$ParticipantID == 137)] <- "I think that based on our time getting to know each other, it was implicit that our relationship would be monogamous — we would have more casual conversations about relationships, open and otherwise, and both expressed our preference for monogamy. I have not considered making a relationship agreement based on this part of our relationship because I have been happy with the implicit monogamy thus far, and I guess I believe that my partner is too, or she would have brought it up."

ccs$LEL_24a_event1xtra_TEXT[which(ccs$ParticipantID == 252)] <- "My partner moving to DC for 2 months"
ccs$LEL_24a_event1xtra_TEXT[which(ccs$ParticipantID == 251)] <- "My partner was traveling for 1 month"
ccs$LEL_24a_event1xtra_TEXT[which(ccs$ParticipantID == 289)] <- "My partner's mother’s car was broken into and burgled"
ccs$LEL_24a_event1xtra_TEXT[which(ccs$ParticipantID == 343)] <- "Traveled to Puerto Rico to meet my partner's mother. She is homophobic and we ended up canceling the day before we planned to visit her."
ccs$LEL_24a_event2xtra_TEXT[which(ccs$ParticipantID == 280)] <- "Me moving to Indianapolis, making my partner and I's relationship long distance again."

ccs$LEL_24event1b[which(ccs$ParticipantID == 252)] <- "Partner took a 2 month internship in DC. We had limited time to talk and I took 1 week to visit him"
ccs$LEL_24event1b[which(ccs$ParticipantID == 343)] <- "Traveled to Puerto Rico to meet partner's mother. She is homophobic and we ended up canceling the day before we planned to visit her."
ccs$LEL_24event1b[which(ccs$ParticipantID == 253)] <- "Have spent the last 7+ months filing and preparing for immigration process (partner just received her work and travel permits to legally work in the US and travel outside of the US)."

ccs$LEL_24event2b[which(ccs$ParticipantID == 252)] <- "I had already planned a 1 month vacation to Europe to visit friends. Partner and I would spend a limited time writing (due to time difference). It was also the first time to make use of the 'open relationship' status from my side"

ccs$StressorTopic_1[which(ccs$ParticipantID == 123)] <- "partner's dad passing"
ccs$StressorTopic_1[which(ccs$ParticipantID == 126)] <- "Not being paid enough due to partner's knee surgery (circumstances changes w/in the last month)"
ccs$StressorTopic_1[which(ccs$ParticipantID == 358)] <- "Loss of Uncle"

ccs$StressorTopic_3[which(ccs$ParticipantID == 358)] <- "Health of both grandmothers"

ccs$StressorTopic_4[which(ccs$ParticipantID == 358)] <- "[person] not being allowed in the country"
ccs$StressorTopic_4[which(ccs$ParticipantID == 203)] <- "[person] being sad"

ccs$StressorTopic_5[which(ccs$ParticipantID == 252)] <- "Introducing partner to my mother"
ccs$StressorTopic_5[which(ccs$ParticipantID == 203)] <- "[person] yelling at me at work"

ccs$TLEQ_24b[which(ccs$ParticipantID == 305)] <- "It only happened one time in 2014. Maybe in April? I was at a concert"

ccs$DiscrimTopic_1[which(ccs$ParticipantID == 223)] <- "Partner's mom said I drug and manipulate her."
ccs$DiscrimTopic_1[which(ccs$ParticipantID == 261)] <- "Exclusion/discrimination from partner’s family"

ccs$DiscrimTopic_2[which(ccs$ParticipantID == 223)] <- "A friend made comments about partner and I."
ccs$DiscrimTopic_2[which(ccs$ParticipantID == 203)] <- "[person]"

ccs$DiscrimTopic_4[which(ccs$ParticipantID == 223)] <- "A friend made scissoring motions in reference to me and my partner."

ccs$DiscrimTopic[which(ccs$ParticipantID == 223)] <- "Partner's mom said I drug and manipulate her."
```

# *Save as R Data File (rds)* 
```{r}
saveRDS(ccs, file = "CCS_data_final_2020.01.05")
```

